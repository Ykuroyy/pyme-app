from flask import Flask, render_template, jsonify, request, redirect, url_for, flash, session
import os
import logging
import sys
import subprocess
import tempfile
import json
import re
from datetime import datetime
from config import config
from models import db, Tool
import secrets

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    stream=sys.stdout
)
logger = logging.getLogger(__name__)

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã®ãƒ­ã‚°
logger.info("Flask application starting...")
logger.info(f"Python version: {sys.version}")
logger.info(f"Working directory: {os.getcwd()}")

# Flaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
app = Flask(__name__)

# è¨­å®šã®èª­ã¿è¾¼ã¿
config_name = os.environ.get('FLASK_ENV', 'development')
app.config.from_object(config[config_name])

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
db.init_app(app)

logger.info("Flask app initialized successfully")
logger.info(f"App name: {app.name}")
logger.info(f"App instance path: {app.instance_path}")
logger.info(f"Template folder: {app.template_folder}")

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç¢ºèª
if os.path.exists(app.template_folder):
    logger.info(f"Template folder exists: {app.template_folder}")
    logger.info(f"Template files: {os.listdir(app.template_folder)}")
else:
    logger.error(f"Template folder not found: {app.template_folder}")

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã®ç¢ºèªï¼ˆFlask 3.xã§ã¯before_first_requestãŒå‰Šé™¤ã•ã‚ŒãŸãŸã‚å‰Šé™¤ï¼‰

# è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ãƒªã‚¹ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰
from tools_extra import EXTRA_TOOLS

TOOLS = [
    {
        "id": 1, 
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "1/100",
        "title": "ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡", 
        "desc": "Pythonã§ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹æ–¹æ³•",
        "how_to": "smtplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™ã€‚",
        "sample_code": "import smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.base import MIMEBase\nfrom email import encoders\nimport os\nimport json\nimport pandas as pd\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport time\n\nprint('=== ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ“§ ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒ¼ãƒ«ã®è‡ªå‹•é€ä¿¡ã‚’å®‰å…¨ã«å®Ÿè¡Œã—ã¾ã™')\nprint('\nğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½:')\nprint('â€¢ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç’°å¢ƒå¤‰æ•°ç®¡ç†')\nprint('â€¢ é€ä¿¡å‰ã®å†…å®¹ç¢ºèª')\nprint('â€¢ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°')\nprint('â€¢ é€ä¿¡ãƒ­ã‚°ã®è¨˜éŒ²')\n\ntry:\n    # --- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šã™ã‚‹é …ç›® ---\n    # TODO: â˜…ã“ã“ã‚’ã‚ãªãŸã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›´ã—ã¦ãã ã•ã„â˜…\n    # Gmailã®å ´åˆã€ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚è©³ç´°ã¯ä»¥ä¸‹ã®URLã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚\n    # https://support.google.com/accounts/answer/185833?hl=ja\n    sender_email = 'your_email@example.com' # é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\n    sender_password = 'your_app_password' # Gmailã®ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰\n    \n    # TODO: â˜…ã“ã“ã‚’é€ä¿¡å…ˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›´ã—ã¦ãã ã•ã„â˜…\n    receiver_email = 'recipient_email@example.com' # é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\n\n    # TODO: â˜…å¿…è¦ã«å¿œã˜ã¦ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆã¦ãã ã•ã„â˜…\n    # æœˆæ¬¡å£²ä¸Šãƒ‡ãƒ¼ã‚¿ (ä¾‹: 1æœˆã‹ã‚‰6æœˆã¾ã§ã®å£²ä¸Š)\n    months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ']\n    sales_data = [120000, 180000, 220000, 190000, 280000, 320000]\n    \n    # --- ã“ã“ã‹ã‚‰ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯é€šå¸¸å¤‰æ›´ä¸è¦ã§ã™ ---\n\n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    df = pd.DataFrame({\n        'æœˆ': months,\n        'å£²ä¸Š': sales_data\n    })\n    \n    # å£²ä¸Šã‚°ãƒ©ãƒ•ä½œæˆ\n    plt.figure(figsize=(10, 6))\n    plt.plot(df['æœˆ'], df['å£²ä¸Š'], marker='o', linewidth=3, markersize=8, color='#2E86AB')\n    plt.title('æœˆæ¬¡å£²ä¸Šæ¨ç§»', fontsize=16, fontweight='bold', pad=20)\n    plt.xlabel('æœˆ', fontsize=12)\n    plt.ylabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ \n    for i, v in enumerate(df['å£²ä¸Š']):\n        plt.text(i, v + 15000, f'{v:,}', ha='center', va='bottom', fontweight='bold')\n    \n    plt.tight_layout()\n    # ã‚°ãƒ©ãƒ•ã‚’ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜\n    graph_filename = 'monthly_sales.png'\n    plt.savefig(graph_filename, dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆCSVä½œæˆ\n    csv_filename = 'monthly_sales_report.csv'\n    df.to_csv(csv_filename, index=False, encoding='utf-8-sig')\n    \n    # çµ±è¨ˆæƒ…å ±è¨ˆç®—\n    total_sales = df['å£²ä¸Š'].sum()\n    avg_sales = df['å£²ä¸Š'].mean()\n    growth_rate = ((df['å£²ä¸Š'].iloc[-1] / df['å£²ä¸Š'].iloc[0] - 1) * 100)\n    \n    # ãƒ¡ãƒ¼ãƒ«å†…å®¹ä½œæˆ\n    current_time = datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S')\n    \n    subject = f'æœˆæ¬¡å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆ - {datetime.now().strftime(\"%Yå¹´%mæœˆ\")}'\n    \n    message_body = f'''\n    ãŠç–²ã‚Œæ§˜ã§ã™ã€‚\n    \n    {datetime.now().strftime('%Yå¹´%mæœˆ')}ã®å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆã‚’ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\n    \n    ğŸ“Š å£²ä¸Šã‚µãƒãƒªãƒ¼:\n    â€¢ ç·å£²ä¸Š: {total_sales:,}å††\n    â€¢ å¹³å‡å£²ä¸Š: {avg_sales:,.0f}å††\n    â€¢ æˆé•·ç‡: {growth_rate:.1f}%\n    â€¢ æœ€é«˜å£²ä¸Šæœˆ: {df.loc[df['å£²ä¸Š'].idxmax(), 'æœˆ']} ({df['å£²ä¸Š'].max():,}å††)\n    \n    ğŸ“ˆ ä»Šæœˆã®ç‰¹å¾´:\n    â€¢ å‰æœˆæ¯”ã§{abs(growth_rate):.1f}%ã®{'å¢—åŠ ' if growth_rate > 0 else 'æ¸›å°‘'}\n    â€¢ 6ãƒ¶æœˆé€£ç¶šã§ç›®æ¨™ã‚’é”æˆ\n    â€¢ æ–°å•†å“ã®å£²ä¸ŠãŒå¥½èª¿\n    \n    ğŸ“‹ ä»Šå¾Œã®æ–¹é‡:\n    â€¢ å¥½èª¿ãªæ–°å•†å“ã®è²©å£²å¼·åŒ–\n    â€¢ é¡§å®¢æº€è¶³åº¦ã®å‘ä¸Š\n    â€¢ åŠ¹ç‡çš„ãªåœ¨åº«ç®¡ç†ã®ç¶™ç¶š\n    \n    æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«:\n    â€¢ monthly_sales.png: å£²ä¸Šæ¨ç§»ã‚°ãƒ©ãƒ•\n    â€¢ monthly_sales_report.csv: è©³ç´°ãƒ‡ãƒ¼ã‚¿\n    \n    ã”ç¢ºèªã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚\n    \n    ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚\n    \n    ---\n    é€ä¿¡æ—¥æ™‚: {current_time}\n    è‡ªå‹•é€ä¿¡ã‚·ã‚¹ãƒ†ãƒ \n    '''\n    \n    # ãƒ¡ãƒ¼ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ\n    msg = MIMEMultipart()\n    msg['From'] = sender_email\n    msg['To'] = receiver_email\n    msg['Subject'] = subject\n    \n    # æœ¬æ–‡ã‚’è¿½åŠ \n    msg.attach(MIMEText(message_body, 'plain', 'utf-8'))\n    \n    # æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ \n    attachments = ['monthly_sales.png', 'monthly_sales_report.csv']\n    \n    for file in attachments:\n        if os.path.exists(file):\n            with open(file, 'rb') as attachment:\n                part = MIMEBase('application', 'octet-stream')\n                part.set_payload(attachment.read())\n            \n            encoders.encode_base64(part)\n            part.add_header(\n                'Content-Disposition',\n                f'attachment; filename= {file}'\n            )\n            msg.attach(part)\n            print(f'âœ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: {file}')\n    \n    # é€ä¿¡å‰ã®ç¢ºèª\n    print('\\nğŸ“ ãƒ¡ãƒ¼ãƒ«å†…å®¹ç¢ºèª:')\n    print(f'é€ä¿¡è€…: {sender_email}')\n    print(f'å—ä¿¡è€…: {receiver_email}')\n    print(f'ä»¶å: {subject}')\n    print(f'æœ¬æ–‡: {len(message_body)}æ–‡å­—')\n    print(f'æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: {len(attachments)}å€‹')\n    \n    # ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰åˆ¤å®š\n    is_demo = (sender_email == 'demo@example.com' or \n               sender_password == 'demo_password' or \n               receiver_email == 'recipient@example.com')\n    \n    if is_demo:\n        print('\\nâš ï¸ ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰: å®Ÿéš›ã®é€ä¿¡ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸ')\n        print('å®Ÿéš›ã«é€ä¿¡ã™ã‚‹ã«ã¯ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„:')\n        print('export SENDER_EMAIL=your_email@gmail.com')\n        print('export SENDER_PASSWORD=your_app_password')\n        print('export RECEIVER_EMAIL=recipient@example.com')\n        \n        # ãƒ‡ãƒ¢ç”¨ã®é€ä¿¡ãƒ­ã‚°ä½œæˆ\n        log_data = {\n            'timestamp': current_time,\n            'sender': sender_email,\n            'receiver': receiver_email,\n            'subject': subject,\n            'status': 'DEMO_MODE',\n            'attachments': attachments\n        }\n        \n        with open('email_log.json', 'w', encoding='utf-8') as f:\n            json.dump(log_data, f, ensure_ascii=False, indent=2)\n        \n    else:\n        print('\\nğŸš€ ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚’å®Ÿè¡Œã—ã¾ã™...')\n        \n        try:\n            # Gmail SMTPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶š\n            server = smtplib.SMTP('smtp.gmail.com', 587)\n            server.starttls()\n            \n            # ãƒ­ã‚°ã‚¤ãƒ³\n            server.login(sender_email, sender_password)\n            \n            # ãƒ¡ãƒ¼ãƒ«é€ä¿¡\n            text = msg.as_string()\n            server.sendmail(sender_email, receiver_email, text)\n            server.quit()\n            \n            print('âœ… ãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œäº†ï¼')\n            \n            # é€ä¿¡ãƒ­ã‚°è¨˜éŒ²\n            log_data = {\n                'timestamp': current_time,\n                'sender': sender_email,\n                'receiver': receiver_email,\n                'subject': subject,\n                'status': 'SENT',\n                'attachments': attachments\n            }\n            \n            with open('email_log.json', 'w', encoding='utf-8') as f:\n                json.dump(log_data, f, ensure_ascii=False, indent=2)\n            \n        except smtplib.SMTPAuthenticationError:\n            print('âŒ èªè¨¼ã‚¨ãƒ©ãƒ¼: Gmailã®ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n        except smtplib.SMTPRecipientsRefused:\n            print('âŒ å—ä¿¡è€…ã‚¨ãƒ©ãƒ¼: å—ä¿¡è€…ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n        except Exception as e:\n            print(f'âŒ é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}')\n    \n    # çµ±è¨ˆæƒ…å ±è¡¨ç¤º\n    print('\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ å£²ä¸Šãƒ‡ãƒ¼ã‚¿: {len(df)}ãƒ¶æœˆåˆ†')\n    print(f'â€¢ ç·å£²ä¸Š: {total_sales:,}å††')\n    print(f'â€¢ æˆé•·ç‡: {growth_rate:.1f}%')\n    print(f'â€¢ ã‚°ãƒ©ãƒ•ãƒ•ã‚¡ã‚¤ãƒ«: monthly_sales.png')\n    print(f'â€¢ ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: monthly_sales_report.csv')\n    print(f'â€¢ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«: email_log.json')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡å®Œäº† ===')\nprint('ğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€ç’°å¢ƒå¤‰æ•°ã«Gmailã®èªè¨¼æƒ…å ±ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚')",
        "libraries": "smtplibï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€emailï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€pandasã€matplotlibã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "Pythonã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€ç°¡å˜ã«ãƒ¡ãƒ¼ãƒ«ã®è‡ªå‹•é€ä¿¡ãŒã§ãã¾ã™ã€‚å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®é€ä¿¡ã‚„é€šçŸ¥ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡ã«ä¾¿åˆ©ã§ã™ã€‚",
        "benefits": ["æ™‚é–“ã‚’ç¯€ç´„ã§ãã‚‹", "ãƒŸã‚¹ã‚’æ¸›ã‚‰ã›ã‚‹", "ä¸€æ‹¬é€ä¿¡ãŒå¯èƒ½", "æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ", "é€ä¿¡ãƒ­ã‚°è¨˜éŒ²"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. smtplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. Gmailã®SMTPã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹\n3. ä»¶åã€æœ¬æ–‡ã€é€ä¿¡è€…ã€å—ä¿¡è€…ã‚’è¨­å®šã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿è¾¼ã‚€\n7. æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚°ãƒ©ãƒ•ã€CSVï¼‰ã®é€ä¿¡æ©Ÿèƒ½ã‚’å«ã‚ã‚‹\n\né€ä¿¡è€…: è‡ªåˆ†ã®Gmailã‚¢ãƒ‰ãƒ¬ã‚¹\nå—ä¿¡è€…: æŒ‡å®šã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\nä»¶å: æœˆæ¬¡å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆ\næœ¬æ–‡: å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¨åˆ†æçµæœ\næ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: å£²ä¸Šã‚°ãƒ©ãƒ•ã€CSVãƒ‡ãƒ¼ã‚¿\n\næ³¨æ„: Gmailã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¨­å®šãŒå¿…è¦ã§ã™ã€‚\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚smtplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Gmailã®SMTPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€æœˆæ¬¡å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ã§ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡ã€é€ä¿¡ãƒ­ã‚°è¨˜éŒ²ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 2, 
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "2/100",
        "title": "Excelè‡ªå‹•å‡¦ç†", 
        "desc": "Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ç·¨é›†ãƒ»é›†è¨ˆ",
        "how_to": "openpyxlãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç·¨é›†ãƒ»é›†è¨ˆã—ã¾ã™ã€‚",
        "sample_code": "import pandas as pd\nimport numpy as np\nimport openpyxl\nfrom openpyxl.styles import Font, PatternFill, Alignment, Border, Side\nfrom openpyxl.chart import LineChart, Reference, BarChart\nfrom openpyxl.utils.dataframe import dataframe_to_rows\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport os\nimport json\n\nprint('=== Excelè‡ªå‹•å‡¦ç†ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ“Š ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•åˆ†æã¨Excelå‡ºåŠ›ã‚’å®Ÿè¡Œã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¨æ¤œè¨¼')\nprint('â€¢ çµ±è¨ˆåˆ†æã¨å¯è¦–åŒ–')\nprint('â€¢ Excelãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ')\nprint('â€¢ ã‚°ãƒ©ãƒ•ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ')\n\ntry:\n    # ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆï¼ˆå®Ÿéš›ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ä»£ã‚ã‚Šï¼‰\n    print('\\nğŸ“Š ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # å–¶æ¥­ãƒ‡ãƒ¼ã‚¿\n    sales_data = {\n        'å–¶æ¥­æ‹…å½“è€…': ['ç”°ä¸­å¤ªéƒ', 'ä½è—¤èŠ±å­', 'éˆ´æœ¨ä¸€éƒ', 'é«˜æ©‹ç¾å’²', 'ä¼Šè—¤å¥å¤ª', 'å±±ç”°æ¬¡éƒ', 'ä¸­æ‘ä¸‰éƒ', 'å°æ—å››éƒ'],\n        '1æœˆ': [150000, 200000, 180000, 220000, 190000, 160000, 210000, 170000],\n        '2æœˆ': [180000, 220000, 200000, 240000, 210000, 190000, 230000, 200000],\n        '3æœˆ': [220000, 250000, 230000, 270000, 240000, 220000, 260000, 230000],\n        '4æœˆ': [200000, 230000, 210000, 250000, 220000, 200000, 240000, 210000],\n        '5æœˆ': [240000, 270000, 250000, 290000, 260000, 240000, 280000, 250000],\n        '6æœˆ': [280000, 310000, 290000, 330000, 300000, 280000, 320000, 290000]\n    }\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    df = pd.DataFrame(sales_data)\n    \n    print(f'ãƒ‡ãƒ¼ã‚¿ä»¶æ•°: {len(df)}ä»¶')\n    print(f'åˆ—æ•°: {len(df.columns)}åˆ—')\n    print(f'ãƒ‡ãƒ¼ã‚¿æœŸé–“: {df.columns[1]}ã€œ{df.columns[-1]}')\n    \n    # ãƒ‡ãƒ¼ã‚¿åˆ†æ\n    print('\\nğŸ“ˆ ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å®Ÿè¡Œä¸­...')\n    \n    # æœˆæ¬¡å£²ä¸Šè¨ˆç®—\n    monthly_sales = df.iloc[:, 1:].sum()\n    total_sales = monthly_sales.sum()\n    avg_monthly_sales = monthly_sales.mean()\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥åˆ†æ\n    df['ç·å£²ä¸Š'] = df.iloc[:, 1:].sum(axis=1)\n    df['å¹³å‡å£²ä¸Š'] = df.iloc[:, 1:-1].mean(axis=1)\n    df['æˆé•·ç‡'] = ((df.iloc[:, -2] / df.iloc[:, 1] - 1) * 100).round(1)\n    \n    # ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä½œæˆ\n    df_ranked = df.sort_values('ç·å£²ä¸Š', ascending=False).reset_index(drop=True)\n    df_ranked['é †ä½'] = range(1, len(df_ranked) + 1)\n    \n    # çµ±è¨ˆæƒ…å ±\n    stats_data = {\n        'é …ç›®': ['ç·å£²ä¸Š', 'å¹³å‡æœˆå£²ä¸Š', 'æœ€é«˜æœˆå£²ä¸Š', 'æœ€ä½æœˆå£²ä¸Š', 'å¹³å‡æˆé•·ç‡', 'å‡¦ç†æ—¥æ™‚'],\n        'å€¤': [\n            f'{total_sales:,}å††',\n            f'{avg_monthly_sales:,.0f}å††',\n            f'{monthly_sales.max():,}å††',\n            f'{monthly_sales.min():,}å††',\n            f'{df[\"æˆé•·ç‡\"].mean():.1f}%',\n            datetime.now().strftime('%Y-%m-%d %H:%M:%S')\n        ]\n    }\n    \n    # Excelãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ\n    print('\\nğŸ“„ Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆä¸­...')\n    \n    wb = openpyxl.Workbook()\n    \n    # ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ\n    ws_data = wb.active\n    ws_data.title = 'å–¶æ¥­ãƒ‡ãƒ¼ã‚¿'\n    \n    # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’è¿½åŠ \n    headers = ['å–¶æ¥­æ‹…å½“è€…', '1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', 'ç·å£²ä¸Š', 'å¹³å‡å£²ä¸Š', 'æˆé•·ç‡', 'é †ä½']\n    for col, header in enumerate(headers, 1):\n        cell = ws_data.cell(row=1, column=col, value=header)\n        cell.font = Font(bold=True, color='FFFFFF')\n        cell.fill = PatternFill(start_color='366092', end_color='366092', fill_type='solid')\n        cell.alignment = Alignment(horizontal='center')\n    \n    # ãƒ‡ãƒ¼ã‚¿è¡Œã‚’è¿½åŠ \n    for row_idx, (_, row_data) in enumerate(df_ranked.iterrows(), 2):\n        for col_idx, value in enumerate(row_data, 1):\n            cell = ws_data.cell(row=row_idx, column=col_idx, value=value)\n            if col_idx > 1 and col_idx <= 7:  # å£²ä¸Šãƒ‡ãƒ¼ã‚¿\n                cell.number_format = '#,##0'\n            elif col_idx == 8 or col_idx == 9:  # ç·å£²ä¸Šã€å¹³å‡å£²ä¸Š\n                cell.number_format = '#,##0'\n                cell.font = Font(bold=True)\n            elif col_idx == 10:  # æˆé•·ç‡\n                cell.number_format = '0.0%'\n                if value > 0:\n                    cell.fill = PatternFill(start_color='C6EFCE', end_color='C6EFCE', fill_type='solid')\n                else:\n                    cell.fill = PatternFill(start_color='FFC7CE', end_color='FFC7CE', fill_type='solid')\n    \n    # åˆ—å¹…ã®èª¿æ•´\n    for col in ws_data.columns:\n        max_length = 0\n        column = col[0].column_letter\n        for cell in col:\n            try:\n                if len(str(cell.value)) > max_length:\n                    max_length = len(str(cell.value))\n            except:\n                pass\n        adjusted_width = min(max_length + 2, 20)\n        ws_data.column_dimensions[column].width = adjusted_width\n    \n    # çµ±è¨ˆã‚·ãƒ¼ãƒˆ\n    ws_stats = wb.create_sheet('çµ±è¨ˆæƒ…å ±')\n    \n    # çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ \n    for row_idx, (item, value) in enumerate(zip(stats_data['é …ç›®'], stats_data['å€¤']), 1):\n        ws_stats.cell(row=row_idx, column=1, value=item).font = Font(bold=True)\n        ws_stats.cell(row=row_idx, column=2, value=value)\n    \n    # æœˆæ¬¡å£²ä¸Šã‚·ãƒ¼ãƒˆ\n    ws_monthly = wb.create_sheet('æœˆæ¬¡å£²ä¸Š')\n    \n    monthly_headers = ['æœˆ', 'å£²ä¸Š', 'å‰æœˆæ¯”']\n    for col, header in enumerate(monthly_headers, 1):\n        cell = ws_monthly.cell(row=1, column=col, value=header)\n        cell.font = Font(bold=True, color='FFFFFF')\n        cell.fill = PatternFill(start_color='366092', end_color='366092', fill_type='solid')\n    \n    for row_idx, (month, sales) in enumerate(monthly_sales.items(), 2):\n        ws_monthly.cell(row=row_idx, column=1, value=month)\n        ws_monthly.cell(row=row_idx, column=2, value=sales)\n        ws_monthly.cell(row=row_idx, column=2).number_format = '#,##0'\n        \n        if row_idx > 2:\n            prev_sales = monthly_sales.iloc[row_idx-3]\n            growth = (sales / prev_sales - 1) * 100\n            ws_monthly.cell(row=row_idx, column=3, value=growth/100)\n            ws_monthly.cell(row=row_idx, column=3).number_format = '0.0%'\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n    \n    # æœˆæ¬¡å£²ä¸Šã‚°ãƒ©ãƒ•\n    chart1 = LineChart()\n    chart1.title = 'æœˆæ¬¡å£²ä¸Šæ¨ç§»'\n    chart1.x_axis.title = 'æœˆ'\n    chart1.y_axis.title = 'å£²ä¸Šï¼ˆå††ï¼‰'\n    \n    data = Reference(ws_monthly, min_col=2, min_row=1, max_row=len(monthly_sales)+1)\n    cats = Reference(ws_monthly, min_col=1, min_row=2, max_row=len(monthly_sales)+1)\n    chart1.add_data(data, titles_from_data=True)\n    chart1.set_categories(cats)\n    \n    ws_monthly.add_chart(chart1, 'E2')\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•\n    chart2 = BarChart()\n    chart2.title = 'å–¶æ¥­æ‹…å½“è€…åˆ¥ç·å£²ä¸Š'\n    chart2.x_axis.title = 'å–¶æ¥­æ‹…å½“è€…'\n    chart2.y_axis.title = 'å£²ä¸Šï¼ˆå††ï¼‰'\n    \n    data = Reference(ws_data, min_col=8, min_row=1, max_row=len(df)+1)\n    cats = Reference(ws_data, min_col=1, min_row=2, max_row=len(df)+1)\n    chart2.add_data(data, titles_from_data=True)\n    chart2.set_categories(cats)\n    \n    ws_data.add_chart(chart2, 'M2')\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜\n    filename = f'å–¶æ¥­åˆ†æãƒ¬ãƒãƒ¼ãƒˆ_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.xlsx'\n    wb.save(filename)\n    \n    # matplotlibã‚°ãƒ©ãƒ•ã‚‚ä½œæˆ\n    plt.figure(figsize=(15, 10))\n    \n    # æœˆæ¬¡å£²ä¸Šæ¨ç§»\n    plt.subplot(2, 2, 1)\n    plt.plot(monthly_sales.index, monthly_sales.values, marker='o', linewidth=3, markersize=8, color='#2E86AB')\n    plt.title('æœˆæ¬¡å£²ä¸Šæ¨ç§»', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('æœˆ', fontsize=12)\n    plt.ylabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    plt.xticks(rotation=45)\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š\n    plt.subplot(2, 2, 2)\n    top_sales = df_ranked.head(5)\n    plt.barh(top_sales['å–¶æ¥­æ‹…å½“è€…'], top_sales['ç·å£²ä¸Š'], color='#A23B72', alpha=0.7)\n    plt.title('å–¶æ¥­æ‹…å½“è€…åˆ¥ç·å£²ä¸Šï¼ˆä¸Šä½5åï¼‰', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    plt.ylabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    plt.grid(True, alpha=0.3, axis='x')\n    \n    # æˆé•·ç‡åˆ†å¸ƒ\n    plt.subplot(2, 2, 3)\n    plt.hist(df['æˆé•·ç‡'], bins=5, color='#F18F01', alpha=0.7, edgecolor='black')\n    plt.title('æˆé•·ç‡åˆ†å¸ƒ', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('æˆé•·ç‡ï¼ˆ%ï¼‰', fontsize=12)\n    plt.ylabel('äººæ•°', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    plt.subplot(2, 2, 4)\n    plt.axis('off')\n    summary_text = f'''\n    åˆ†æã‚µãƒãƒªãƒ¼:\n    \n    â€¢ ç·å£²ä¸Š: {total_sales:,}å††\n    â€¢ å¹³å‡æœˆå£²ä¸Š: {avg_monthly_sales:,.0f}å††\n    â€¢ æœ€é«˜æœˆå£²ä¸Š: {monthly_sales.max():,}å††\n    â€¢ æœ€ä½æœˆå£²ä¸Š: {monthly_sales.min():,}å††\n    â€¢ å¹³å‡æˆé•·ç‡: {df['æˆé•·ç‡'].mean():.1f}%\n    â€¢ å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    plt.text(0.1, 0.5, summary_text, fontsize=12, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    plt.tight_layout()\n    plt.savefig('sales_analysis_charts.png', dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_records': len(df),\n        'total_sales': total_sales,\n        'avg_monthly_sales': avg_monthly_sales,\n        'files_created': [filename, 'sales_analysis_charts.png'],\n        'status': 'SUCCESS'\n    }\n    \n    with open('excel_processing_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print('\\nâœ… Excelè‡ªå‹•å‡¦ç†å®Œäº†ï¼')\n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ ãƒ‡ãƒ¼ã‚¿ä»¶æ•°: {len(df)}ä»¶')\n    print(f'â€¢ ç·å£²ä¸Š: {total_sales:,}å††')\n    print(f'â€¢ å¹³å‡æœˆå£²ä¸Š: {avg_monthly_sales:,.0f}å††')\n    print(f'â€¢ æœ€é«˜å£²ä¸Šæ‹…å½“è€…: {df_ranked.iloc[0, 0]} ({df_ranked.iloc[0, 7]:,}å††)')\n    print(f'â€¢ å¹³å‡æˆé•·ç‡: {df[\"æˆé•·ç‡\"].mean():.1f}%')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {filename} (Excelãƒ•ã‚¡ã‚¤ãƒ«)')\n    print(f'â€¢ sales_analysis_charts.png (ã‚°ãƒ©ãƒ•)')\n    print(f'â€¢ excel_processing_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== Excelè‡ªå‹•å‡¦ç†å®Œäº† ===')\nprint('ğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦åŒã˜å‡¦ç†ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚')",
        "libraries": "openpyxlã€pandasã€matplotlibã€numpyã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "Excelãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•å‡¦ç†ã¯ã€ãƒ“ã‚¸ãƒã‚¹ã§æœ€ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹è‡ªå‹•åŒ–ã®ä¸€ã¤ã§ã™ã€‚å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®é›†è¨ˆã‚„ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ä½œæˆã«ä¾¿åˆ©ã§ã™ã€‚",
        "benefits": ["æ‰‹ä½œæ¥­ã®æ™‚é–“ã‚’å¤§å¹…å‰Šæ¸›", "è¨ˆç®—ãƒŸã‚¹ã‚’é˜²ã’ã‚‹", "å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚‚ç¬æ™‚ã«å‡¦ç†", "ã‚°ãƒ©ãƒ•ã¨ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ", "è¤‡æ•°ã‚·ãƒ¼ãƒˆå¯¾å¿œ"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§Excelè‡ªå‹•å‡¦ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. openpyxlãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹\n3. å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ã¦çµ±è¨ˆåˆ†æã‚’è¡Œã†\n4. è¤‡æ•°ã®ã‚·ãƒ¼ãƒˆã«çµæœã‚’å‡ºåŠ›ã™ã‚‹\n5. ã‚°ãƒ©ãƒ•ã¨ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹\n6. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: sales_data.xlsx\né›†è¨ˆé …ç›®: æœˆæ¬¡å£²ä¸Šã€å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š\nå‡ºåŠ›å…ˆ: è¤‡æ•°ã‚·ãƒ¼ãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ã€çµ±è¨ˆã€ã‚°ãƒ©ãƒ•ï¼‰\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§Excelè‡ªå‹•å‡¦ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚openpyxlãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ã¦çµ±è¨ˆåˆ†æã‚’è¡Œã„ã€è¤‡æ•°ã®ã‚·ãƒ¼ãƒˆã«çµæœã‚’å‡ºåŠ›ã—ã¦ã‚°ãƒ©ãƒ•ã¨ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 3, 
        "category": "æ–‡æ›¸ä½œæˆãƒ»ç®¡ç†",
        "number": "3/100",
        "title": "PDFè‡ªå‹•ç”Ÿæˆ", 
        "desc": "PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ä½œæˆ",
        "how_to": "reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦PDFãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã€ãƒ†ã‚­ã‚¹ãƒˆã‚„è¡¨ã‚’è¿½åŠ ã—ã¾ã™ã€‚",
        "sample_code": "from reportlab.pdfgen import canvas\nfrom reportlab.lib.pagesizes import A4, letter\nfrom reportlab.lib import colors\nfrom reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle, PageBreak\nfrom reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle\nfrom reportlab.lib.units import inch, cm\nfrom reportlab.pdfbase import pdfmetrics\nfrom reportlab.pdfbase.ttfonts import TTFont\nimport pandas as pd\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport os\nimport json\n\nprint('=== PDFè‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ“„ ãƒ“ã‚¸ãƒã‚¹ãƒ¬ãƒãƒ¼ãƒˆã®PDFè‡ªå‹•ç”Ÿæˆã‚’å®Ÿè¡Œã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ä½œæˆ')\nprint('â€¢ å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–')\nprint('â€¢ çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º')\nprint('â€¢ ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ')\n\ntry:\n    # ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\n    print('\\nğŸ“Š ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # æœˆæ¬¡å£²ä¸Šãƒ‡ãƒ¼ã‚¿\n    months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ']\n    sales_data = [1200000, 1800000, 2200000, 1900000, 2800000, 3200000]\n    profit_data = [240000, 360000, 440000, 380000, 560000, 640000]\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥ãƒ‡ãƒ¼ã‚¿\n    sales_team = {\n        'å–¶æ¥­æ‹…å½“è€…': ['ç”°ä¸­å¤ªéƒ', 'ä½è—¤èŠ±å­', 'éˆ´æœ¨ä¸€éƒ', 'é«˜æ©‹ç¾å’²', 'ä¼Šè—¤å¥å¤ª'],\n        'å£²ä¸Š': [2800000, 3200000, 2900000, 3500000, 3100000],\n        'é”æˆç‡': [105, 120, 108, 130, 115]\n    }\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    df_sales = pd.DataFrame({'æœˆ': months, 'å£²ä¸Š': sales_data, 'åˆ©ç›Š': profit_data})\n    df_team = pd.DataFrame(sales_team)\n    \n    # çµ±è¨ˆè¨ˆç®—\n    total_sales = sum(sales_data)\n    total_profit = sum(profit_data)\n    avg_sales = total_sales / len(sales_data)\n    profit_margin = (total_profit / total_sales) * 100\n    growth_rate = ((sales_data[-1] / sales_data[0] - 1) * 100)\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n    \n    plt.figure(figsize=(15, 10))\n    \n    # å£²ä¸Šæ¨ç§»ã‚°ãƒ©ãƒ•\n    plt.subplot(2, 2, 1)\n    plt.plot(months, sales_data, marker='o', linewidth=3, markersize=8, color='#2E86AB', label='å£²ä¸Š')\n    plt.plot(months, profit_data, marker='s', linewidth=3, markersize=8, color='#A23B72', label='åˆ©ç›Š')\n    plt.title('æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šæ¨ç§»', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('æœˆ', fontsize=12)\n    plt.ylabel('é‡‘é¡ï¼ˆå††ï¼‰', fontsize=12)\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.xticks(rotation=45)\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š\n    plt.subplot(2, 2, 2)\n    bars = plt.bar(df_team['å–¶æ¥­æ‹…å½“è€…'], df_team['å£²ä¸Š'], color='#F18F01', alpha=0.7)\n    plt.title('å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    plt.ylabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    plt.xticks(rotation=45)\n    plt.grid(True, alpha=0.3, axis='y')\n    \n    # é”æˆç‡ã‚°ãƒ©ãƒ•\n    plt.subplot(2, 2, 3)\n    colors_list = ['#C6EFCE' if x >= 100 else '#FFC7CE' for x in df_team['é”æˆç‡']]\n    bars = plt.bar(df_team['å–¶æ¥­æ‹…å½“è€…'], df_team['é”æˆç‡'], color=colors_list, alpha=0.7)\n    plt.axhline(y=100, color='red', linestyle='--', alpha=0.7, label='ç›®æ¨™ãƒ©ã‚¤ãƒ³')\n    plt.title('å–¶æ¥­æ‹…å½“è€…åˆ¥é”æˆç‡', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    plt.ylabel('é”æˆç‡ï¼ˆ%ï¼‰', fontsize=12)\n    plt.xticks(rotation=45)\n    plt.legend()\n    plt.grid(True, alpha=0.3, axis='y')\n    \n    # çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    plt.subplot(2, 2, 4)\n    plt.axis('off')\n    summary_text = f'''\n    æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚µãƒãƒªãƒ¼:\n    \n    â€¢ ç·å£²ä¸Š: {total_sales:,}å††\n    â€¢ ç·åˆ©ç›Š: {total_profit:,}å††\n    â€¢ å¹³å‡æœˆå£²ä¸Š: {avg_sales:,.0f}å††\n    â€¢ åˆ©ç›Šç‡: {profit_margin:.1f}%\n    â€¢ æˆé•·ç‡: {growth_rate:.1f}%\n    â€¢ å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    plt.text(0.1, 0.5, summary_text, fontsize=12, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    plt.tight_layout()\n    plt.savefig('monthly_report_charts.png', dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # PDFãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ\n    print('\\nğŸ“„ PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆä¸­...')\n    \n    filename = f'æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.pdf'\n    doc = SimpleDocTemplate(filename, pagesize=A4, rightMargin=2*cm, leftMargin=2*cm, topMargin=2*cm, bottomMargin=2*cm)\n    styles = getSampleStyleSheet()\n    \n    # ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ«\n    title_style = ParagraphStyle(\n        'CustomTitle',\n        parent=styles['Heading1'],\n        fontSize=24,\n        spaceAfter=30,\n        alignment=1,  # ä¸­å¤®æƒãˆ\n        textColor=colors.HexColor('#2E86AB')\n    )\n    \n    subtitle_style = ParagraphStyle(\n        'CustomSubtitle',\n        parent=styles['Heading2'],\n        fontSize=16,\n        spaceAfter=20,\n        textColor=colors.HexColor('#366092')\n    )\n    \n    # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒªã‚¹ãƒˆ\n    story = []\n    \n    # ã‚¿ã‚¤ãƒˆãƒ«ãƒšãƒ¼ã‚¸\n    title = Paragraph('æœˆæ¬¡å–¶æ¥­ãƒ¬ãƒãƒ¼ãƒˆ', title_style)\n    story.append(title)\n    \n    # æ—¥ä»˜\n    date_text = f'ä½œæˆæ—¥: {datetime.now().strftime(\"%Yå¹´%mæœˆ%dæ—¥\")}'\n    date_para = Paragraph(date_text, styles['Normal'])\n    story.append(date_para)\n    story.append(Spacer(1, 30))\n    \n    # ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼\n    summary_title = Paragraph('ğŸ“Š ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼', subtitle_style)\n    story.append(summary_title)\n    story.append(Spacer(1, 12))\n    \n    summary_data = [\n        ['é …ç›®', 'é‡‘é¡', 'å‰æœˆæ¯”', 'é”æˆç‡'],\n        ['ç·å£²ä¸Š', f'{total_sales:,}å††', f'{growth_rate:+.1f}%', '120%'],\n        ['å–¶æ¥­åˆ©ç›Š', f'{total_profit:,}å††', f'{((profit_data[-1]/profit_data[-2]-1)*100):+.1f}%', '125%'],\n        ['å¹³å‡æœˆå£²ä¸Š', f'{avg_sales:,.0f}å††', f'{((avg_sales/(total_sales/len(sales_data))-1)*100):+.1f}%', '110%'],\n        ['åˆ©ç›Šç‡', f'{profit_margin:.1f}%', f'{((profit_margin/((total_profit-total_profit/len(profit_data))/(total_sales-total_sales/len(sales_data))*100)-1)*100):+.1f}%', '105%']\n    ]\n    \n    summary_table = Table(summary_data, colWidths=[2*inch, 1.5*inch, 1*inch, 1*inch])\n    summary_table.setStyle(TableStyle([\n        ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#366092')),\n        ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),\n        ('ALIGN', (0, 0), (-1, -1), 'CENTER'),\n        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n        ('FONTSIZE', (0, 0), (-1, 0), 12),\n        ('BOTTOMPADDING', (0, 0), (-1, 0), 12),\n        ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#E7E6E6')),\n        ('GRID', (0, 0), (-1, -1), 1, colors.black),\n        ('FONTNAME', (0, 1), (-1, -1), 'Helvetica'),\n        ('FONTSIZE', (0, 1), (-1, -1), 10)\n    ]))\n    story.append(summary_table)\n    story.append(Spacer(1, 30))\n    \n    # ãƒšãƒ¼ã‚¸åŒºåˆ‡ã‚Š\n    story.append(PageBreak())\n    \n    # è©³ç´°åˆ†æ\n    detail_title = Paragraph('ğŸ“ˆ è©³ç´°åˆ†æ', subtitle_style)\n    story.append(detail_title)\n    story.append(Spacer(1, 12))\n    \n    # å£²ä¸Šåˆ†æ\n    sales_analysis = f'''\n    <b>å£²ä¸Šåˆ†æ:</b><br/>\n    â€¢ ä»Šæœˆã®å£²ä¸Šã¯å‰æœˆæ¯”{((sales_data[-1]/sales_data[-2]-1)*100):+.1f}%ã®{'å¢—åŠ ' if sales_data[-1] > sales_data[-2] else 'æ¸›å°‘'}ã‚’è¨˜éŒ²<br/>\n    â€¢ 6ãƒ¶æœˆé–“ã®ç´¯è¨ˆå£²ä¸Šã¯{total_sales:,}å††ã§ã€ç›®æ¨™ã‚’120%é”æˆ<br/>\n    â€¢ æ–°å•†å“ã®å£²ä¸ŠãŒå…¨ä½“ã®30%ã‚’å ã‚ã€æˆé•·ã®åŸå‹•åŠ›ã¨ãªã£ã¦ã„ã¾ã™<br/>\n    â€¢ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è²©å£²ãŒå…¨ä½“ã®60%ã‚’å ã‚ã€ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ãŒé€²ã‚“ã§ã„ã¾ã™<br/><br/>\n    \n    <b>åˆ©ç›Šåˆ†æ:</b><br/>\n    â€¢ åˆ©ç›Šç‡ã¯{profit_margin:.1f}%ã§ã€æ¥­ç•Œå¹³å‡ã‚’ä¸Šå›ã£ã¦ã„ã¾ã™<br/>\n    â€¢ ã‚³ã‚¹ãƒˆå‰Šæ¸›ã«ã‚ˆã‚Šåˆ©ç›Šç‡ãŒå‰å¹´æ¯”+2.5%æ”¹å–„<br/>\n    â€¢ å›ºå®šè²»ã®åŠ¹ç‡åŒ–ã«ã‚ˆã‚Šåˆ©ç›Šã®å®‰å®šæ€§ãŒå‘ä¸Š<br/><br/>\n    \n    <b>å–¶æ¥­ãƒãƒ¼ãƒ åˆ†æ:</b><br/>\n    â€¢ å…¨å–¶æ¥­æ‹…å½“è€…ã®å¹³å‡é”æˆç‡ã¯{df_team['é”æˆç‡'].mean():.1f}%<br/>\n    â€¢ ä¸Šä½3åã®å–¶æ¥­æ‹…å½“è€…ãŒå…¨ä½“ã®65%ã®å£²ä¸Šã‚’è²¢çŒ®<br/>\n    â€¢ æ–°äººå–¶æ¥­æ‹…å½“è€…ã®è‚²æˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒåŠ¹æœã‚’ç™ºæ®<br/><br/>\n    \n    <b>ä»Šå¾Œã®æ–¹é‡:</b><br/>\n    â€¢ å¥½èª¿ãªæ–°å•†å“ã®è²©å£²å¼·åŒ–ã‚’ç¶™ç¶š<br/>\n    â€¢ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è²©å£²ãƒãƒ£ãƒãƒ«ã®æ‹¡å¤§<br/>\n    â€¢ å–¶æ¥­ãƒãƒ¼ãƒ ã®ã‚¹ã‚­ãƒ«å‘ä¸Šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿæ–½<br/>\n    â€¢ é¡§å®¢ã‚µãƒãƒ¼ãƒˆä½“åˆ¶ã®å¼·åŒ–\n    '''\n    \n    detail_para = Paragraph(sales_analysis, styles['Normal'])\n    story.append(detail_para)\n    story.append(Spacer(1, 30))\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°\n    team_title = Paragraph('ğŸ‘¥ å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°', subtitle_style)\n    story.append(team_title)\n    story.append(Spacer(1, 12))\n    \n    team_data = [['å–¶æ¥­æ‹…å½“è€…', 'å£²ä¸Š', 'é”æˆç‡', 'è©•ä¾¡']]\n    for _, row in df_team.iterrows():\n        evaluation = 'å„ªç§€' if row['é”æˆç‡'] >= 120 else 'è‰¯å¥½' if row['é”æˆç‡'] >= 100 else 'è¦æ”¹å–„'\n        team_data.append([\n            row['å–¶æ¥­æ‹…å½“è€…'],\n            f'{row[\"å£²ä¸Š\"]:,}å††',\n            f'{row[\"é”æˆç‡\"]}%',\n            evaluation\n        ])\n    \n    team_table = Table(team_data, colWidths=[1.5*inch, 1.5*inch, 1*inch, 1*inch])\n    team_table.setStyle(TableStyle([\n        ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#366092')),\n        ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),\n        ('ALIGN', (0, 0), (-1, -1), 'CENTER'),\n        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n        ('FONTSIZE', (0, 0), (-1, 0), 12),\n        ('BOTTOMPADDING', (0, 0), (-1, 0), 12),\n        ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#E7E6E6')),\n        ('GRID', (0, 0), (-1, -1), 1, colors.black),\n        ('FONTNAME', (0, 1), (-1, -1), 'Helvetica'),\n        ('FONTSIZE', (0, 1), (-1, -1), 10)\n    ]))\n    story.append(team_table)\n    \n    # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ãƒ“ãƒ«ãƒ‰\n    doc.build(story)\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_sales': total_sales,\n        'total_profit': total_profit,\n        'profit_margin': profit_margin,\n        'growth_rate': growth_rate,\n        'files_created': [filename, 'monthly_report_charts.png'],\n        'status': 'SUCCESS'\n    }\n    \n    with open('pdf_generation_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print(f'\\nâœ… PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ: {filename}')\n    print('\\nğŸ“„ ä½œæˆã•ã‚ŒãŸå†…å®¹:')\n    print('â€¢ ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼')\n    print('â€¢ è©³ç´°åˆ†æï¼ˆå£²ä¸Šãƒ»åˆ©ç›Šãƒ»å–¶æ¥­ãƒãƒ¼ãƒ ï¼‰')\n    print('â€¢ å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°è¡¨')\n    print('â€¢ çµ±è¨ˆæƒ…å ±ã¨ã‚°ãƒ©ãƒ•')\n    \n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ ç·å£²ä¸Š: {total_sales:,}å††')\n    print(f'â€¢ ç·åˆ©ç›Š: {total_profit:,}å††')\n    print(f'â€¢ åˆ©ç›Šç‡: {profit_margin:.1f}%')\n    print(f'â€¢ æˆé•·ç‡: {growth_rate:.1f}%')\n    print(f'â€¢ å¹³å‡é”æˆç‡: {df_team[\"é”æˆç‡\"].mean():.1f}%')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {filename} (PDFãƒ•ã‚¡ã‚¤ãƒ«)')\n    print(f'â€¢ monthly_report_charts.png (ã‚°ãƒ©ãƒ•)')\n    print(f'â€¢ pdf_generation_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== PDFè‡ªå‹•ç”Ÿæˆå®Œäº† ===')\nprint('ğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ã€‚')",
        "libraries": "reportlabã€pandasã€matplotlibã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "Pythonã§PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€ãƒ¬ãƒãƒ¼ãƒˆã‚„è«‹æ±‚æ›¸ã®ä½œæˆã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["ãƒ¬ãƒãƒ¼ãƒˆä½œæˆãŒè‡ªå‹•åŒ–", "ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒçµ±ä¸€ã•ã‚Œã‚‹", "å¤§é‡ã®PDFã‚‚ä¸€æ‹¬ä½œæˆ", "ã‚°ãƒ©ãƒ•ã¨è¡¨ã®è‡ªå‹•æŒ¿å…¥", "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§PDFè‡ªå‹•ç”Ÿæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æœˆæ¬¡å–¶æ¥­ãƒ¬ãƒãƒ¼ãƒˆã®PDFã‚’ä½œæˆã™ã‚‹\n3. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼ã€è©³ç´°åˆ†æã€å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°ã‚’å«ã‚ã‚‹\n4. å£²ä¸Šãƒ»åˆ©ç›Šãƒ»é”æˆç‡ã®çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹\n5. è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã«ã™ã‚‹\n6. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n\nPDFå†…å®¹: æœˆæ¬¡å–¶æ¥­ãƒ¬ãƒãƒ¼ãƒˆ\nè¡¨ç¤ºé …ç›®: å£²ä¸Šã€åˆ©ç›Šã€é”æˆç‡ã€å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°\nãƒ•ã‚¡ã‚¤ãƒ«å: monthly_report.pdf\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§PDFè‡ªå‹•ç”Ÿæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æœˆæ¬¡å–¶æ¥­ãƒ¬ãƒãƒ¼ãƒˆã®PDFã‚’ä½œæˆã—ã€ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼ã€è©³ç´°åˆ†æã€å–¶æ¥­æ‹…å½“è€…åˆ¥è©³ç´°ã‚’å«ã‚ã¦å£²ä¸Šãƒ»åˆ©ç›Šãƒ»é”æˆç‡ã®çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã«ã—ã¦ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 4, 
        "category": "ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»åˆ†æ",
        "number": "4/100",
        "title": "Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°", 
        "desc": "Webã‚µã‚¤ãƒˆã‹ã‚‰è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿å–å¾—",
        "how_to": "requestsã¨BeautifulSoupã‚’ä½¿ã£ã¦Webãƒšãƒ¼ã‚¸ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã¾ã™ã€‚",
        "sample_code": "import requests\nfrom bs4 import BeautifulSoup\nimport pandas as pd\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nimport time\nimport json\nimport os\nfrom datetime import datetime\nimport re\nfrom urllib.parse import urljoin, urlparse\n\nprint('=== Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸŒ ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•åé›†ã¨åˆ†æã‚’å®Ÿè¡Œã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ å®‰å…¨ãªWebã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°')\nprint('â€¢ ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã¨ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°')\nprint('â€¢ çµ±è¨ˆåˆ†æã¨å¯è¦–åŒ–')\nprint('â€¢ è¤‡æ•°å½¢å¼ã§ã®å‡ºåŠ›')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ åˆ©ç”¨è¦ç´„ã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„')\nprint('â€¢ éåº¦ãªã‚¢ã‚¯ã‚»ã‚¹ã¯é¿ã‘ã¦ãã ã•ã„')\nprint('â€¢ robots.txtã‚’ç¢ºèªã—ã¦ãã ã•ã„')\nprint('â€¢ å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ä½¿ç”¨ç›®çš„ã‚’æ˜ç¢ºã«ã—ã¦ãã ã•ã„')\n\ntry:\n    # ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆï¼ˆå®Ÿéš›ã®Webã‚µã‚¤ãƒˆã®ä»£ã‚ã‚Šï¼‰\n    print('\\nğŸ“Š ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«å•†å“ãƒ‡ãƒ¼ã‚¿\n    sample_products = [\n        {\n            'å•†å“å': 'MacBook Pro 14ã‚¤ãƒ³ãƒ',\n            'ä¾¡æ ¼': '298,000',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Apple',\n            'è©•ä¾¡': '4.8',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '1,234',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product1'\n        },\n        {\n            'å•†å“å': 'ThinkPad X1 Carbon',\n            'ä¾¡æ ¼': '245,000',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Lenovo',\n            'è©•ä¾¡': '4.6',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '856',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product2'\n        },\n        {\n            'å•†å“å': 'Dell XPS 13',\n            'ä¾¡æ ¼': '198,000',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Dell',\n            'è©•ä¾¡': '4.7',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '1,567',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product3'\n        },\n        {\n            'å•†å“å': 'ãƒ­ã‚¸ã‚¯ãƒ¼ãƒ« MX Master 3',\n            'ä¾¡æ ¼': '12,800',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒã‚¦ã‚¹',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Logitech',\n            'è©•ä¾¡': '4.9',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '2,345',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product4'\n        },\n        {\n            'å•†å“å': 'Apple Magic Keyboard',\n            'ä¾¡æ ¼': '15,800',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Apple',\n            'è©•ä¾¡': '4.5',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '987',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product5'\n        },\n        {\n            'å•†å“å': 'Samsung 27ã‚¤ãƒ³ãƒ ãƒ¢ãƒ‹ã‚¿ãƒ¼',\n            'ä¾¡æ ¼': '32,800',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒ¢ãƒ‹ã‚¿ãƒ¼',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Samsung',\n            'è©•ä¾¡': '4.4',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '654',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product6'\n        },\n        {\n            'å•†å“å': 'SanDisk Extreme Pro 1TB',\n            'ä¾¡æ ¼': '8,980',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'SanDisk',\n            'è©•ä¾¡': '4.8',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '1,789',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product7'\n        },\n        {\n            'å•†å“å': 'Jabra Evolve 75',\n            'ä¾¡æ ¼': '18,500',\n            'ã‚«ãƒ†ã‚´ãƒª': 'ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ',\n            'ãƒ–ãƒ©ãƒ³ãƒ‰': 'Jabra',\n            'è©•ä¾¡': '4.6',\n            'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': '432',\n            'åœ¨åº«': 'åœ¨åº«ã‚ã‚Š',\n            'URL': 'https://example.com/product8'\n        }\n    ]\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    df = pd.DataFrame(sample_products)\n    \n    # ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°\n    print('\\nğŸ§¹ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å®Ÿè¡Œä¸­...')\n    \n    # ä¾¡æ ¼ã‚’æ•°å€¤ã«å¤‰æ›\n    df['ä¾¡æ ¼'] = df['ä¾¡æ ¼'].str.replace(',', '').astype(int)\n    \n    # è©•ä¾¡ã‚’æ•°å€¤ã«å¤‰æ›\n    df['è©•ä¾¡'] = df['è©•ä¾¡'].astype(float)\n    \n    # ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°ã‚’æ•°å€¤ã«å¤‰æ›\n    df['ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°'] = df['ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°'].str.replace(',', '').astype(int)\n    \n    # å–å¾—æ—¥æ™‚ã‚’è¿½åŠ \n    df['å–å¾—æ—¥æ™‚'] = datetime.now().strftime('%Y-%m-%d %H:%M:%S')\n    \n    print(f'ãƒ‡ãƒ¼ã‚¿ä»¶æ•°: {len(df)}ä»¶')\n    print(f'ã‚«ãƒ†ã‚´ãƒªæ•°: {df[\"ã‚«ãƒ†ã‚´ãƒª\"].nunique()}ç¨®é¡')\n    print(f'ãƒ–ãƒ©ãƒ³ãƒ‰æ•°: {df[\"ãƒ–ãƒ©ãƒ³ãƒ‰\"].nunique()}ç¨®é¡')\n    \n    # ãƒ‡ãƒ¼ã‚¿åˆ†æ\n    print('\\nğŸ“ˆ ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å®Ÿè¡Œä¸­...')\n    \n    # åŸºæœ¬çµ±è¨ˆ\n    total_products = len(df)\n    total_value = df['ä¾¡æ ¼'].sum()\n    avg_price = df['ä¾¡æ ¼'].mean()\n    max_price = df['ä¾¡æ ¼'].max()\n    min_price = df['ä¾¡æ ¼'].min()\n    avg_rating = df['è©•ä¾¡'].mean()\n    \n    # ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†æ\n    category_stats = df.groupby('ã‚«ãƒ†ã‚´ãƒª').agg({\n        'ä¾¡æ ¼': ['count', 'mean', 'sum'],\n        'è©•ä¾¡': 'mean',\n        'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': 'sum'\n    }).round(2)\n    \n    # ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥åˆ†æ\n    brand_stats = df.groupby('ãƒ–ãƒ©ãƒ³ãƒ‰').agg({\n        'ä¾¡æ ¼': ['count', 'mean'],\n        'è©•ä¾¡': 'mean',\n        'ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°': 'sum'\n    }).round(2)\n    \n    # ä¾¡æ ¼å¸¯åˆ†æ\n    df['ä¾¡æ ¼å¸¯'] = pd.cut(df['ä¾¡æ ¼'], \n                        bins=[0, 10000, 50000, 100000, float('inf')],\n                        labels=['1ä¸‡å††æœªæº€', '1-5ä¸‡å††', '5-10ä¸‡å††', '10ä¸‡å††ä»¥ä¸Š'])\n    \n    price_range_stats = df.groupby('ä¾¡æ ¼å¸¯').size()\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n    \n    plt.figure(figsize=(15, 12))\n    \n    # ã‚«ãƒ†ã‚´ãƒªåˆ¥å•†å“æ•°\n    plt.subplot(2, 3, 1)\n    category_counts = df['ã‚«ãƒ†ã‚´ãƒª'].value_counts()\n    plt.pie(category_counts.values, labels=category_counts.index, autopct='%1.1f%%', startangle=90)\n    plt.title('ã‚«ãƒ†ã‚´ãƒªåˆ¥å•†å“æ•°', fontsize=14, fontweight='bold', pad=20)\n    \n    # ä¾¡æ ¼åˆ†å¸ƒ\n    plt.subplot(2, 3, 2)\n    plt.hist(df['ä¾¡æ ¼'], bins=10, color='#2E86AB', alpha=0.7, edgecolor='black')\n    plt.title('ä¾¡æ ¼åˆ†å¸ƒ', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('ä¾¡æ ¼ï¼ˆå††ï¼‰', fontsize=12)\n    plt.ylabel('å•†å“æ•°', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # è©•ä¾¡åˆ†å¸ƒ\n    plt.subplot(2, 3, 3)\n    plt.hist(df['è©•ä¾¡'], bins=8, color='#A23B72', alpha=0.7, edgecolor='black')\n    plt.title('è©•ä¾¡åˆ†å¸ƒ', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('è©•ä¾¡', fontsize=12)\n    plt.ylabel('å•†å“æ•°', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥å¹³å‡ä¾¡æ ¼\n    plt.subplot(2, 3, 4)\n    brand_avg_price = df.groupby('ãƒ–ãƒ©ãƒ³ãƒ‰')['ä¾¡æ ¼'].mean().sort_values(ascending=True)\n    plt.barh(brand_avg_price.index, brand_avg_price.values, color='#F18F01', alpha=0.7)\n    plt.title('ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥å¹³å‡ä¾¡æ ¼', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('å¹³å‡ä¾¡æ ¼ï¼ˆå††ï¼‰', fontsize=12)\n    plt.ylabel('ãƒ–ãƒ©ãƒ³ãƒ‰', fontsize=12)\n    plt.grid(True, alpha=0.3, axis='x')\n    \n    # ä¾¡æ ¼ã¨è©•ä¾¡ã®é–¢ä¿‚\n    plt.subplot(2, 3, 5)\n    plt.scatter(df['ä¾¡æ ¼'], df['è©•ä¾¡'], alpha=0.7, color='#2E86AB', s=100)\n    plt.title('ä¾¡æ ¼ã¨è©•ä¾¡ã®é–¢ä¿‚', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('ä¾¡æ ¼ï¼ˆå††ï¼‰', fontsize=12)\n    plt.ylabel('è©•ä¾¡', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    plt.subplot(2, 3, 6)\n    plt.axis('off')\n    summary_text = f'''\n    ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°çµæœã‚µãƒãƒªãƒ¼:\n    \n    â€¢ ç·å•†å“æ•°: {total_products}ä»¶\n    â€¢ ç·ä¾¡æ ¼: {total_value:,}å††\n    â€¢ å¹³å‡ä¾¡æ ¼: {avg_price:,.0f}å††\n    â€¢ æœ€é«˜ä¾¡æ ¼: {max_price:,}å††\n    â€¢ æœ€ä½ä¾¡æ ¼: {min_price:,}å††\n    â€¢ å¹³å‡è©•ä¾¡: {avg_rating:.1f}/5.0\n    â€¢ å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    plt.text(0.1, 0.5, summary_text, fontsize=12, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    plt.tight_layout()\n    plt.savefig('web_scraping_analysis.png', dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›\n    print('\\nğŸ’¾ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ä¸­...')\n    \n    # CSVãƒ•ã‚¡ã‚¤ãƒ«\n    csv_filename = f'products_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.csv'\n    df.to_csv(csv_filename, index=False, encoding='utf-8-sig')\n    \n    # Excelãƒ•ã‚¡ã‚¤ãƒ«\n    excel_filename = f'products_analysis_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.xlsx'\n    with pd.ExcelWriter(excel_filename, engine='openpyxl') as writer:\n        df.to_excel(writer, sheet_name='å•†å“ãƒ‡ãƒ¼ã‚¿', index=False)\n        category_stats.to_excel(writer, sheet_name='ã‚«ãƒ†ã‚´ãƒªåˆ¥çµ±è¨ˆ')\n        brand_stats.to_excel(writer, sheet_name='ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥çµ±è¨ˆ')\n        price_range_stats.to_frame('å•†å“æ•°').to_excel(writer, sheet_name='ä¾¡æ ¼å¸¯åˆ¥çµ±è¨ˆ')\n    \n    # JSONãƒ•ã‚¡ã‚¤ãƒ«\n    json_filename = f'scraping_results_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.json'\n    results_data = {\n        'metadata': {\n            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n            'total_products': total_products,\n            'total_value': total_value,\n            'avg_price': avg_price,\n            'avg_rating': avg_rating\n        },\n        'category_stats': category_stats.to_dict(),\n        'brand_stats': brand_stats.to_dict(),\n        'price_range_stats': price_range_stats.to_dict()\n    }\n    \n    with open(json_filename, 'w', encoding='utf-8') as f:\n        json.dump(results_data, f, ensure_ascii=False, indent=2, default=str)\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_products': total_products,\n        'total_value': total_value,\n        'avg_price': avg_price,\n        'avg_rating': avg_rating,\n        'files_created': [csv_filename, excel_filename, json_filename, 'web_scraping_analysis.png'],\n        'status': 'SUCCESS'\n    }\n    \n    with open('web_scraping_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print('\\nâœ… Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Œäº†ï¼')\n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ å•†å“æ•°: {total_products}ä»¶')\n    print(f'â€¢ ç·ä¾¡æ ¼: {total_value:,}å††')\n    print(f'â€¢ å¹³å‡ä¾¡æ ¼: {avg_price:,.0f}å††')\n    print(f'â€¢ å¹³å‡è©•ä¾¡: {avg_rating:.1f}/5.0')\n    print(f'â€¢ ã‚«ãƒ†ã‚´ãƒªæ•°: {df[\"ã‚«ãƒ†ã‚´ãƒª\"].nunique()}ç¨®é¡')\n    print(f'â€¢ ãƒ–ãƒ©ãƒ³ãƒ‰æ•°: {df[\"ãƒ–ãƒ©ãƒ³ãƒ‰\"].nunique()}ç¨®é¡')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {csv_filename} (CSVãƒ•ã‚¡ã‚¤ãƒ«)')\n    print(f'â€¢ {excel_filename} (Excelãƒ•ã‚¡ã‚¤ãƒ«)')\n    print(f'â€¢ {json_filename} (JSONãƒ•ã‚¡ã‚¤ãƒ«)')\n    print(f'â€¢ web_scraping_analysis.png (ã‚°ãƒ©ãƒ•)')\n    print(f'â€¢ web_scraping_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ å¯¾è±¡ã‚µã‚¤ãƒˆã®åˆ©ç”¨è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ é©åˆ‡ãªé–“éš”ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ï¼ˆtime.sleep()ã‚’ä½¿ç”¨ï¼‰')\n    print('â€¢ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é©åˆ‡ã«è¡Œã£ã¦ãã ã•ã„')\n    print('â€¢ å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ä½¿ç”¨ç›®çš„ã‚’æ˜ç¢ºã«ã—ã¦ãã ã•ã„')\n    print('â€¢ robots.txtã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Œäº† ===')",
        "libraries": "requestsã€beautifulsoup4ã€pandasã€matplotlibã€openpyxlã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã¯ã€Webã‚µã‚¤ãƒˆã‹ã‚‰è‡ªå‹•ã§æƒ…å ±ã‚’åé›†ã™ã‚‹æŠ€è¡“ã§ã™ã€‚ç«¶åˆèª¿æŸ»ã‚„ãƒ‡ãƒ¼ã‚¿åé›†ã«ä¾¿åˆ©ã§ã™ã€‚",
        "benefits": ["æ‰‹ä½œæ¥­ã®æ™‚é–“ã‚’å¤§å¹…å‰Šæ¸›", "å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚‚ç¬æ™‚ã«å–å¾—", "å®šæœŸçš„ãªæƒ…å ±åé›†ãŒè‡ªå‹•åŒ–", "ãƒ‡ãƒ¼ã‚¿åˆ†æã¨å¯è¦–åŒ–", "è¤‡æ•°å½¢å¼ã§ã®å‡ºåŠ›"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. requestsã¨BeautifulSoupã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸWebã‚µã‚¤ãƒˆã‹ã‚‰å•†å“æƒ…å ±ã‚’å–å¾—ã™ã‚‹\n3. ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨æ¤œè¨¼ã‚’è¡Œã†\n4. çµ±è¨ˆåˆ†æã¨å¯è¦–åŒ–ã‚’è¡Œã†\n5. è¤‡æ•°å½¢å¼ï¼ˆCSVã€Excelã€JSONï¼‰ã§å‡ºåŠ›ã™ã‚‹\n6. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n\nå¯¾è±¡ã‚µã‚¤ãƒˆ: [ã‚µã‚¤ãƒˆURLã‚’æŒ‡å®š]\nå–å¾—ã—ãŸã„æƒ…å ±: å•†å“åã€ä¾¡æ ¼ã€ã‚«ãƒ†ã‚´ãƒªã€ãƒ–ãƒ©ãƒ³ãƒ‰ã€è©•ä¾¡ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°\nå‡ºåŠ›å½¢å¼: CSVã€Excelã€JSONã€ã‚°ãƒ©ãƒ•\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚requestsã¨BeautifulSoupãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸWebã‚µã‚¤ãƒˆã‹ã‚‰å•†å“æƒ…å ±ã‚’å–å¾—ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨æ¤œè¨¼ã‚’è¡Œã£ã¦çµ±è¨ˆåˆ†æã¨å¯è¦–åŒ–ã‚’å®Ÿè¡Œã—ã€è¤‡æ•°å½¢å¼ã§å‡ºåŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 5, 
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "5/100",
        "title": "ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã‚°ãƒ©ãƒ•ä½œæˆ", 
        "desc": "ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•ã§è¦‹ã‚„ã™ãè¡¨ç¤º",
        "how_to": "matplotlibã‚„plotlyã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•åŒ–ã—ã€è¦‹ã‚„ã™ã„å›³è¡¨ã‚’ä½œæˆã—ã¾ã™ã€‚",
        "sample_code": "import matplotlib\nmatplotlib.use('Agg')  # Webç’°å¢ƒç”¨ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom datetime import datetime\nimport json\nimport os\n\nprint('=== ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã‚°ãƒ©ãƒ•ä½œæˆãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ“Š ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•å¯è¦–åŒ–ã¨åˆ†æã‚’å®Ÿè¡Œã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ è¤‡æ•°ç¨®é¡ã®ã‚°ãƒ©ãƒ•ä½œæˆ')\nprint('â€¢ è‡ªå‹•çµ±è¨ˆåˆ†æ')\nprint('â€¢ ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³')\nprint('â€¢ è¤‡æ•°å½¢å¼ã§ã®å‡ºåŠ›')\n\ntry:\n    # ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\n    print('\\nğŸ“Š ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # æœˆæ¬¡å£²ä¸Šãƒ‡ãƒ¼ã‚¿\n    months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ']\n    sales_data = [1200000, 1800000, 2200000, 1900000, 2800000, 3200000, 3500000, 3800000, 4200000, 4500000, 4800000, 5200000]\n    profit_data = [240000, 360000, 440000, 380000, 560000, 640000, 700000, 760000, 840000, 900000, 960000, 1040000]\n    \n    # å–¶æ¥­æ‹…å½“è€…åˆ¥ãƒ‡ãƒ¼ã‚¿\n    sales_team = {\n        'å–¶æ¥­æ‹…å½“è€…': ['ç”°ä¸­å¤ªéƒ', 'ä½è—¤èŠ±å­', 'éˆ´æœ¨ä¸€éƒ', 'é«˜æ©‹ç¾å’²', 'ä¼Šè—¤å¥å¤ª', 'å±±ç”°æ¬¡éƒ'],\n        'å£²ä¸Š': [2800000, 3200000, 2900000, 3500000, 3100000, 2600000],\n        'é”æˆç‡': [105, 120, 108, 130, 115, 98],\n        'é¡§å®¢æ•°': [45, 52, 38, 61, 43, 35]\n    }\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    df_sales = pd.DataFrame({'æœˆ': months, 'å£²ä¸Š': sales_data, 'åˆ©ç›Š': profit_data})\n    df_team = pd.DataFrame(sales_team)\n    \n    print(f'ãƒ‡ãƒ¼ã‚¿ä»¶æ•°: {len(df_sales)}ãƒ¶æœˆ')\n    print(f'å–¶æ¥­æ‹…å½“è€…æ•°: {len(df_team)}å')\n    print(f'å£²ä¸Šåˆè¨ˆ: {sum(sales_data):,}å††')\n    print(f'åˆ©ç›Šåˆè¨ˆ: {sum(profit_data):,}å††')\n    \n    # çµ±è¨ˆè¨ˆç®—\n    total_sales = sum(sales_data)\n    total_profit = sum(profit_data)\n    avg_sales = total_sales / len(sales_data)\n    profit_margin = (total_profit / total_sales) * 100\n    growth_rate = ((sales_data[-1] / sales_data[0] - 1) * 100)\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n    \n    # æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š\n    plt.rcParams['font.family'] = ['DejaVu Sans', 'Hiragino Sans', 'Yu Gothic', 'Meiryo', 'Takao', 'IPAexGothic', 'IPAPGothic', 'VL PGothic', 'Noto Sans CJK JP']\n    \n    # ãƒ¡ã‚¤ãƒ³ã®åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰\n    fig = plt.figure(figsize=(20, 15))\n    \n    # 1. æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šæ¨ç§»ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ï¼‰\n    ax1 = plt.subplot(3, 3, 1)\n    ax1.plot(months, sales_data, marker='o', linewidth=3, markersize=8, color='#2E86AB', label='å£²ä¸Š')\n    ax1.plot(months, profit_data, marker='s', linewidth=3, markersize=8, color='#A23B72', label='åˆ©ç›Š')\n    ax1.set_title('æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šæ¨ç§»', fontsize=16, fontweight='bold', pad=20)\n    ax1.set_xlabel('æœˆ', fontsize=12)\n    ax1.set_ylabel('é‡‘é¡ï¼ˆå††ï¼‰', fontsize=12)\n    ax1.legend(fontsize=10)\n    ax1.grid(True, alpha=0.3)\n    ax1.tick_params(axis='x', rotation=45)\n    \n    # 2. å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Šï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰\n    ax2 = plt.subplot(3, 3, 2)\n    bars = ax2.bar(df_team['å–¶æ¥­æ‹…å½“è€…'], df_team['å£²ä¸Š'], color='#F18F01', alpha=0.7)\n    ax2.set_title('å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š', fontsize=16, fontweight='bold', pad=20)\n    ax2.set_xlabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    ax2.set_ylabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    ax2.tick_params(axis='x', rotation=45)\n    ax2.grid(True, alpha=0.3, axis='y')\n    \n    # æ£’ã‚°ãƒ©ãƒ•ã«æ•°å€¤ã‚’è¡¨ç¤º\n    for bar, value in zip(bars, df_team['å£²ä¸Š']):\n        height = bar.get_height()\n        ax2.text(bar.get_x() + bar.get_width()/2., height + 100000,\n                f'{value/10000:.0f}ä¸‡', ha='center', va='bottom', fontweight='bold', fontsize=10)\n    \n    # 3. é”æˆç‡åˆ†å¸ƒï¼ˆãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ï¼‰\n    ax3 = plt.subplot(3, 3, 3)\n    ax3.hist(df_team['é”æˆç‡'], bins=6, color='#A23B72', alpha=0.7, edgecolor='black')\n    ax3.axvline(x=100, color='red', linestyle='--', alpha=0.7, label='ç›®æ¨™ãƒ©ã‚¤ãƒ³')\n    ax3.set_title('é”æˆç‡åˆ†å¸ƒ', fontsize=16, fontweight='bold', pad=20)\n    ax3.set_xlabel('é”æˆç‡ï¼ˆ%ï¼‰', fontsize=12)\n    ax3.set_ylabel('äººæ•°', fontsize=12)\n    ax3.legend()\n    ax3.grid(True, alpha=0.3)\n    \n    # 4. å£²ä¸Šã¨åˆ©ç›Šã®é–¢ä¿‚ï¼ˆæ•£å¸ƒå›³ï¼‰\n    ax4 = plt.subplot(3, 3, 4)\n    ax4.scatter(sales_data, profit_data, alpha=0.7, color='#2E86AB', s=100)\n    ax4.set_title('å£²ä¸Šã¨åˆ©ç›Šã®é–¢ä¿‚', fontsize=16, fontweight='bold', pad=20)\n    ax4.set_xlabel('å£²ä¸Šï¼ˆå††ï¼‰', fontsize=12)\n    ax4.set_ylabel('åˆ©ç›Šï¼ˆå††ï¼‰', fontsize=12)\n    ax4.grid(True, alpha=0.3)\n    \n    # 5. æœˆåˆ¥å£²ä¸Šæ¯”ç‡ï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰\n    ax5 = plt.subplot(3, 3, 5)\n    total_sales = sum(sales_data)\n    percentages = [s/total_sales*100 for s in sales_data]\n    colors = plt.cm.Set3(np.linspace(0, 1, len(months)))\n    \n    wedges, texts, autotexts = ax5.pie(percentages, labels=months, autopct='%1.1f%%',\n                                       colors=colors, startangle=90)\n    ax5.set_title('æœˆåˆ¥å£²ä¸Šæ¯”ç‡', fontsize=16, fontweight='bold', pad=20)\n    \n    # 6. å–¶æ¥­æ‹…å½“è€…åˆ¥é¡§å®¢æ•°ï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ï¼‰\n    ax6 = plt.subplot(3, 3, 6)\n    bars = ax6.barh(df_team['å–¶æ¥­æ‹…å½“è€…'], df_team['é¡§å®¢æ•°'], color='#F18F01', alpha=0.7)\n    ax6.set_title('å–¶æ¥­æ‹…å½“è€…åˆ¥é¡§å®¢æ•°', fontsize=16, fontweight='bold', pad=20)\n    ax6.set_xlabel('é¡§å®¢æ•°', fontsize=12)\n    ax6.set_ylabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    ax6.grid(True, alpha=0.3, axis='x')\n    \n    # 7. æœˆæ¬¡æˆé•·ç‡ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ï¼‰\n    ax7 = plt.subplot(3, 3, 7)\n    growth_rates = []\n    for i in range(1, len(sales_data)):\n        growth = ((sales_data[i] / sales_data[i-1] - 1) * 100)\n        growth_rates.append(growth)\n    \n    ax7.plot(months[1:], growth_rates, marker='o', linewidth=3, markersize=8, color='#2E86AB')\n    ax7.axhline(y=0, color='red', linestyle='--', alpha=0.7)\n    ax7.set_title('æœˆæ¬¡æˆé•·ç‡', fontsize=16, fontweight='bold', pad=20)\n    ax7.set_xlabel('æœˆ', fontsize=12)\n    ax7.set_ylabel('æˆé•·ç‡ï¼ˆ%ï¼‰', fontsize=12)\n    ax7.grid(True, alpha=0.3)\n    ax7.tick_params(axis='x', rotation=45)\n    \n    # 8. å–¶æ¥­æ‹…å½“è€…åˆ¥é”æˆç‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰\n    ax8 = plt.subplot(3, 3, 8)\n    colors_list = ['#C6EFCE' if x >= 100 else '#FFC7CE' for x in df_team['é”æˆç‡']]\n    bars = ax8.bar(df_team['å–¶æ¥­æ‹…å½“è€…'], df_team['é”æˆç‡'], color=colors_list, alpha=0.7)\n    ax8.axhline(y=100, color='red', linestyle='--', alpha=0.7, label='ç›®æ¨™ãƒ©ã‚¤ãƒ³')\n    ax8.set_title('å–¶æ¥­æ‹…å½“è€…åˆ¥é”æˆç‡', fontsize=16, fontweight='bold', pad=20)\n    ax8.set_xlabel('å–¶æ¥­æ‹…å½“è€…', fontsize=12)\n    ax8.set_ylabel('é”æˆç‡ï¼ˆ%ï¼‰', fontsize=12)\n    ax8.tick_params(axis='x', rotation=45)\n    ax8.legend()\n    ax8.grid(True, alpha=0.3, axis='y')\n    \n    # 9. çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    ax9 = plt.subplot(3, 3, 9)\n    ax9.axis('off')\n    summary_text = f'''\n    ãƒ“ã‚¸ãƒã‚¹åˆ†æã‚µãƒãƒªãƒ¼:\n    \n    ğŸ“Š å£²ä¸Šåˆ†æ:\n    â€¢ ç·å£²ä¸Š: {total_sales:,}å††\n    â€¢ å¹³å‡æœˆå£²ä¸Š: {avg_sales:,.0f}å††\n    â€¢ å¹´é–“æˆé•·ç‡: {growth_rate:.1f}%\n    \n    ğŸ’° åˆ©ç›Šåˆ†æ:\n    â€¢ ç·åˆ©ç›Š: {total_profit:,}å††\n    â€¢ åˆ©ç›Šç‡: {profit_margin:.1f}%\n    \n    ğŸ‘¥ å–¶æ¥­åˆ†æ:\n    â€¢ å¹³å‡é”æˆç‡: {df_team['é”æˆç‡'].mean():.1f}%\n    â€¢ æœ€é«˜å£²ä¸Š: {df_team['å£²ä¸Š'].max():,}å††\n    â€¢ ç·é¡§å®¢æ•°: {df_team['é¡§å®¢æ•°'].sum()}å\n    \n    ğŸ“… å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    ax9.text(0.05, 0.5, summary_text, fontsize=11, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    plt.tight_layout()\n    \n    # ã‚°ãƒ©ãƒ•ä¿å­˜\n    filename = f'business_analysis_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.png'\n    plt.savefig(filename, dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # è©³ç´°åˆ†æãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n    print('\\nğŸ“„ è©³ç´°åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆä¸­...')\n    \n    # çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’JSONå½¢å¼ã§ä¿å­˜\n    analysis_data = {\n        'metadata': {\n            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n            'total_months': len(months),\n            'total_sales_people': len(df_team)\n        },\n        'sales_analysis': {\n            'total_sales': total_sales,\n            'total_profit': total_profit,\n            'avg_monthly_sales': avg_sales,\n            'profit_margin': profit_margin,\n            'growth_rate': growth_rate,\n            'monthly_data': dict(zip(months, sales_data))\n        },\n        'team_analysis': {\n            'avg_achievement_rate': df_team['é”æˆç‡'].mean(),\n            'max_sales': df_team['å£²ä¸Š'].max(),\n            'total_customers': df_team['é¡§å®¢æ•°'].sum(),\n            'team_data': df_team.to_dict('records')\n        }\n    }\n    \n    json_filename = f'analysis_report_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.json'\n    with open(json_filename, 'w', encoding='utf-8') as f:\n        json.dump(analysis_data, f, ensure_ascii=False, indent=2, default=str)\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_sales': total_sales,\n        'total_profit': total_profit,\n        'growth_rate': growth_rate,\n        'files_created': [filename, json_filename],\n        'status': 'SUCCESS'\n    }\n    \n    with open('data_visualization_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print(f'\\nâœ… ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–å®Œäº†ï¼')\n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ ç·å£²ä¸Š: {total_sales:,}å††')\n    print(f'â€¢ ç·åˆ©ç›Š: {total_profit:,}å††')\n    print(f'â€¢ åˆ©ç›Šç‡: {profit_margin:.1f}%')\n    print(f'â€¢ å¹´é–“æˆé•·ç‡: {growth_rate:.1f}%')\n    print(f'â€¢ å¹³å‡é”æˆç‡: {df_team[\"é”æˆç‡\"].mean():.1f}%')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {filename} (åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰)')\n    print(f'â€¢ {json_filename} (è©³ç´°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ)')\n    print(f'â€¢ data_visualization_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \n    print('\\nğŸ“ˆ ä½œæˆã•ã‚ŒãŸã‚°ãƒ©ãƒ•:')\n    print('â€¢ æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šæ¨ç§»ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Šï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ é”æˆç‡åˆ†å¸ƒï¼ˆãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ï¼‰')\n    print('â€¢ å£²ä¸Šã¨åˆ©ç›Šã®é–¢ä¿‚ï¼ˆæ•£å¸ƒå›³ï¼‰')\n    print('â€¢ æœˆåˆ¥å£²ä¸Šæ¯”ç‡ï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ å–¶æ¥­æ‹…å½“è€…åˆ¥é¡§å®¢æ•°ï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ æœˆæ¬¡æˆé•·ç‡ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ å–¶æ¥­æ‹…å½“è€…åˆ¥é”æˆç‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰')\n    print('â€¢ çµ±è¨ˆã‚µãƒãƒªãƒ¼')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆãŒåˆ©ç”¨å¯èƒ½ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–å®Œäº† ===')\nprint('ğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦åŒã˜å‡¦ç†ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚')",
        "libraries": "matplotlibã€pandasã€seabornã€numpyã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã§ã€æ•°å­—ã®æ„å‘³ã‚’ç›´æ„Ÿçš„ã«ç†è§£ã§ãã¾ã™ã€‚ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã«ä¾¿åˆ©ã§ã™ã€‚",
        "benefits": ["ãƒ‡ãƒ¼ã‚¿ã®å‚¾å‘ãŒä¸€ç›®ã§åˆ†ã‹ã‚‹", "ãƒ—ãƒ¬ã‚¼ãƒ³ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚‹", "æ„æ€æ±ºå®šãŒã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—", "è¤‡æ•°ç¨®é¡ã®ã‚°ãƒ©ãƒ•ä½œæˆ", "è‡ªå‹•çµ±è¨ˆåˆ†æ", "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. matplotlibã¨seabornã‚’ä½¿ã†\n2. æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ã‚’è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã™ã‚‹\n3. å–¶æ¥­æ‹…å½“è€…åˆ¥ã®åˆ†æã‚‚å«ã‚ã‚‹\n4. çµ±è¨ˆåˆ†æã¨ã‚µãƒãƒªãƒ¼ã‚’ä½œæˆã™ã‚‹\n5. ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã«ã™ã‚‹\n6. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nãƒ‡ãƒ¼ã‚¿å½¢å¼: CSVãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæœˆã€å£²ä¸Šã€åˆ©ç›Šã€å–¶æ¥­æ‹…å½“è€…ãªã©ã®åˆ—ãŒã‚ã‚‹ï¼‰\nã‚°ãƒ©ãƒ•ã®ç¨®é¡: æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã€æ£’ã‚°ãƒ©ãƒ•ã€å††ã‚°ãƒ©ãƒ•ã€æ•£å¸ƒå›³ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ \n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚matplotlibã¨seabornãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æœˆæ¬¡å£²ä¸Šãƒ»åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ã‚’è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã—ã€å–¶æ¥­æ‹…å½“è€…åˆ¥ã®åˆ†æã‚‚å«ã‚ã¦çµ±è¨ˆåˆ†æã¨ã‚µãƒãƒªãƒ¼ã‚’ä½œæˆã—ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã«ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 6, 
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "6/100",
        "title": "ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†", 
        "desc": "ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§æ•´ç†",
        "how_to": "osãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¨®é¡åˆ¥ã«è‡ªå‹•æ•´ç†ã—ã¾ã™ã€‚",
        "sample_code": "import os\nimport shutil\nfrom pathlib import Path\nfrom datetime import datetime\nimport json\nimport pandas as pd\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\n\nprint('=== ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ“ ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§æ•´ç†ãƒ»åˆ†æã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡åˆ¥ã®è‡ªå‹•åˆ†é¡')\nprint('â€¢ é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡º')\nprint('â€¢ å®¹é‡åˆ†æã¨å¯è¦–åŒ–')\nprint('â€¢ æ•´ç†ãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯äº‹å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„')\nprint('â€¢ ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç§»å‹•ã—ãªã„ã§ãã ã•ã„')\nprint('â€¢ ç§»å‹•å…ˆã®ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯è‡ªå‹•ä½œæˆã•ã‚Œã¾ã™')\n\ntry:\n    # ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆï¼ˆå®Ÿéš›ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ä»£ã‚ã‚Šï¼‰\n    print('\\nğŸ“‚ ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆï¼ˆã‚ˆã‚Šç¾å®Ÿçš„ãªãƒ‡ãƒ¼ã‚¿ï¼‰\n    sample_files = [\n        {'name': 'document1.pdf', 'size': 2048576, 'date': '2024-01-15'},\n        {'name': 'photo1.jpg', 'size': 3145728, 'date': '2024-01-16'},\n        {'name': 'video1.mp4', 'size': 52428800, 'date': '2024-01-17'},\n        {'name': 'music1.mp3', 'size': 5242880, 'date': '2024-01-18'},\n        {'name': 'report.docx', 'size': 1048576, 'date': '2024-01-19'},\n        {'name': 'image.png', 'size': 1572864, 'date': '2024-01-20'},\n        {'name': 'presentation.pptx', 'size': 2097152, 'date': '2024-01-21'},\n        {'name': 'song.wav', 'size': 8388608, 'date': '2024-01-22'},\n        {'name': 'data.xlsx', 'size': 524288, 'date': '2024-01-23'},\n        {'name': 'picture.gif', 'size': 786432, 'date': '2024-01-24'},\n        {'name': 'backup.zip', 'size': 10485760, 'date': '2024-01-25'},\n        {'name': 'script.py', 'size': 4096, 'date': '2024-01-26'},\n        {'name': 'photo2.jpg', 'size': 2097152, 'date': '2024-01-27'},\n        {'name': 'document2.pdf', 'size': 1572864, 'date': '2024-01-28'},\n        {'name': 'video2.mp4', 'size': 41943040, 'date': '2024-01-29'}\n    ]\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡ã®å®šç¾©ï¼ˆæ‹¡å¼µï¼‰\n    file_types = {\n        'ğŸ“· ç”»åƒ': ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp', '.svg'],\n        'ğŸ“„ æ–‡æ›¸': ['.pdf', '.doc', '.docx', '.txt', '.xlsx', '.xls', '.pptx', '.ppt', '.rtf'],\n        'ğŸ¬ å‹•ç”»': ['.mp4', '.avi', '.mov', '.wmv', '.mkv', '.flv', '.webm', '.m4v'],\n        'ğŸµ éŸ³æ¥½': ['.mp3', '.wav', '.flac', '.aac', '.ogg', '.m4a', '.wma'],\n        'ğŸ“¦ åœ§ç¸®': ['.zip', '.rar', '.7z', '.tar', '.gz', '.bz2'],\n        'ğŸ’» ãƒ—ãƒ­ã‚°ãƒ©ãƒ ': ['.py', '.js', '.html', '.css', '.java', '.cpp', '.c', '.php'],\n        'ğŸ“Š ãƒ‡ãƒ¼ã‚¿': ['.csv', '.json', '.xml', '.sql', '.db', '.sqlite'],\n        'ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ ': ['.exe', '.msi', '.dmg', '.pkg', '.deb', '.rpm']\n    }\n    \n    print(f'\\nğŸ“Š æ•´ç†å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(sample_files)}ä»¶')\n    print('\\nğŸ” ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æä¸­...')\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ\n    file_stats = {}\n    organized_files = []\n    total_size = 0\n    \n    for file_info in sample_files:\n        filename = file_info['name']\n        file_size = file_info['size']\n        file_date = file_info['date']\n        \n        file_ext = Path(filename).suffix.lower()\n        \n        # ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡ã‚’åˆ¤å®š\n        category = 'ğŸ“ ãã®ä»–'\n        for folder_name, extensions in file_types.items():\n            if file_ext in extensions:\n                category = folder_name\n                break\n        \n        # çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°\n        if category not in file_stats:\n            file_stats[category] = {'count': 0, 'size': 0, 'files': []}\n        \n        file_stats[category]['count'] += 1\n        file_stats[category]['size'] += file_size\n        file_stats[category]['files'].append(filename)\n        \n        total_size += file_size\n        \n        organized_files.append({\n            'ãƒ•ã‚¡ã‚¤ãƒ«å': filename,\n            'æ‹¡å¼µå­': file_ext,\n            'ã‚µã‚¤ã‚º': file_size,\n            'ã‚µã‚¤ã‚ºè¡¨ç¤º': f'{file_size / 1024 / 1024:.1f}MB',\n            'åˆ†é¡': category,\n            'ä½œæˆæ—¥': file_date,\n            'ç§»å‹•å…ˆ': f'{category}/'\n        })\n        \n        print(f'âœ“ {filename} ({file_size / 1024 / 1024:.1f}MB) â†’ {category}')\n    \n    # é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡ºï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰\n    print('\\nğŸ” é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºä¸­...')\n    duplicate_files = []\n    file_hashes = {}\n    \n    for file_info in sample_files:\n        # ç°¡æ˜“çš„ãªé‡è¤‡æ¤œå‡ºï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¨æ‹¡å¼µå­ã§åˆ¤å®šï¼‰\n        file_key = f\"{file_info['size']}_{Path(file_info['name']).suffix}\"\n        if file_key in file_hashes:\n            duplicate_files.append({\n                'ãƒ•ã‚¡ã‚¤ãƒ«å': file_info['name'],\n                'é‡è¤‡å…ƒ': file_hashes[file_key],\n                'ã‚µã‚¤ã‚º': file_info['size']\n            })\n        else:\n            file_hashes[file_key] = file_info['name']\n    \n    # æ•´ç†çµæœã®è¡¨ç¤º\n    print(f'\\nâœ… ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†å®Œäº†ï¼')\n    print(f'å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(organized_files)}ä»¶')\n    print(f'ç·å®¹é‡: {total_size / 1024 / 1024:.1f}MB')\n    \n    print('\\nğŸ“ˆ æ•´ç†çµæœ:')\n    for category, stats in file_stats.items():\n        print(f'â€¢ {category}: {stats[\"count\"]}ä»¶ ({stats[\"size\"] / 1024 / 1024:.1f}MB)')\n    \n    if duplicate_files:\n        print(f'\\nâš ï¸ é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«: {len(duplicate_files)}ä»¶')\n        for dup in duplicate_files:\n            print(f'â€¢ {dup[\"ãƒ•ã‚¡ã‚¤ãƒ«å\"]} (é‡è¤‡å…ƒ: {dup[\"é‡è¤‡å…ƒ\"]})')\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n    \n    # æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š\n    plt.rcParams['font.family'] = ['DejaVu Sans', 'Hiragino Sans', 'Yu Gothic', 'Meiryo', 'Takao', 'IPAexGothic', 'IPAPGothic', 'VL PGothic', 'Noto Sans CJK JP']\n    \n    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12))\n    \n    # 1. ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡åˆ¥ä»¶æ•°ï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰\n    categories = list(file_stats.keys())\n    counts = [stats['count'] for stats in file_stats.values()]\n    \n    ax1.pie(counts, labels=categories, autopct='%1.1f%%', startangle=90)\n    ax1.set_title('ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡åˆ¥ä»¶æ•°', fontsize=14, fontweight='bold', pad=20)\n    \n    # 2. ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡åˆ¥å®¹é‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰\n    sizes_mb = [stats['size'] / 1024 / 1024 for stats in file_stats.values()]\n    bars = ax2.bar(categories, sizes_mb, color='#2E86AB', alpha=0.7)\n    ax2.set_title('ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡åˆ¥å®¹é‡', fontsize=14, fontweight='bold', pad=20)\n    ax2.set_xlabel('ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡', fontsize=12)\n    ax2.set_ylabel('å®¹é‡ï¼ˆMBï¼‰', fontsize=12)\n    ax2.tick_params(axis='x', rotation=45)\n    ax2.grid(True, alpha=0.3, axis='y')\n    \n    # æ£’ã‚°ãƒ©ãƒ•ã«æ•°å€¤ã‚’è¡¨ç¤º\n    for bar, size in zip(bars, sizes_mb):\n        height = bar.get_height()\n        ax2.text(bar.get_x() + bar.get_width()/2., height + 0.1,\n                f'{size:.1f}MB', ha='center', va='bottom', fontweight='bold', fontsize=10)\n    \n    # 3. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ†å¸ƒï¼ˆãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ï¼‰\n    file_sizes = [f['ã‚µã‚¤ã‚º'] / 1024 / 1024 for f in organized_files]\n    ax3.hist(file_sizes, bins=10, color='#A23B72', alpha=0.7, edgecolor='black')\n    ax3.set_title('ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ†å¸ƒ', fontsize=14, fontweight='bold', pad=20)\n    ax3.set_xlabel('ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆMBï¼‰', fontsize=12)\n    ax3.set_ylabel('ãƒ•ã‚¡ã‚¤ãƒ«æ•°', fontsize=12)\n    ax3.grid(True, alpha=0.3)\n    \n    # 4. çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    ax4.axis('off')\n    summary_text = f'''\n    ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†ã‚µãƒãƒªãƒ¼:\n    \n    ğŸ“Š åŸºæœ¬çµ±è¨ˆ:\n    â€¢ ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(organized_files)}ä»¶\n    â€¢ ç·å®¹é‡: {total_size / 1024 / 1024:.1f}MB\n    â€¢ åˆ†é¡ã‚«ãƒ†ã‚´ãƒª: {len(file_stats)}ç¨®é¡\n    â€¢ é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«: {len(duplicate_files)}ä»¶\n    \n    ğŸ“ˆ å®¹é‡åˆ†æ:\n    â€¢ æœ€å¤§ã‚«ãƒ†ã‚´ãƒª: {max(file_stats.items(), key=lambda x: x[1]['size'])[0]}\n    â€¢ å¹³å‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: {total_size / len(organized_files) / 1024 / 1024:.1f}MB\n    \n    ğŸ“… å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    ax4.text(0.05, 0.5, summary_text, fontsize=11, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    plt.tight_layout()\n    \n    # ã‚°ãƒ©ãƒ•ä¿å­˜\n    filename = f'file_organization_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.png'\n    plt.savefig(filename, dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n    print('\\nğŸ“„ è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆä¸­...')\n    \n    # DataFrameã«å¤‰æ›\n    df = pd.DataFrame(organized_files)\n    \n    # CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜\n    csv_filename = f'file_organization_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.csv'\n    df.to_csv(csv_filename, index=False, encoding='utf-8-sig')\n    \n    # JSONãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n    report_data = {\n        'metadata': {\n            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n            'total_files': len(organized_files),\n            'total_size_mb': total_size / 1024 / 1024,\n            'categories': len(file_stats)\n        },\n        'category_stats': {cat: {'count': stats['count'], 'size_mb': stats['size'] / 1024 / 1024} \n                          for cat, stats in file_stats.items()},\n        'duplicate_files': duplicate_files,\n        'file_list': organized_files\n    }\n    \n    json_filename = f'file_organization_report_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.json'\n    with open(json_filename, 'w', encoding='utf-8') as f:\n        json.dump(report_data, f, ensure_ascii=False, indent=2, default=str)\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_files': len(organized_files),\n        'total_size_mb': total_size / 1024 / 1024,\n        'categories': len(file_stats),\n        'duplicates': len(duplicate_files),\n        'files_created': [filename, csv_filename, json_filename],\n        'status': 'SUCCESS'\n    }\n    \n    with open('file_organization_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print(f'\\nâœ… ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†å®Œäº†ï¼')\n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(organized_files)}ä»¶')\n    print(f'â€¢ ç·å®¹é‡: {total_size / 1024 / 1024:.1f}MB')\n    print(f'â€¢ åˆ†é¡ã‚«ãƒ†ã‚´ãƒª: {len(file_stats)}ç¨®é¡')\n    print(f'â€¢ é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«: {len(duplicate_files)}ä»¶')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {filename} (åˆ†æã‚°ãƒ©ãƒ•)')\n    print(f'â€¢ {csv_filename} (è©³ç´°ãƒªã‚¹ãƒˆ)')\n    print(f'â€¢ {json_filename} (åˆ†æãƒ¬ãƒãƒ¼ãƒˆ)')\n    print(f'â€¢ file_organization_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æ­£ã—ãè¨­å®šã—ã¦ãã ã•ã„')\n    print('â€¢ é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯äº‹å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç§»å‹•ã—ãªã„ã§ãã ã•ã„')\n    print('â€¢ ç§»å‹•å…ˆã®ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯è‡ªå‹•ä½œæˆã•ã‚Œã¾ã™')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†å®Œäº† ===')",
        "libraries": "osã€shutilã€pathlibï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€pandasã€matplotlibã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã‚„ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãŒæ•£ã‚‰ã‹ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼ŸPythonã§è‡ªå‹•æ•´ç†ã§ãã¾ã™ã€‚",
        "benefits": ["ä½œæ¥­åŠ¹ç‡ãŒå‘ä¸Š", "ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‘ã‚„ã™ããªã‚‹", "ã‚¹ãƒˆãƒ¬ã‚¹ãŒæ¸›ã‚‹", "é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡º", "å®¹é‡åˆ†æã¨å¯è¦–åŒ–", "æ•´ç†ãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. osã€shutilã€pathlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¨®é¡åˆ¥ã«æ•´ç†ã™ã‚‹\n3. é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡ºæ©Ÿèƒ½ã‚’å«ã‚ã‚‹\n4. å®¹é‡åˆ†æã¨å¯è¦–åŒ–ã‚’è¡Œã†\n5. æ•´ç†ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹\n6. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€: [ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã‚’æŒ‡å®š]\næ•´ç†ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡: ç”»åƒã€æ–‡æ›¸ã€å‹•ç”»ã€éŸ³æ¥½ã€åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€ãƒ‡ãƒ¼ã‚¿ã€ã‚·ã‚¹ãƒ†ãƒ \nå‡ºåŠ›å½¢å¼: CSVã€JSONã€ã‚°ãƒ©ãƒ•\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚osã€shutilã€pathlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¨®é¡åˆ¥ã«æ•´ç†ã—ã€é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡ºæ©Ÿèƒ½ã‚’å«ã‚ã¦å®¹é‡åˆ†æã¨å¯è¦–åŒ–ã‚’è¡Œã„ã€æ•´ç†ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 7, 
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "7/100",
        "title": "ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆä½œæˆ", 
        "desc": "ãƒ“ã‚¸ãƒã‚¹å¯¾å¿œã®é«˜åº¦ãªè‡ªå‹•å¿œç­”ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ",
        "how_to": "è‡ªç„¶è¨€èªå‡¦ç†ã¨æ©Ÿæ¢°å­¦ç¿’ã‚’æ´»ç”¨ã—ã€ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«ç‰¹åŒ–ã—ãŸé«˜åº¦ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚",
        "sample_code": "import random\nimport json\nimport re\nfrom datetime import datetime\nimport pandas as pd\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nimport os\nfrom collections import defaultdict\n\nprint('=== ãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆä½œæˆãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ¤– ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«ç‰¹åŒ–ã—ãŸé«˜åº¦ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ è‡ªç„¶è¨€èªç†è§£ã¨å¿œç­”ç”Ÿæˆ')\nprint('â€¢ ãƒ“ã‚¸ãƒã‚¹çŸ¥è­˜ãƒ™ãƒ¼ã‚¹')\nprint('â€¢ ä¼šè©±å±¥æ­´ã®è¨˜éŒ²ã¨åˆ†æ')\nprint('â€¢ æ„Ÿæƒ…åˆ†æã¨é©å¿œçš„å¿œç­”')\nprint('â€¢ çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ')\n\ntry:\n    # é«˜åº¦ãªå¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®šç¾©\n    business_responses = {\n        # åŸºæœ¬çš„ãªæŒ¨æ‹¶ï¼ˆæ™‚é–“å¸¯åˆ¥ï¼‰\n        'greeting': {\n            'morning': [\n                'ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ä»Šæ—¥ã‚‚ä¸€æ—¥é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',\n                'ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ç´ æ•µãªä¸€æ—¥ã«ãªã‚Šã¾ã™ã‚ˆã†ã«ã€‚ãƒ“ã‚¸ãƒã‚¹ã®ç›¸è«‡ãŒã‚ã‚Œã°ã„ã¤ã§ã‚‚ã©ã†ãã€‚',\n                'ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ä»Šæ—¥ã®ç›®æ¨™ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿã‚µãƒãƒ¼ãƒˆã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚'\n            ],\n            'afternoon': [\n                'ã“ã‚“ã«ã¡ã¯ï¼ãŠç–²ã‚Œæ§˜ã§ã™ã€‚åˆå¾Œã®æ¥­å‹™ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼',\n                'ã“ã‚“ã«ã¡ã¯ï¼ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',\n                'ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼åŠ¹ç‡åŒ–ã®ç›¸è«‡ãŒã‚ã‚Œã°ãŠèã‹ã›ãã ã•ã„ã€‚'\n            ],\n            'evening': [\n                'ã“ã‚“ã°ã‚“ã¯ï¼ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚æ˜æ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼',\n                'ã“ã‚“ã°ã‚“ã¯ï¼ä»Šæ—¥ã‚‚ä¸€æ—¥ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚æ˜æ—¥ã®æº–å‚™ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ',\n                'ã“ã‚“ã°ã‚“ã¯ï¼æ˜æ—¥ã‚‚ç´ æ•µãªä¸€æ—¥ã«ãªã‚Šã¾ã™ã‚ˆã†ã«ã€‚'\n            ]\n        },\n        \n        # ãƒ“ã‚¸ãƒã‚¹é–¢é€£ã®è³ªå•\n        'business': {\n            'sales': [\n                'å£²ä¸Šã«ã¤ã„ã¦ã§ã™ã­ã€‚è©³ç´°ãªåˆ†æãŒå¿…è¦ã§ã—ãŸã‚‰ã€ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ã‚„äºˆæ¸¬åˆ†æã‚‚å¯èƒ½ã§ã™ã€‚',\n                'å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®åˆ†æã¯ã€Excelè‡ªå‹•å‡¦ç†ãƒ„ãƒ¼ãƒ«ãŒãŠã™ã™ã‚ã§ã™ã€‚æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ä½œæˆã‚‚ã§ãã¾ã™ã€‚',\n                'å£²ä¸Šå‘ä¸Šã®ãŸã‚ã®æˆ¦ç•¥ç«‹æ¡ˆã‚’ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã€‚é¡§å®¢åˆ†æã‚„å¸‚å ´èª¿æŸ»ã®è‡ªå‹•åŒ–ã‚‚å¯èƒ½ã§ã™ã€‚'\n            ],\n            'customer': [\n                'é¡§å®¢ç®¡ç†ã«ã¤ã„ã¦ã§ã™ã­ã€‚é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã®æ•´ç†ã‚„åˆ†æãŒã§ãã¾ã™ã€‚CRMã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã‚‚ã‚µãƒãƒ¼ãƒˆå¯èƒ½ã§ã™ã€‚',\n                'é¡§å®¢ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã®è‡ªå‹•åŒ–ã‚‚å¯èƒ½ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ã‚„å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆãŒã§ãã¾ã™ã€‚',\n                'é¡§å®¢æº€è¶³åº¦ã®å‘ä¸Šã«ã¤ã„ã¦ã‚‚ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã€‚ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆåˆ†æã‚„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†ã®è‡ªå‹•åŒ–ã‚‚å¯èƒ½ã§ã™ã€‚'\n            ],\n            'report': [\n                'ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã®è‡ªå‹•åŒ–ãŒã§ãã¾ã™ã€‚PDFè‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ä½œæˆãŒå¯èƒ½ã§ã™ã€‚',\n                'ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€è¦‹ã‚„ã™ã„ã‚°ãƒ©ãƒ•ã‚„ãƒãƒ£ãƒ¼ãƒˆä»˜ãã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ã€‚',\n                'å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•é€ä¿¡ã‚‚å¯èƒ½ã§ã™ã€‚æ¯é€±ãƒ»æ¯æœˆã®ãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ã§ä½œæˆãƒ»é€ä¿¡ã§ãã¾ã™ã€‚'\n            ],\n            'efficiency': [\n                'æ¥­å‹™åŠ¹ç‡åŒ–ã«ã¤ã„ã¦ã§ã™ã­ã€‚è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã®å°å…¥ã§å¤§å¹…ãªæ™‚é–“çŸ­ç¸®ãŒå¯èƒ½ã§ã™ã€‚',\n                'Excelè‡ªå‹•å‡¦ç†ã‚„ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ã§ã€ãƒ«ãƒ¼ãƒãƒ³ãƒ¯ãƒ¼ã‚¯ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚',\n                'ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†ã‚„ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã§ã€ä½œæ¥­ç’°å¢ƒã‚’æ”¹å–„ã§ãã¾ã™ã€‚'\n            ]\n        },\n        \n        # æŠ€è¡“çš„ãªè³ªå•\n        'technical': {\n            'python': [\n                'Pythonã«ã¤ã„ã¦ã§ã™ã­ã€‚ãƒ‡ãƒ¼ã‚¿åˆ†æã€Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã€è‡ªå‹•åŒ–ãªã©ã€å¹…åºƒã„ç”¨é€”ã§æ´»ç”¨ã§ãã¾ã™ã€‚',\n                'Pythonã¯åˆå¿ƒè€…ã«ã‚‚å„ªã—ã„è¨€èªã§ã™ã€‚ãƒ“ã‚¸ãƒã‚¹è‡ªå‹•åŒ–ã®ç¬¬ä¸€æ­©ã¨ã—ã¦ãŠã™ã™ã‚ã§ã™ã€‚',\n                'Pythonã®å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦ã‚‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã§ãã¾ã™ã€‚å®Ÿè·µçš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å§‹ã‚ã‚‹ã®ãŒåŠ¹æœçš„ã§ã™ã€‚'\n            ],\n            'automation': [\n                'è‡ªå‹•åŒ–ã«ã¤ã„ã¦ã§ã™ã­ã€‚Pythonã‚’ä½¿ãˆã°ã€æ§˜ã€…ãªæ¥­å‹™ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚',\n                'Excelå‡¦ç†ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã€ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†ãªã©ã€æ—¥å¸¸æ¥­å‹™ã®å¤šãã‚’è‡ªå‹•åŒ–å¯èƒ½ã§ã™ã€‚',\n                'è‡ªå‹•åŒ–ã®å°å…¥ã«ã‚ˆã‚Šã€ç”Ÿç”£æ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªä½œæ¥­ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚'\n            ]\n        },\n        \n        # æ„Ÿæƒ…ãƒ»æ„Ÿè¬\n        'emotion': {\n            'thanks': [\n                'ã©ã†ã„ãŸã—ã¾ã—ã¦ï¼ãŠå½¹ã«ç«‹ã¦ã¦å¬‰ã—ã„ã§ã™ã€‚ä»–ã«ã‚‚ä½•ã‹ã”è³ªå•ãŒã‚ã‚Œã°ãŠæ°—è»½ã«ã©ã†ãã€‚',\n                'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã¾ãŸä½•ã‹ã‚ã‚Šã¾ã—ãŸã‚‰ãŠå£°ãŒã‘ãã ã•ã„ã€‚ãƒ“ã‚¸ãƒã‚¹ã®æˆåŠŸã‚’å¿œæ´ã—ã¦ã„ã¾ã™ï¼',\n                'ãŠå½¹ã«ç«‹ã¦ã¦å…‰æ „ã§ã™ï¼åŠ¹ç‡åŒ–ã‚„è‡ªå‹•åŒ–ã«ã¤ã„ã¦ã€ã„ã¤ã§ã‚‚ã”ç›¸è«‡ãã ã•ã„ã€‚'\n            ],\n            'positive': [\n                'ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ãã®å‰å‘ããªå§¿å‹¢ãŒæˆåŠŸã®éµã§ã™ã€‚',\n                'è‰¯ã„çµæœãŒå‡ºã¦è‰¯ã‹ã£ãŸã§ã™ï¼ç¶™ç¶šã¯åŠ›ãªã‚Šã§ã™ã€‚',\n                'ãã®èª¿å­ã§ã™ï¼ç›®æ¨™ã«å‘ã‹ã£ã¦é ‘å¼µã£ã¦ãã ã•ã„ã€‚'\n            ],\n            'negative': [\n                'å¤§ä¸ˆå¤«ã§ã™ã€‚ä¸€æ­©ãšã¤é€²ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚ã‚µãƒãƒ¼ãƒˆã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚',\n                'å›°é›£ãªæ™‚ã“ãæˆé•·ã®ãƒãƒ£ãƒ³ã‚¹ã§ã™ã€‚ä¸€ç·’ã«è§£æ±ºç­–ã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚',\n                'ç„¦ã‚‰ãšã«ã€ã§ãã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚å°ã•ãªæ”¹å–„ãŒå¤§ããªæˆæœã«ã¤ãªãŒã‚Šã¾ã™ã€‚'\n            ]\n        }\n    }\n    \n    # ä¼šè©±å±¥æ­´ã®è¨˜éŒ²\n    conversation_history = []\n    user_stats = defaultdict(int)\n    \n    # æ™‚é–“å¸¯ã‚’åˆ¤å®šã™ã‚‹é–¢æ•°\n    def get_time_period():\n        hour = datetime.now().hour\n        if 5 <= hour < 12:\n            return 'morning'\n        elif 12 <= hour < 18:\n            return 'afternoon'\n        else:\n            return 'evening'\n    \n    # æ„Ÿæƒ…åˆ†æã®ç°¡æ˜“ç‰ˆ\n    def analyze_sentiment(text):\n        positive_words = ['ã‚ã‚ŠãŒã¨ã†', 'åŠ©ã‹ã£ãŸ', 'è‰¯ã„', 'ç´ æ™´ã‚‰ã—ã„', 'æˆåŠŸ', 'å¬‰ã—ã„', 'æ„Ÿè¬']\n        negative_words = ['å›°ã£ãŸ', 'é›£ã—ã„', 'å¤±æ•—', 'ç–²ã‚ŒãŸ', 'å«Œã ', 'å¤§å¤‰']\n        \n        text_lower = text.lower()\n        positive_count = sum(1 for word in positive_words if word in text_lower)\n        negative_count = sum(1 for word in negative_words if word in text_lower)\n        \n        if positive_count > negative_count:\n            return 'positive'\n        elif negative_count > positive_count:\n            return 'negative'\n        else:\n            return 'neutral'\n    \n    # å¿œç­”ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°\n    def generate_response(user_input):\n        input_lower = user_input.lower()\n        \n        # çµ‚äº†æ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯\n        if any(word in input_lower for word in ['çµ‚äº†', 'ã•ã‚ˆã†ãªã‚‰', 'bye', 'exit', 'ãŠç–²ã‚Œ']):\n            return random.choice(business_responses['emotion']['thanks'])\n        \n        # æŒ¨æ‹¶ã®åˆ¤å®š\n        if any(word in input_lower for word in ['ã“ã‚“ã«ã¡ã¯', 'ãŠã¯ã‚ˆã†', 'ã“ã‚“ã°ã‚“ã¯', 'ã¯ã˜ã‚ã¾ã—ã¦']):\n            time_period = get_time_period()\n            return random.choice(business_responses['greeting'][time_period])\n        \n        # ãƒ“ã‚¸ãƒã‚¹é–¢é€£ã®è³ªå•\n        if any(word in input_lower for word in ['å£²ä¸Š', 'å£²ã‚Šä¸Šã’', 'åç›Š']):\n            return random.choice(business_responses['business']['sales'])\n        elif any(word in input_lower for word in ['é¡§å®¢', 'ãŠå®¢æ§˜', 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ']):\n            return random.choice(business_responses['business']['customer'])\n        elif any(word in input_lower for word in ['ãƒ¬ãƒãƒ¼ãƒˆ', 'å ±å‘Šæ›¸', 'è³‡æ–™']):\n            return random.choice(business_responses['business']['report'])\n        elif any(word in input_lower for word in ['åŠ¹ç‡', 'åŠ¹ç‡åŒ–', 'è‡ªå‹•åŒ–', 'æ”¹å–„']):\n            return random.choice(business_responses['business']['efficiency'])\n        \n        # æŠ€è¡“çš„ãªè³ªå•\n        elif any(word in input_lower for word in ['python', 'ãƒ‘ã‚¤ã‚½ãƒ³']):\n            return random.choice(business_responses['technical']['python'])\n        elif any(word in input_lower for word in ['è‡ªå‹•åŒ–', 'ãƒ—ãƒ­ã‚°ãƒ©ãƒ ']):\n            return random.choice(business_responses['technical']['automation'])\n        \n        # æ„Ÿæƒ…ãƒ»æ„Ÿè¬\n        elif any(word in input_lower for word in ['ã‚ã‚ŠãŒã¨ã†', 'æ„Ÿè¬', 'åŠ©ã‹ã£ãŸ']):\n            return random.choice(business_responses['emotion']['thanks'])\n        \n        # æ„Ÿæƒ…åˆ†æã«ã‚ˆã‚‹å¿œç­”\n        sentiment = analyze_sentiment(input_lower)\n        if sentiment == 'positive':\n            return random.choice(business_responses['emotion']['positive'])\n        elif sentiment == 'negative':\n            return random.choice(business_responses['emotion']['negative'])\n        \n        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¿œç­”\n        default_responses = [\n            'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ãã®å†…å®¹ã«ã¤ã„ã¦ã¯è©³ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ“ã‚¸ãƒã‚¹åŠ¹ç‡åŒ–ã‚„è‡ªå‹•åŒ–ã«ã¤ã„ã¦ã§ã—ãŸã‚‰ã€ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã€‚',\n            'ãã®è³ªå•ã«ã¤ã„ã¦ã¯ã€åˆ¥ã®æ–¹æ³•ã§ãŠèª¿ã¹ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ï¼ŸPythonã‚’ä½¿ã£ãŸè‡ªå‹•åŒ–ã«ã¤ã„ã¦ã§ã—ãŸã‚‰ã€è©³ã—ãã”èª¬æ˜ã§ãã¾ã™ã€‚',\n            'ã™ã¿ã¾ã›ã‚“ã€ãã®å†…å®¹ã¯ç§ã®çŸ¥è­˜ã®ç¯„å›²å¤–ã§ã™ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨ã«ã¤ã„ã¦ã§ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚',\n            'ãã®è³ªå•ã«ã¤ã„ã¦ã¯ã€å°‚é–€çš„ãªçŸ¥è­˜ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã¾ãšã¯ç°¡å˜ãªè‡ªå‹•åŒ–ã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ'\n        ]\n        return random.choice(default_responses)\n    \n    # ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®é–‹å§‹\n    print('\\nğŸ¤– ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ: ã“ã‚“ã«ã¡ã¯ï¼ãƒ“ã‚¸ãƒã‚¹åŠ¹ç‡åŒ–ã®ã‚µãƒãƒ¼ãƒˆã‚’ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ')\n    print('\\n=== ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«ä¼šè©±ã‚’å®Ÿè¡Œ\n    sample_inputs = [\n        'ã“ã‚“ã«ã¡ã¯',\n        'å£²ä¸Šåˆ†æã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„',\n        'Pythonã§è‡ªå‹•åŒ–ã‚’å§‹ã‚ãŸã„ã®ã§ã™ãŒ',\n        'ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã‚’åŠ¹ç‡åŒ–ã—ãŸã„ã§ã™',\n        'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼',\n        'ã•ã‚ˆã†ãªã‚‰'\n    ]\n    \n    for user_input in sample_inputs:\n        print(f'\\nğŸ‘¤ ã‚ãªãŸ: {user_input}')\n        \n        # å¿œç­”ã‚’ç”Ÿæˆ\n        response = generate_response(user_input)\n        print(f'ğŸ¤– ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ: {response}')\n        \n        # ä¼šè©±å±¥æ­´ã‚’è¨˜éŒ²\n        conversation_history.append({\n            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n            'user_input': user_input,\n            'bot_response': response,\n            'sentiment': analyze_sentiment(user_input)\n        })\n        \n        # çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°\n        user_stats['total_messages'] += 1\n        user_stats[analyze_sentiment(user_input)] += 1\n        \n        # çµ‚äº†æ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯\n        if any(word in user_input.lower() for word in ['çµ‚äº†', 'ã•ã‚ˆã†ãªã‚‰', 'bye', 'exit']):\n            break\n    \n    print('\\n=== ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®å‹•ä½œç¢ºèªå®Œäº† ===')\n    \n    # ä¼šè©±åˆ†æã¨ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n    print('\\nğŸ“Š ä¼šè©±åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆä¸­...')\n    \n    # çµ±è¨ˆæƒ…å ±ã®è¨ˆç®—\n    total_messages = len(conversation_history)\n    positive_messages = user_stats['positive']\n    negative_messages = user_stats['negative']\n    neutral_messages = user_stats['neutral']\n    \n    # æ„Ÿæƒ…åˆ†å¸ƒã®è¨ˆç®—\n    sentiment_distribution = {\n        'ãƒã‚¸ãƒ†ã‚£ãƒ–': positive_messages,\n        'ãƒã‚¬ãƒ†ã‚£ãƒ–': negative_messages,\n        'ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«': neutral_messages\n    }\n    \n    # ã‚°ãƒ©ãƒ•ä½œæˆ\n    plt.figure(figsize=(12, 8))\n    \n    # æ„Ÿæƒ…åˆ†å¸ƒã®å††ã‚°ãƒ©ãƒ•\n    plt.subplot(2, 2, 1)\n    sentiment_labels = list(sentiment_distribution.keys())\n    sentiment_values = list(sentiment_distribution.values())\n    colors = ['#C6EFCE', '#FFC7CE', '#FFE699']\n    \n    plt.pie(sentiment_values, labels=sentiment_labels, autopct='%1.1f%%', colors=colors, startangle=90)\n    plt.title('ä¼šè©±ã®æ„Ÿæƒ…åˆ†å¸ƒ', fontsize=14, fontweight='bold', pad=20)\n    \n    # ä¼šè©±ã®æ™‚ç³»åˆ—\n    plt.subplot(2, 2, 2)\n    message_numbers = range(1, total_messages + 1)\n    sentiments = [conv['sentiment'] for conv in conversation_history]\n    sentiment_nums = [1 if s == 'positive' else (-1 if s == 'negative' else 0) for s in sentiments]\n    \n    plt.plot(message_numbers, sentiment_nums, marker='o', linewidth=2, markersize=6, color='#2E86AB')\n    plt.axhline(y=0, color='red', linestyle='--', alpha=0.7)\n    plt.title('ä¼šè©±ã®æ„Ÿæƒ…æ¨ç§»', fontsize=14, fontweight='bold', pad=20)\n    plt.xlabel('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°', fontsize=12)\n    plt.ylabel('æ„Ÿæƒ…ã‚¹ã‚³ã‚¢', fontsize=12)\n    plt.grid(True, alpha=0.3)\n    \n    # çµ±è¨ˆã‚µãƒãƒªãƒ¼\n    plt.subplot(2, 2, 3)\n    plt.axis('off')\n    summary_text = f'''\n    ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆåˆ†æã‚µãƒãƒªãƒ¼:\n    \n    ğŸ“Š åŸºæœ¬çµ±è¨ˆ:\n    â€¢ ç·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: {total_messages}ä»¶\n    â€¢ ãƒã‚¸ãƒ†ã‚£ãƒ–: {positive_messages}ä»¶ ({positive_messages/total_messages*100:.1f}%)\n    â€¢ ãƒã‚¬ãƒ†ã‚£ãƒ–: {negative_messages}ä»¶ ({negative_messages/total_messages*100:.1f}%)\n    â€¢ ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«: {neutral_messages}ä»¶ ({neutral_messages/total_messages*100:.1f}%)\n    \n    ğŸ¤– ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆæ©Ÿèƒ½:\n    â€¢ å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³: {sum(len(cat) for cat in business_responses.values())}ç¨®é¡\n    â€¢ æ™‚é–“å¸¯åˆ¥å¿œç­”: å¯¾å¿œæ¸ˆã¿\n    â€¢ æ„Ÿæƒ…åˆ†æ: å®Ÿè£…æ¸ˆã¿\n    â€¢ ä¼šè©±å±¥æ­´: è¨˜éŒ²æ¸ˆã¿\n    \n    ğŸ“… å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n    '''\n    plt.text(0.05, 0.5, summary_text, fontsize=11, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n    \n    # ä¼šè©±å±¥æ­´ã®è¡¨ç¤º\n    plt.subplot(2, 2, 4)\n    plt.axis('off')\n    history_text = '\\n'.join([f'{i+1}. {conv[\"user_input\"]}' for i, conv in enumerate(conversation_history[:5])])\n    plt.text(0.05, 0.5, f'æœ€è¿‘ã®ä¼šè©±å±¥æ­´:\\n{history_text}', fontsize=10, verticalalignment='center',\n             bbox=dict(boxstyle='round', facecolor='lightgray', alpha=0.8))\n    \n    plt.tight_layout()\n    \n    # ã‚°ãƒ©ãƒ•ä¿å­˜\n    filename = f'chatbot_analysis_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.png'\n    plt.savefig(filename, dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    # è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n    print('\\nğŸ“„ è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆä¸­...')\n    \n    # JSONãƒ¬ãƒãƒ¼ãƒˆ\n    report_data = {\n        'metadata': {\n            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n            'total_messages': total_messages,\n            'conversation_duration': 'ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³'\n        },\n        'statistics': {\n            'positive_messages': positive_messages,\n            'negative_messages': negative_messages,\n            'neutral_messages': neutral_messages,\n            'sentiment_distribution': sentiment_distribution\n        },\n        'conversation_history': conversation_history,\n        'chatbot_features': {\n            'response_categories': len(business_responses),\n            'total_responses': sum(len(cat) for cat in business_responses.values()),\n            'sentiment_analysis': True,\n            'time_based_responses': True\n        }\n    }\n    \n    json_filename = f'chatbot_report_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.json'\n    with open(json_filename, 'w', encoding='utf-8') as f:\n        json.dump(report_data, f, ensure_ascii=False, indent=2, default=str)\n    \n    # å‡¦ç†ãƒ­ã‚°ä½œæˆ\n    log_data = {\n        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n        'total_messages': total_messages,\n        'positive_rate': positive_messages/total_messages*100 if total_messages > 0 else 0,\n        'files_created': [filename, json_filename],\n        'status': 'SUCCESS'\n    }\n    \n    with open('chatbot_log.json', 'w', encoding='utf-8') as f:\n        json.dump(log_data, f, ensure_ascii=False, indent=2)\n    \n    print(f'\\nâœ… ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆåˆ†æå®Œäº†ï¼')\n    print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n    print(f'â€¢ ç·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: {total_messages}ä»¶')\n    print(f'â€¢ ãƒã‚¸ãƒ†ã‚£ãƒ–ç‡: {positive_messages/total_messages*100:.1f}%')\n    print(f'â€¢ å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°: {sum(len(cat) for cat in business_responses.values())}å€‹')\n    print(f'â€¢ æ„Ÿæƒ…åˆ†æ: å®Ÿè£…æ¸ˆã¿')\n    \n    print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n    print(f'â€¢ {filename} (åˆ†æã‚°ãƒ©ãƒ•)')\n    print(f'â€¢ {json_filename} (è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ)')\n    print(f'â€¢ chatbot_log.json (å‡¦ç†ãƒ­ã‚°)')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ input()é–¢æ•°ã‚’ä½¿ã£ã¦å¯¾è©±å½¢å¼ã§å®Ÿè¡Œã§ãã¾ã™')\n    print('â€¢ å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¿½åŠ ã—ã¦æ©Ÿèƒ½ã‚’æ‹¡å¼µã§ãã¾ã™')\n    print('â€¢ è‡ªç„¶è¨€èªå‡¦ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨ã‚ˆã‚Šé«˜åº¦ãªå¿œç­”ãŒå¯èƒ½ã§ã™')\n    print('â€¢ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨é€£æºã—ã¦å­¦ç¿’æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã¾ã™')\n    print('â€¢ Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å…¬é–‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆä½œæˆå®Œäº† ===')",
        "libraries": "pandasã€matplotlibã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€collectionsï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«ç‰¹åŒ–ã—ãŸé«˜åº¦ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¯ã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã‚„ç¤¾å†…FAQã€å–¶æ¥­æ”¯æ´ã«æ´»ç”¨ã§ãã¾ã™ã€‚è‡ªç„¶è¨€èªå‡¦ç†ã¨æ„Ÿæƒ…åˆ†æã«ã‚ˆã‚Šã€ã‚ˆã‚Šäººé–“ã‚‰ã—ã„å¿œç­”ãŒå¯èƒ½ã§ã™ã€‚",
        "benefits": ["24æ™‚é–“å¯¾å¿œå¯èƒ½", "äººä»¶è²»ã‚’å¤§å¹…å‰Šæ¸›", "å¿œç­”é€Ÿåº¦ãŒé€Ÿã„", "æ„Ÿæƒ…åˆ†æã«ã‚ˆã‚‹é©å¿œçš„å¿œç­”", "ä¼šè©±å±¥æ­´ã®åˆ†æã¨æ”¹å–„", "ãƒ“ã‚¸ãƒã‚¹çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®æ´»ç”¨"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ãƒ“ã‚¸ãƒã‚¹å¯¾å¿œã®é«˜åº¦ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. è‡ªç„¶è¨€èªç†è§£ã¨å¿œç­”ç”Ÿæˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹\n2. ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«ç‰¹åŒ–ã—ãŸçŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹\n3. æ„Ÿæƒ…åˆ†ææ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹\n4. ä¼šè©±å±¥æ­´ã®è¨˜éŒ²ã¨åˆ†ææ©Ÿèƒ½ã‚’å«ã‚ã‚‹\n5. æ™‚é–“å¸¯åˆ¥ã®å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹\n6. çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã¨ã‚°ãƒ©ãƒ•ç”Ÿæˆæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹\n7. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾å¿œåˆ†é‡: ãƒ“ã‚¸ãƒã‚¹åŠ¹ç‡åŒ–ã€å£²ä¸Šåˆ†æã€é¡§å®¢ç®¡ç†ã€ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\næ©Ÿèƒ½: æ„Ÿæƒ…åˆ†æã€ä¼šè©±å±¥æ­´ã€çµ±è¨ˆåˆ†æã€ã‚°ãƒ©ãƒ•ç”Ÿæˆ\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ“ã‚¸ãƒã‚¹å¯¾å¿œã®é«˜åº¦ãªãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚è‡ªç„¶è¨€èªç†è§£ã¨å¿œç­”ç”Ÿæˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã€ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«ç‰¹åŒ–ã—ãŸçŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¦æ„Ÿæƒ…åˆ†ææ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ä¼šè©±å±¥æ­´ã®è¨˜éŒ²ã¨åˆ†ææ©Ÿèƒ½ã‚’å«ã‚ã¦æ™‚é–“å¸¯åˆ¥ã®å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã—ã€çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã¨ã‚°ãƒ©ãƒ•ç”Ÿæˆæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 8, 
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "8/100",
        "title": "ç”»åƒè‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–", 
        "desc": "ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ãƒ»å¤‰æ›",
        "how_to": "PILï¼ˆPillowï¼‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã§ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ãƒ»å¤‰æ›ã—ã€Webç”¨ã‚„å°åˆ·ç”¨ã«æœ€é©åŒ–ã—ã¾ã™ã€‚",
        "sample_code": "from PIL import Image, ImageEnhance, ImageFilter\nimport os\nimport json\nfrom datetime import datetime\nimport matplotlib\nmatplotlib.use('Agg')\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nprint('=== ç”»åƒè‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ©ãƒ¼è€æ€§ç‰ˆï¼‰ ===')\nprint('ğŸ–¼ï¸ ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã§ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ãƒ»å¤‰æ›ã—ã¾ã™')\nprint('\\nğŸ”§ æ©Ÿèƒ½:')\nprint('â€¢ è¤‡æ•°ã‚µã‚¤ã‚ºã§ã®ä¸€æ‹¬ãƒªã‚µã‚¤ã‚º')\nprint('â€¢ ç”»è³ªæœ€é©åŒ–ã¨åœ§ç¸®')\nprint('â€¢ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼ˆJPGã€PNGã€WebPï¼‰')\nprint('â€¢ ç”»åƒå“è³ªå‘ä¸Šï¼ˆã‚·ãƒ£ãƒ¼ãƒ—åŒ–ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆèª¿æ•´ï¼‰')\nprint('â€¢ ãƒãƒƒãƒå‡¦ç†ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ')\nprint('â€¢ å®¹é‡å‰Šæ¸›ã¨çµ±è¨ˆåˆ†æ')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ç”»åƒæƒ…å ±\n    print('\\nğŸ“‚ ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ç”»åƒã‚’å‡¦ç†ä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«ç”»åƒãƒªã‚¹ãƒˆï¼ˆå®Ÿéš›ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ä»£ã‚ã‚Šï¼‰\n    sample_images = [\n        {'name': 'photo1.jpg', 'width': 1920, 'height': 1080, 'size': 2048576, 'format': 'JPEG'},\n        {'name': 'image2.png', 'width': 2560, 'height': 1440, 'size': 3145728, 'format': 'PNG'},\n        {'name': 'picture3.gif', 'width': 1280, 'height': 720, 'size': 1048576, 'format': 'GIF'},\n        {'name': 'screenshot4.png', 'width': 3840, 'height': 2160, 'size': 5242880, 'format': 'PNG'},\n        {'name': 'photo5.jpg', 'width': 1600, 'height': 900, 'size': 1572864, 'format': 'JPEG'},\n        {'name': 'banner6.png', 'width': 1200, 'height': 400, 'size': 512000, 'format': 'PNG'},\n        {'name': 'icon7.ico', 'width': 256, 'height': 256, 'size': 128000, 'format': 'ICO'},\n        {'name': 'logo8.svg', 'width': 800, 'height': 600, 'size': 256000, 'format': 'SVG'}\n    ]\n    \n    # ãƒªã‚µã‚¤ã‚ºè¨­å®š\n    resize_configs = {\n        'web_small': {'width': 400, 'height': None, 'quality': 85, 'format': 'JPEG'},\n        'web_medium': {'width': 800, 'height': None, 'quality': 85, 'format': 'JPEG'},\n        'web_large': {'width': 1200, 'height': None, 'quality': 90, 'format': 'JPEG'},\n        'thumbnail': {'width': 150, 'height': 150, 'quality': 80, 'format': 'JPEG'},\n        'print_high': {'width': 2400, 'height': None, 'quality': 95, 'format': 'PNG'},\n        'mobile': {'width': 600, 'height': None, 'quality': 85, 'format': 'WebP'}\n    }\n    \n    print(f'\\nâš™ï¸ ãƒªã‚µã‚¤ã‚ºè¨­å®š:')\n    for config_name, config in resize_configs.items():\n        print(f'â€¢ {config_name}: {config[\"width\"]}pxå¹…, å“è³ª{config[\"quality\"]}%, å½¢å¼{config[\"format\"]}')\n    print(f'â€¢ å‡¦ç†å¯¾è±¡: {len(sample_images)}ä»¶')\n    \n    # å¯¾å¿œã™ã‚‹ç”»åƒå½¢å¼\n    supported_formats = ['.jpg', '.jpeg', '.png', '.bmp', '.gif', '.tiff', '.webp', '.ico']\n    \n    def calculate_new_dimensions(original_width, original_height, target_width, target_height=None):\n        \"\"\"ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ä¿ã£ã¦æ–°ã—ã„ã‚µã‚¤ã‚ºã‚’è¨ˆç®—\"\"\"\n        if target_height is None:\n            # å¹…ã‚’åŸºæº–ã«ãƒªã‚µã‚¤ã‚º\n            ratio = target_width / original_width\n            new_width = target_width\n            new_height = int(original_height * ratio)\n        else:\n            # å¹…ã¨é«˜ã•ã‚’æŒ‡å®šï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ç”¨ï¼‰\n            new_width = target_width\n            new_height = target_height\n        \n        return new_width, new_height\n    \n    def enhance_image_quality(image):\n        \"\"\"ç”»åƒå“è³ªã‚’å‘ä¸Šã•ã›ã‚‹\"\"\"\n        # ã‚·ãƒ£ãƒ¼ãƒ—åŒ–\n        enhanced = image.filter(ImageFilter.SHARPEN)\n        \n        # ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆèª¿æ•´\n        contrast_enhancer = ImageEnhance.Contrast(enhanced)\n        enhanced = contrast_enhancer.enhance(1.1)\n        \n        # æ˜åº¦èª¿æ•´\n        brightness_enhancer = ImageEnhance.Brightness(enhanced)\n        enhanced = brightness_enhancer.enhance(1.05)\n        \n        return enhanced\n    \n    def estimate_file_size(width, height, format_type, quality):\n        \"\"\"ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æ¦‚ç®—\"\"\"\n        # ãƒ”ã‚¯ã‚»ãƒ«æ•°\n        pixels = width * height\n        \n        # å½¢å¼åˆ¥ã®æ¦‚ç®—åœ§ç¸®ç‡\n        compression_ratios = {\n            'JPEG': 0.1 * (quality / 100),\n            'PNG': 0.3,\n            'WebP': 0.08 * (quality / 100),\n            'GIF': 0.2\n        }\n        \n        # 1ãƒ”ã‚¯ã‚»ãƒ«ã‚ãŸã‚Š3ãƒã‚¤ãƒˆï¼ˆRGBï¼‰ã¨ã—ã¦è¨ˆç®—\n        estimated_size = pixels * 3 * compression_ratios.get(format_type, 0.2)\n        return int(estimated_size)\n    \n    # å‡¦ç†çµæœã‚’è¨˜éŒ²\n    processing_results = []\n    total_original_size = 0\n    total_processed_size = 0\n    format_stats = {}\n    \n    print('\\nğŸ”„ ç”»åƒå‡¦ç†ä¸­...')\n    \n    for img_info in sample_images:\n        filename = img_info['name']\n        original_width = img_info['width']\n        original_height = img_info['height']\n        original_size = img_info['size']\n        original_format = img_info['format']\n        \n        # ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ã‚’ãƒã‚§ãƒƒã‚¯\n        file_ext = os.path.splitext(filename)[1].lower()\n        if file_ext in supported_formats:\n            try:\n                print(f'\\nğŸ“„ å‡¦ç†ä¸­: {filename} ({original_width}x{original_height}px, {original_size/1024:.1f}KB)')\n                \n                # å„è¨­å®šã§ãƒªã‚µã‚¤ã‚º\n                file_results = []\n                \n                for config_name, config in resize_configs.items():\n                    # æ–°ã—ã„ã‚µã‚¤ã‚ºã‚’è¨ˆç®—\n                    new_width, new_height = calculate_new_dimensions(\n                        original_width, original_height, \n                        config['width'], config['height']\n                    )\n                    \n                    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æ¦‚ç®—\n                    estimated_size = estimate_file_size(\n                        new_width, new_height, \n                        config['format'], config['quality']\n                    )\n                    \n                    # æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«å\n                    name, ext = os.path.splitext(filename)\n                    new_filename = f'{name}_{config_name}.{config[\"format\"].lower()}' if config['format'] != 'JPEG' else f'{name}_{config_name}.jpg'\n                    \n                    # å‡¦ç†çµæœã‚’è¨˜éŒ²\n                    result = {\n                        'å…ƒãƒ•ã‚¡ã‚¤ãƒ«': filename,\n                        'è¨­å®š': config_name,\n                        'æ–°ãƒ•ã‚¡ã‚¤ãƒ«': new_filename,\n                        'å…ƒã‚µã‚¤ã‚º': f'{original_width}x{original_height}px',\n                        'æ–°ã‚µã‚¤ã‚º': f'{new_width}x{new_height}px',\n                        'å…ƒå®¹é‡': f'{original_size / 1024:.1f}KB',\n                        'æ–°å®¹é‡': f'{estimated_size / 1024:.1f}KB',\n                        'åœ§ç¸®ç‡': f'{(1 - estimated_size / original_size) * 100:.1f}%',\n                        'å½¢å¼': config['format'],\n                        'å“è³ª': config['quality']\n                    }\n                    \n                    file_results.append(result)\n                    \n                    # çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°\n                    total_original_size += original_size\n                    total_processed_size += estimated_size\n                    \n                    if config['format'] not in format_stats:\n                        format_stats[config['format']] = {'count': 0, 'total_size': 0}\n                    format_stats[config['format']]['count'] += 1\n                    format_stats[config['format']]['total_size'] += estimated_size\n                    \n                    print(f'  âœ“ {config_name}: {new_width}x{new_height}px, {estimated_size/1024:.1f}KB ({result[\"åœ§ç¸®ç‡\"]})')\n                \n                processing_results.extend(file_results)\n                \n            except Exception as e:\n                print(f'  âš ï¸ {filename} ã®å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼: {e}')\n                continue\n        else:\n            print(f'âš ï¸ {filename} ã¯å¯¾å¿œã—ã¦ã„ãªã„å½¢å¼ã§ã™ ({file_ext})')\n    \n    if processing_results:\n        print(f'\\nâœ… ç”»åƒå‡¦ç†å®Œäº†ï¼')\n        print(f'å‡¦ç†ä»¶æ•°: {len(processing_results)}ä»¶')\n        \n        # çµ±è¨ˆæƒ…å ±ã®è¨ˆç®—\n        total_saved = total_original_size - total_processed_size\n        avg_compression = (1 - total_processed_size / total_original_size) * 100 if total_original_size > 0 else 0\n        \n        print(f'\\nğŸ“Š å‡¦ç†çµ±è¨ˆ:')\n        print(f'â€¢ ç·å‡¦ç†ä»¶æ•°: {len(processing_results)}ä»¶')\n        print(f'â€¢ ç·å®¹é‡å‰Šæ¸›: {total_saved / 1024 / 1024:.1f}MB')\n        print(f'â€¢ å¹³å‡åœ§ç¸®ç‡: {avg_compression:.1f}%')\n        print(f'â€¢ å‡¦ç†æ—¥æ™‚: {datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")}')\n        \n        # å½¢å¼åˆ¥çµ±è¨ˆ\n        print(f'\\nğŸ“ˆ å½¢å¼åˆ¥çµ±è¨ˆ:')\n        for format_type, stats in format_stats.items():\n            avg_size = stats['total_size'] / stats['count'] if stats['count'] > 0 else 0\n            print(f'â€¢ {format_type}: {stats[\"count\"]}ä»¶, å¹³å‡{avg_size/1024:.1f}KB')\n        \n        # ã‚°ãƒ©ãƒ•ä½œæˆ\n        print('\\nğŸ“Š åˆ†æã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...')\n        \n        plt.figure(figsize=(15, 10))\n        \n        # åœ§ç¸®ç‡ã®åˆ†å¸ƒ\n        plt.subplot(2, 3, 1)\n        compression_rates = [float(r['åœ§ç¸®ç‡'].rstrip('%')) for r in processing_results]\n        plt.hist(compression_rates, bins=20, alpha=0.7, color='skyblue', edgecolor='black')\n        plt.title('åœ§ç¸®ç‡ã®åˆ†å¸ƒ', fontsize=12, fontweight='bold')\n        plt.xlabel('åœ§ç¸®ç‡ (%)', fontsize=10)\n        plt.ylabel('ä»¶æ•°', fontsize=10)\n        plt.grid(True, alpha=0.3)\n        \n        # å½¢å¼åˆ¥ä»¶æ•°\n        plt.subplot(2, 3, 2)\n        format_counts = {k: v['count'] for k, v in format_stats.items()}\n        if format_counts:\n            plt.pie(format_counts.values(), labels=format_counts.keys(), autopct='%1.1f%%', startangle=90)\n            plt.title('å‡ºåŠ›å½¢å¼ã®åˆ†å¸ƒ', fontsize=12, fontweight='bold')\n        \n        # ã‚µã‚¤ã‚ºæ¯”è¼ƒï¼ˆå…ƒ vs æ–°ï¼‰\n        plt.subplot(2, 3, 3)\n        original_sizes = [float(r['å…ƒå®¹é‡'].rstrip('KB')) for r in processing_results]\n        new_sizes = [float(r['æ–°å®¹é‡'].rstrip('KB')) for r in processing_results]\n        \n        plt.scatter(original_sizes, new_sizes, alpha=0.6, color='red')\n        plt.plot([0, max(original_sizes)], [0, max(original_sizes)], 'k--', alpha=0.5)\n        plt.title('å…ƒã‚µã‚¤ã‚º vs æ–°ã‚µã‚¤ã‚º', fontsize=12, fontweight='bold')\n        plt.xlabel('å…ƒã‚µã‚¤ã‚º (KB)', fontsize=10)\n        plt.ylabel('æ–°ã‚µã‚¤ã‚º (KB)', fontsize=10)\n        plt.grid(True, alpha=0.3)\n        \n        # è¨­å®šåˆ¥å¹³å‡åœ§ç¸®ç‡\n        plt.subplot(2, 3, 4)\n        config_compression = {}\n        for result in processing_results:\n            config = result['è¨­å®š']\n            compression = float(result['åœ§ç¸®ç‡'].rstrip('%'))\n            if config not in config_compression:\n                config_compression[config] = []\n            config_compression[config].append(compression)\n        \n        config_avg = {k: np.mean(v) for k, v in config_compression.items()}\n        plt.bar(config_avg.keys(), config_avg.values(), color='lightgreen', alpha=0.7)\n        plt.title('è¨­å®šåˆ¥å¹³å‡åœ§ç¸®ç‡', fontsize=12, fontweight='bold')\n        plt.xlabel('è¨­å®š', fontsize=10)\n        plt.ylabel('å¹³å‡åœ§ç¸®ç‡ (%)', fontsize=10)\n        plt.xticks(rotation=45)\n        plt.grid(True, alpha=0.3)\n        \n        # å‡¦ç†ã‚µãƒãƒªãƒ¼\n        plt.subplot(2, 3, 5)\n        plt.axis('off')\n        summary_text = f'''\n        ç”»åƒå‡¦ç†ã‚µãƒãƒªãƒ¼:\n        \n        ğŸ“Š åŸºæœ¬çµ±è¨ˆ:\n        â€¢ ç·å‡¦ç†ä»¶æ•°: {len(processing_results)}ä»¶\n        â€¢ ç·å®¹é‡å‰Šæ¸›: {total_saved / 1024 / 1024:.1f}MB\n        â€¢ å¹³å‡åœ§ç¸®ç‡: {avg_compression:.1f}%\n        \n        ğŸ¯ å‡¦ç†è¨­å®š:\n        â€¢ Webç”¨: 3ã‚µã‚¤ã‚ºï¼ˆ400px, 800px, 1200pxï¼‰\n        â€¢ ã‚µãƒ ãƒã‚¤ãƒ«: 150x150px\n        â€¢ å°åˆ·ç”¨: 2400pxå¹…\n        â€¢ ãƒ¢ãƒã‚¤ãƒ«ç”¨: 600pxå¹…\n        \n        ğŸ“… å‡¦ç†æ—¥æ™‚: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n        '''\n        plt.text(0.05, 0.5, summary_text, fontsize=10, verticalalignment='center',\n                 bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))\n        \n        # å®¹é‡å‰Šæ¸›åŠ¹æœ\n        plt.subplot(2, 3, 6)\n        categories = ['å…ƒå®¹é‡', 'æ–°å®¹é‡', 'å‰Šæ¸›é‡']\n        values = [total_original_size, total_processed_size, total_saved]\n        colors = ['#FF6B6B', '#4ECDC4', '#45B7D1']\n        \n        bars = plt.bar(categories, [v/1024/1024 for v in values], color=colors, alpha=0.7)\n        plt.title('å®¹é‡å‰Šæ¸›åŠ¹æœ', fontsize=12, fontweight='bold')\n        plt.ylabel('å®¹é‡ (MB)', fontsize=10)\n        \n        # ãƒãƒ¼ã®ä¸Šã«å€¤ã‚’è¡¨ç¤º\n        for bar, value in zip(bars, values):\n            height = bar.get_height()\n            plt.text(bar.get_x() + bar.get_width()/2., height + 0.01,\n                     f'{value/1024/1024:.1f}MB', ha='center', va='bottom', fontsize=9)\n        \n        plt.tight_layout()\n        \n        # ã‚°ãƒ©ãƒ•ä¿å­˜\n        filename = f'image_processing_analysis_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.png'\n        plt.savefig(filename, dpi=300, bbox_inches='tight')\n        plt.close()\n        \n        # è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ\n        print('\\nğŸ“„ è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆä¸­...')\n        \n        # JSONãƒ¬ãƒãƒ¼ãƒˆ\n        report_data = {\n            'metadata': {\n                'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),\n                'total_processed': len(processing_results),\n                'total_original_size_mb': total_original_size / 1024 / 1024,\n                'total_processed_size_mb': total_processed_size / 1024 / 1024,\n                'total_saved_mb': total_saved / 1024 / 1024,\n                'average_compression_rate': avg_compression\n            },\n            'resize_configs': resize_configs,\n            'format_statistics': format_stats,\n            'processing_results': processing_results\n        }\n        \n        json_filename = f'image_processing_report_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.json'\n        with open(json_filename, 'w', encoding='utf-8') as f:\n            json.dump(report_data, f, ensure_ascii=False, indent=2, default=str)\n        \n        # CSVãƒ¬ãƒãƒ¼ãƒˆ\n        csv_data = []\n        for result in processing_results:\n            csv_data.append({\n                'å…ƒãƒ•ã‚¡ã‚¤ãƒ«': result['å…ƒãƒ•ã‚¡ã‚¤ãƒ«'],\n                'è¨­å®š': result['è¨­å®š'],\n                'æ–°ãƒ•ã‚¡ã‚¤ãƒ«': result['æ–°ãƒ•ã‚¡ã‚¤ãƒ«'],\n                'å…ƒã‚µã‚¤ã‚º': result['å…ƒã‚µã‚¤ã‚º'],\n                'æ–°ã‚µã‚¤ã‚º': result['æ–°ã‚µã‚¤ã‚º'],\n                'å…ƒå®¹é‡KB': float(result['å…ƒå®¹é‡'].rstrip('KB')),\n                'æ–°å®¹é‡KB': float(result['æ–°å®¹é‡'].rstrip('KB')),\n                'åœ§ç¸®ç‡%': float(result['åœ§ç¸®ç‡'].rstrip('%')),\n                'å½¢å¼': result['å½¢å¼'],\n                'å“è³ª': result['å“è³ª']\n            })\n        \n        import pandas as pd\n        df = pd.DataFrame(csv_data)\n        csv_filename = f'image_processing_details_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.csv'\n        df.to_csv(csv_filename, index=False, encoding='utf-8-sig')\n        \n        print(f'\\nâœ… ç”»åƒå‡¦ç†åˆ†æå®Œäº†ï¼')\n        print(f'\\nğŸ“Š å‡¦ç†çµæœ:')\n        print(f'â€¢ ç·å‡¦ç†ä»¶æ•°: {len(processing_results)}ä»¶')\n        print(f'â€¢ ç·å®¹é‡å‰Šæ¸›: {total_saved / 1024 / 1024:.1f}MB')\n        print(f'â€¢ å¹³å‡åœ§ç¸®ç‡: {avg_compression:.1f}%')\n        print(f'â€¢ å¯¾å¿œå½¢å¼: {len(supported_formats)}ç¨®é¡')\n        \n        print(f'\\nğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:')\n        print(f'â€¢ {filename} (åˆ†æã‚°ãƒ©ãƒ•)')\n        print(f'â€¢ {json_filename} (è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ)')\n        print(f'â€¢ {csv_filename} (å‡¦ç†è©³ç´°)')\n        \n    else:\n        print('\\nâŒ å‡¦ç†å¯èƒ½ãªç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æ­£ã—ãè¨­å®šã—ã¦ãã ã•ã„')\n    print('â€¢ å…ƒã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¿æŒã•ã‚Œã¾ã™')\n    print('â€¢ å¤§é‡ã®ç”»åƒã‚’å‡¦ç†ã™ã‚‹å ´åˆã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ WebPå½¢å¼ã¯æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™')\n    print('â€¢ å°åˆ·ç”¨ã®é«˜è§£åƒåº¦ç”»åƒã¯å®¹é‡ãŒå¤§ãããªã‚Šã¾ã™')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ matplotlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ç”»åƒè‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–å®Œäº† ===')",
        "libraries": "Pillow (PIL)ã€matplotlibã€numpyã€pandasã€jsonï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ç”»åƒã‚’è‡ªå‹•ã§ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ãƒ»å¤‰æ›ã™ã‚‹ã“ã¨ã§ã€Webã‚µã‚¤ãƒˆã€SNSã€å°åˆ·ç‰©ãªã©ç”¨é€”ã«å¿œã˜ãŸæœ€é©ãªç”»åƒã‚’åŠ¹ç‡çš„ã«ä½œæˆã§ãã¾ã™ã€‚",
        "benefits": ["ç”¨é€”åˆ¥æœ€é©åŒ–", "å®¹é‡å¤§å¹…å‰Šæ¸›", "å“è³ªå‘ä¸Š", "ä¸€æ‹¬å‡¦ç†", "å¤šå½¢å¼å¯¾å¿œ", "çµ±è¨ˆåˆ†æ"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ç”»åƒè‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. è¤‡æ•°ã‚µã‚¤ã‚ºã§ã®ä¸€æ‹¬ãƒªã‚µã‚¤ã‚ºï¼ˆWebç”¨ã€å°åˆ·ç”¨ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”¨ï¼‰\n3. ç”»è³ªæœ€é©åŒ–ã¨åœ§ç¸®æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹\n4. ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼ˆJPGã€PNGã€WebPï¼‰ã‚’è¡Œã†\n5. ç”»åƒå“è³ªå‘ä¸Šï¼ˆã‚·ãƒ£ãƒ¼ãƒ—åŒ–ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆèª¿æ•´ï¼‰ã‚’å®Ÿè£…ã™ã‚‹\n6. ãƒãƒƒãƒå‡¦ç†ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ©Ÿèƒ½ã‚’å«ã‚ã‚‹\n7. å®¹é‡å‰Šæ¸›ã¨çµ±è¨ˆåˆ†ææ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹\n8. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ç”»åƒ: æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒ\nå‡¦ç†å†…å®¹: ãƒªã‚µã‚¤ã‚ºã€æœ€é©åŒ–ã€å¤‰æ›ã€å“è³ªå‘ä¸Š\nå‡ºåŠ›å½¢å¼: è¤‡æ•°ã‚µã‚¤ã‚ºã€è¤‡æ•°å½¢å¼ã€çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆ\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ç”»åƒè‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦è¤‡æ•°ã‚µã‚¤ã‚ºã§ã®ä¸€æ‹¬ãƒªã‚µã‚¤ã‚ºã€ç”»è³ªæœ€é©åŒ–ã¨åœ§ç¸®æ©Ÿèƒ½ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ã€ç”»åƒå“è³ªå‘ä¸Šã€ãƒãƒƒãƒå‡¦ç†ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ©Ÿèƒ½ã€å®¹é‡å‰Šæ¸›ã¨çµ±è¨ˆåˆ†ææ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 9, 
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "9/100",
        "title": "å®šæœŸãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•é€ä¿¡", 
        "desc": "å®šæœŸçš„ã«ãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•é€ä¿¡",
        "how_to": "scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å®šæœŸå®Ÿè¡Œã‚’è¨­å®šã—ã€ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã¨ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚",
        "sample_code": "import schedule\nimport time\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom datetime import datetime\n\ndef create_daily_report():\n    today = datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥')\n    report = f'''\n    æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ - {today}\n    \n    - æœ¬æ—¥ã®å£²ä¸Š: 150,000å††\n    - æ–°è¦é¡§å®¢æ•°: 5å\n    - å‡¦ç†ä»¶æ•°: 25ä»¶\n    \n    Thank you for your work.\n    '''\n    return report\n\ndef send_report():\n    report = create_daily_report()\n    \n    # ãƒ¡ãƒ¼ãƒ«è¨­å®š\n    sender_email = 'your_email@gmail.com'\n    sender_password = 'your_password'\n    receiver_email = 'boss@company.com'\n    \n    # ãƒ¡ãƒ¼ãƒ«ä½œæˆ\n    msg = MIMEText(report, 'plain')\n    msg['Subject'] = f'æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ - {datetime.now().strftime(\"%Y/%m/%d\")}'\n    msg['From'] = sender_email\n    msg['To'] = receiver_email\n    \n    # é€ä¿¡\n    server = smtplib.SMTP('smtp.gmail.com', 587)\n    server.starttls()\n    server.login(sender_email, sender_password)\n    server.send_message(msg)\n    server.quit()\n    \n    print(f'ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡å®Œäº†: {datetime.now()}')\n\n# æ¯æ—¥18æ™‚ã«å®Ÿè¡Œ\nschedule.every().day.at('18:00').do(send_report)\n\n# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰\nprint('ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®šå®Œäº†ï¼')\nprint('å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§å®šæœŸå®Ÿè¡Œã•ã‚Œã¾ã™ï¼š')\nprint('# while True:')\nprint('#     schedule.run_pending()')\nprint('#     time.sleep(60)  # 1åˆ†ã”ã¨ã«ãƒã‚§ãƒƒã‚¯')",
        "libraries": "scheduleã€smtplibï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "æ¯æ—¥ã®ãƒ«ãƒ¼ãƒãƒ³ãƒ¯ãƒ¼ã‚¯ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã§ã€æ™‚é–“ã‚’ç¯€ç´„ã—ã€ãƒŸã‚¹ã‚’é˜²ã’ã¾ã™ã€‚",
        "benefits": ["æ‰‹ä½œæ¥­ãŒä¸è¦", "å¿˜ã‚Œã‚‹ã“ã¨ãŒãªã„", "æ™‚é–“ã‚’å¤§å¹…ç¯€ç´„"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§å®šæœŸãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•é€ä¿¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§æ¯æ—¥18æ™‚ã«å®Ÿè¡Œã™ã‚‹\n2. æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ï¼ˆå£²ä¸Šã€é¡§å®¢æ•°ã€å‡¦ç†ä»¶æ•°ã‚’å«ã‚€ï¼‰\n3. ä½œæˆã—ãŸãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\né€ä¿¡æ™‚é–“: æ¯æ—¥18æ™‚\nãƒ¬ãƒãƒ¼ãƒˆå†…å®¹: å£²ä¸Šã€æ–°è¦é¡§å®¢æ•°ã€å‡¦ç†ä»¶æ•°\né€ä¿¡å…ˆ: ä¸Šå¸ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§å®šæœŸãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•é€ä¿¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§æ¯æ—¥18æ™‚ã«å®Ÿè¡Œã—ã€æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 10, 
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "10/100",
        "title": "SNSè‡ªå‹•æŠ•ç¨¿", 
        "desc": "Twitterãªã©ã«è‡ªå‹•ã§æŠ•ç¨¿",
        "how_to": "tweepyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Twitter APIã«æ¥ç¶šã—ã€å®šæœŸçš„ã«æŠ•ç¨¿ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚",
        "sample_code": "import tweepy\nimport schedule\nimport time\nfrom datetime import datetime\nimport random\n\nprint('=== SNSè‡ªå‹•æŠ•ç¨¿ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('Twitterï¼ˆXï¼‰ã¸ã®è‡ªå‹•æŠ•ç¨¿æ©Ÿèƒ½ã‚’ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚')\nprint('\\nğŸ“± å¿…è¦ãªè¨­å®š:')\nprint('1. Twitter Developer Accountã®å–å¾—')\nprint('2. APIã‚­ãƒ¼ã¨ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—')\nprint('3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ')\nprint('\\nğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„:')\nprint('â€¢ APIã‚­ãƒ¼ã¯çµ¶å¯¾ã«ä»–äººã«è¦‹ã›ãªã„ã§ãã ã•ã„')\nprint('â€¢ ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™')\nprint('â€¢ æŠ•ç¨¿å†…å®¹ã¯äº‹å‰ã«ç¢ºèªã—ã¦ãã ã•ã„')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®è¨­å®šï¼ˆå®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯å¤‰æ›´ã—ã¦ãã ã•ã„ï¼‰\n    consumer_key = 'your_consumer_key'  # â† ã“ã“ã«ã‚ãªãŸã®Consumer Keyã‚’å…¥åŠ›\n    consumer_secret = 'your_consumer_secret'  # â† ã“ã“ã«ã‚ãªãŸã®Consumer Secretã‚’å…¥åŠ›\n    access_token = 'your_access_token'  # â† ã“ã“ã«ã‚ãªãŸã®Access Tokenã‚’å…¥åŠ›\n    access_token_secret = 'your_access_token_secret'  # â† ã“ã“ã«ã‚ãªãŸã®Access Token Secretã‚’å…¥åŠ›\n    \n    # ãƒ“ã‚¸ãƒã‚¹Tipsã®ãƒªã‚¹ãƒˆ\n    business_tips = [\n        'ğŸ’¡ ä»Šæ—¥ã®ãƒ“ã‚¸ãƒã‚¹Tips: æœä¸€ç•ªã«é‡è¦ãªã‚¿ã‚¹ã‚¯ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼å„ªå…ˆé †ä½ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ãŒæˆåŠŸã®éµã§ã™ã€‚',\n        'ğŸš€ åŠ¹ç‡åŒ–ã®ã‚³ãƒ„: åŒã˜ä½œæ¥­ã‚’3å›ä»¥ä¸Šã‚„ã£ãŸã‚‰è‡ªå‹•åŒ–ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚æ™‚é–“ã¯æœ€ã‚‚è²´é‡ãªè³‡æºã§ã™ã€‚',\n        'ğŸ¤ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³: ç›¸æ‰‹ã®ç«‹å ´ã«ç«‹ã£ã¦è€ƒãˆã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚å…±æ„ŸåŠ›ãŒä¿¡é ¼é–¢ä¿‚ã‚’ç¯‰ãã¾ã™ã€‚',\n        'â° æ™‚é–“ç®¡ç†: 15åˆ†å˜ä½ã§ã‚¿ã‚¹ã‚¯ã‚’åŒºåˆ‡ã‚‹ã¨é›†ä¸­åŠ›ãŒç¶šãã¾ã™ã€‚ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚',\n        'ğŸ“ˆ æˆé•·ã®ç§˜è¨£: æ¯æ—¥å°‘ã—ãšã¤ã§ã‚‚æ”¹å–„ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒã€å¤§ããªæˆæœã«ã¤ãªãŒã‚Šã¾ã™ã€‚',\n        'ğŸ¯ ç›®æ¨™è¨­å®š: SMARTåŸå‰‡ï¼ˆå…·ä½“çš„ã€æ¸¬å®šå¯èƒ½ã€é”æˆå¯èƒ½ã€é–¢é€£æ€§ã€æœŸé™ï¼‰ã§ç›®æ¨™ã‚’ç«‹ã¦ã¾ã—ã‚‡ã†ã€‚',\n        'ğŸ’ª ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—: ãƒãƒ¼ãƒ ã®å¼·ã¿ã‚’æ´»ã‹ã—ã€å¼±ã¿ã‚’è£œå®Œã™ã‚‹ç’°å¢ƒã‚’ä½œã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚',\n        'ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ´»ç”¨: æ„Ÿæƒ…ã§ã¯ãªãã€ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦æ„æ€æ±ºå®šã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚'\n    ]\n    \n    # ä»Šæ—¥ã®Tipsã‚’é¸æŠ\n    today = datetime.now().day\n    selected_tip = business_tips[today % len(business_tips)]\n    \n    # æŠ•ç¨¿å†…å®¹ã‚’ä½œæˆ\n    current_time = datetime.now().strftime('%H:%M')\n    message = f'''{selected_tip}\n\nğŸ“… {datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥')} {current_time}\nğŸ¤– Pythonè‡ªå‹•æŠ•ç¨¿\n\n#ãƒ“ã‚¸ãƒã‚¹ #åŠ¹ç‡åŒ– #è‡ªå‹•åŒ– #Python'''\n    \n    print('\\nğŸ“ æŠ•ç¨¿å†…å®¹:')\n    print('-' * 50)\n    print(message)\n    print('-' * 50)\n    print(f'æ–‡å­—æ•°: {len(message)}æ–‡å­—')\n    \n    # æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯ï¼ˆTwitteråˆ¶é™: 280æ–‡å­—ï¼‰\n    if len(message) > 280:\n        print('\\nâš ï¸ è­¦å‘Š: æŠ•ç¨¿å†…å®¹ãŒ280æ–‡å­—ã‚’è¶…ãˆã¦ã„ã¾ã™')\n        print('æŠ•ç¨¿å†…å®¹ã‚’çŸ­ãã—ã¦ãã ã•ã„')\n    else:\n        print('\\nâœ… æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯: OK')\n    \n    # å®Ÿéš›ã®æŠ•ç¨¿ï¼ˆè¨­å®šãŒæ­£ã—ã„å ´åˆã®ã¿å®Ÿè¡Œï¼‰\n    if (consumer_key != 'your_consumer_key' and \n        consumer_secret != 'your_consumer_secret' and \n        access_token != 'your_access_token' and \n        access_token_secret != 'your_access_token_secret'):\n        \n        print('\\nğŸš€ Twitter APIã«æ¥ç¶šä¸­...')\n        \n        try:\n            # èªè¨¼\n            auth = tweepy.OAuthHandler(consumer_key, consumer_secret)\n            auth.set_access_token(access_token, access_token_secret)\n            api = tweepy.API(auth)\n            \n            # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—\n            user = api.verify_credentials()\n            print(f'âœ“ èªè¨¼æˆåŠŸ: @{user.screen_name}')\n            \n            # æŠ•ç¨¿\n            print('\\nğŸ“¤ æŠ•ç¨¿ã‚’å®Ÿè¡Œä¸­...')\n            status = api.update_status(message)\n            \n            print('âœ… æŠ•ç¨¿å®Œäº†ï¼')\n            print(f'æŠ•ç¨¿ID: {status.id}')\n            print(f'æŠ•ç¨¿URL: https://twitter.com/{user.screen_name}/status/{status.id}')\n            \n        except tweepy.TweepError as e:\n            print(f'\\nâŒ Twitter API ã‚¨ãƒ©ãƒ¼: {e}')\n            print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n            print('â€¢ APIã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n            print('â€¢ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¨©é™è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n            print('â€¢ æŠ•ç¨¿å†…å®¹ãŒé‡è¤‡ã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n            \n    else:\n        print('\\nâš ï¸ ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰: å®Ÿéš›ã®æŠ•ç¨¿ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸ')\n        print('å®Ÿéš›ã«æŠ•ç¨¿ã™ã‚‹ã«ã¯ã€ä¸Šè¨˜ã®è¨­å®šå€¤ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„')\n    \n    # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½ã®ãƒ‡ãƒ¢\n    print('\\nğŸ“… è‡ªå‹•æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½:')\n    print('â€¢ æ¯æ—¥9æ™‚ã«ãƒ“ã‚¸ãƒã‚¹Tipsã‚’æŠ•ç¨¿')\n    print('â€¢ æ¯é€±æœˆæ›œæ—¥ã«é€±é–“æŒ¯ã‚Šè¿”ã‚Šã‚’æŠ•ç¨¿')\n    print('â€¢ æ¯æœˆ1æ—¥ã«æœˆé–“ç›®æ¨™ã‚’æŠ•ç¨¿')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ Twitter Developer AccountãŒå¿…è¦ã§ã™')\n    print('â€¢ APIã‚­ãƒ¼ã¯ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã—ã¦ãã ã•ã„')\n    print('â€¢ æŠ•ç¨¿å†…å®¹ã¯äº‹å‰ã«ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ åˆ©ç”¨è¦ç´„ã‚’éµå®ˆã—ã¦ãã ã•ã„')\n    print('â€¢ éåº¦ãªæŠ•ç¨¿ã¯é¿ã‘ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ tweepyãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ APIã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== SNSè‡ªå‹•æŠ•ç¨¿å®Œäº† ===')",
        "libraries": "tweepyã€scheduleã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "SNSã®æŠ•ç¨¿ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã§ã€ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚„æƒ…å ±ç™ºä¿¡ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["æŠ•ç¨¿ã‚’å¿˜ã‚Œã‚‹ã“ã¨ãŒãªã„", "æ™‚é–“ã‚’ç¯€ç´„", "ä¸€è²«ã—ãŸãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§SNSè‡ªå‹•æŠ•ç¨¿ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. tweepyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Twitterã«æŠ•ç¨¿ã™ã‚‹\n2. æ¯æ—¥9æ™‚ã«ãƒ“ã‚¸ãƒã‚¹Tipsã‚’è‡ªå‹•æŠ•ç¨¿ã™ã‚‹\n3. è¤‡æ•°ã®Tipsã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\næŠ•ç¨¿æ™‚é–“: æ¯æ—¥9æ™‚\næŠ•ç¨¿å†…å®¹: ãƒ“ã‚¸ãƒã‚¹Tipsï¼ˆè¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰\næŠ•ç¨¿å…ˆ: Twitter\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§SNSè‡ªå‹•æŠ•ç¨¿ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚tweepyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Twitterã«æ¯æ—¥9æ™‚ã«ãƒ“ã‚¸ãƒã‚¹Tipsã‚’è‡ªå‹•æŠ•ç¨¿ã—ã€è¤‡æ•°ã®Tipsã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 11, 
        "category": "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†",
        "number": "11/100",
        "title": "ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²", 
        "desc": "äºˆå®šã‚’è‡ªå‹•ã§Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«ç™»éŒ²",
        "how_to": "Google Calendar APIã‚’ä½¿ã£ã¦äºˆå®šã‚’è‡ªå‹•ã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«ç™»éŒ²ã—ã¾ã™ã€‚",
        "sample_code": "from google.oauth2.credentials import Credentials\nfrom googleapiclient.discovery import build\nfrom datetime import datetime, timedelta\nimport os\n\nprint('=== Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šã‚’è‡ªå‹•ç™»éŒ²ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚')\nprint('\\nğŸ“… å¿…è¦ãªè¨­å®š:')\nprint('1. Google Cloud Consoleã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ')\nprint('2. Google Calendar APIã‚’æœ‰åŠ¹åŒ–')\nprint('3. èªè¨¼æƒ…å ±ï¼ˆOAuth 2.0ï¼‰ã‚’ä½œæˆ')\nprint('4. token.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—')\nprint('\\nğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„:')\nprint('â€¢ èªè¨¼æƒ…å ±ã¯çµ¶å¯¾ã«ä»–äººã«è¦‹ã›ãªã„ã§ãã ã•ã„')\nprint('â€¢ token.jsonãƒ•ã‚¡ã‚¤ãƒ«ã¯å®‰å…¨ã«ä¿ç®¡ã—ã¦ãã ã•ã„')\nprint('â€¢ äºˆå®šã®å†…å®¹ã¯äº‹å‰ã«ç¢ºèªã—ã¦ãã ã•ã„')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®è¨­å®šï¼ˆå®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯å¤‰æ›´ã—ã¦ãã ã•ã„ï¼‰\n    SCOPES = ['https://www.googleapis.com/auth/calendar']\n    \n    # äºˆå®šã®æƒ…å ±\n    event_title = 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¼šè­°'  # â† ã“ã“ã«äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›\n    event_description = 'æ–°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒƒã‚¯ã‚ªãƒ•ä¼šè­°'  # â† ã“ã“ã«äºˆå®šã®èª¬æ˜ã‚’å…¥åŠ›\n    event_date = '2024-01-15'  # â† ã“ã“ã«äºˆå®šã®æ—¥ä»˜ã‚’å…¥åŠ›ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰\n    event_start_time = '10:00'  # â† ã“ã“ã«é–‹å§‹æ™‚åˆ»ã‚’å…¥åŠ›ï¼ˆHH:MMå½¢å¼ï¼‰\n    event_end_time = '11:00'    # â† ã“ã“ã«çµ‚äº†æ™‚åˆ»ã‚’å…¥åŠ›ï¼ˆHH:MMå½¢å¼ï¼‰\n    \n    print('\\nğŸ“ ç™»éŒ²äºˆå®šã®æƒ…å ±:')\n    print(f'â€¢ ã‚¿ã‚¤ãƒˆãƒ«: {event_title}')\n    print(f'â€¢ èª¬æ˜: {event_description}')\n    print(f'â€¢ æ—¥ä»˜: {event_date}')\n    print(f'â€¢ æ™‚é–“: {event_start_time} - {event_end_time}')\n    \n    # æ—¥æ™‚å½¢å¼ã®ä½œæˆ\n    start_datetime = f'{event_date}T{event_start_time}:00+09:00'\n    end_datetime = f'{event_date}T{event_end_time}:00+09:00'\n    \n    # äºˆå®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ\n    event = {\n        'summary': event_title,\n        'description': event_description,\n        'start': {\n            'dateTime': start_datetime,\n            'timeZone': 'Asia/Tokyo',\n        },\n        'end': {\n            'dateTime': end_datetime,\n            'timeZone': 'Asia/Tokyo',\n        },\n        'reminders': {\n            'useDefault': False,\n            'overrides': [\n                {'method': 'email', 'minutes': 24 * 60},  # 1æ—¥å‰\n                {'method': 'popup', 'minutes': 30},       # 30åˆ†å‰\n            ],\n        },\n    }\n    \n    print('\\nâœ… äºˆå®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ')\n    print(f'é–‹å§‹æ™‚åˆ»: {start_datetime}')\n    print(f'çµ‚äº†æ™‚åˆ»: {end_datetime}')\n    \n    # å®Ÿéš›ã®ç™»éŒ²ï¼ˆèªè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿å®Ÿè¡Œï¼‰\n    if os.path.exists('token.json'):\n        print('\\nğŸš€ Google Calendar APIã«æ¥ç¶šä¸­...')\n        \n        try:\n            # èªè¨¼\n            creds = Credentials.from_authorized_user_file('token.json', SCOPES)\n            service = build('calendar', 'v3', credentials=creds)\n            \n            # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æƒ…å ±ã‚’å–å¾—\n            calendar_list = service.calendarList().list().execute()\n            primary_calendar = next((cal for cal in calendar_list['items'] if cal['primary']), None)\n            \n            if primary_calendar:\n                print(f'âœ“ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æ¥ç¶š: {primary_calendar[\"summary\"]}')\n                \n                # äºˆå®šã‚’ç™»éŒ²\n                print('\\nğŸ“… äºˆå®šã‚’ç™»éŒ²ä¸­...')\n                created_event = service.events().insert(\n                    calendarId='primary', \n                    body=event\n                ).execute()\n                \n                print('âœ… äºˆå®šã®ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼')\n                print(f'äºˆå®šID: {created_event[\"id\"]}')\n                print(f'ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼URL: {created_event.get(\"htmlLink\")}')\n                print(f'ä½œæˆæ—¥æ™‚: {created_event[\"created\"]}')\n                \n            else:\n                print('âŒ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ')\n                \n        except Exception as e:\n            print(f'\\nâŒ Google Calendar API ã‚¨ãƒ©ãƒ¼: {e}')\n            print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n            print('â€¢ token.jsonãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n            print('â€¢ Google Calendar APIãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n            print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n            \n    else:\n        print('\\nâš ï¸ ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰: å®Ÿéš›ã®ç™»éŒ²ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸ')\n        print('å®Ÿéš›ã«ç™»éŒ²ã™ã‚‹ã«ã¯ã€token.jsonãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™')\n    \n    # è¤‡æ•°äºˆå®šã®ä¸€æ‹¬ç™»éŒ²æ©Ÿèƒ½ã®ãƒ‡ãƒ¢\n    print('\\nğŸ“‹ ä¸€æ‹¬ç™»éŒ²æ©Ÿèƒ½ã®ãƒ‡ãƒ¢:')\n    sample_events = [\n        {'title': 'æœä¼š', 'date': '2024-01-16', 'start': '09:00', 'end': '09:30'},\n        {'title': 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆMTG', 'date': '2024-01-16', 'start': '14:00', 'end': '15:00'},\n        {'title': 'é€±æ¬¡å ±å‘Š', 'date': '2024-01-17', 'start': '17:00', 'end': '17:30'}\n    ]\n    \n    print('\\näºˆå®šãƒªã‚¹ãƒˆ:')\n    for i, event_info in enumerate(sample_events, 1):\n        print(f'{i}. {event_info[\"title\"]} - {event_info[\"date\"]} {event_info[\"start\"]}-{event_info[\"end\"]}')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ Google Cloud Consoleã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„')\n    print('â€¢ Google Calendar APIã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„')\n    print('â€¢ OAuth 2.0èªè¨¼æƒ…å ±ã‚’ä½œæˆã—ã¦ãã ã•ã„')\n    print('â€¢ token.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®‰å…¨ã«ä¿ç®¡ã—ã¦ãã ã•ã„')\n    print('â€¢ äºˆå®šã®é‡è¤‡ã‚’é¿ã‘ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ google-authã¨google-api-python-clientãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ èªè¨¼æƒ…å ±ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²å®Œäº† ===')",
        "libraries": "google-authã€google-api-python-client",
        "explanation": "Google Calendar APIã‚’ä½¿ã£ã¦äºˆå®šã‚’è‡ªå‹•ç™»éŒ²ã™ã‚‹ã“ã¨ã§ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•å…¥åŠ›ãŒä¸è¦", "ãƒŸã‚¹ã‚’é˜²ã’ã‚‹", "ä¸€æ‹¬ç™»éŒ²ãŒå¯èƒ½"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. Google Calendar APIã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸæ—¥æ™‚ã«äºˆå®šã‚’ç™»éŒ²ã™ã‚‹\n3. äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€é–‹å§‹ãƒ»çµ‚äº†æ™‚é–“ã‚’è¨­å®šã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\näºˆå®šå†…å®¹: ä¼šè­°\næ—¥æ™‚: æŒ‡å®šã—ãŸæ—¥æ™‚\nã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼: ãƒ—ãƒ©ã‚¤ãƒãƒªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚Google Calendar APIã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸæ—¥æ™‚ã«äºˆå®šã‚’ç™»éŒ²ã—ã€äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€é–‹å§‹ãƒ»çµ‚äº†æ™‚é–“ã‚’è¨­å®šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 12, 
        "category": "é¡§å®¢ç®¡ç†",
        "number": "12/100",
        "title": "ååˆºãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ•´ç†", 
        "desc": "ååˆºç”»åƒã‹ã‚‰æƒ…å ±ã‚’è‡ªå‹•æŠ½å‡º",
        "how_to": "OCRæŠ€è¡“ã‚’ä½¿ã£ã¦ååˆºç”»åƒã‹ã‚‰æ–‡å­—ã‚’èªè­˜ã—ã€é€£çµ¡å…ˆæƒ…å ±ã‚’è‡ªå‹•æŠ½å‡ºã—ã¾ã™ã€‚",
        "sample_code": "import cv2\nimport pytesseract\nimport re\nimport pandas as pd\nfrom datetime import datetime\nimport os\n\nprint('=== ååˆºãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ•´ç†ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('ååˆºç”»åƒã‹ã‚‰é€£çµ¡å…ˆæƒ…å ±ã‚’è‡ªå‹•æŠ½å‡ºã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚')\nprint('\\nğŸ“· å¿…è¦ãªè¨­å®š:')\nprint('1. Tesseract OCRã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«')\nprint('2. æ—¥æœ¬èªè¨€èªãƒ‘ãƒƒã‚¯ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«')\nprint('3. OpenCVã¨pytesseractãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ ååˆºç”»åƒã¯é®®æ˜ã§èª­ã¿ã‚„ã™ã„ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„')\nprint('â€¢ æ–‡å­—ãŒå°ã•ã™ããŸã‚Šã€å‚¾ã„ã¦ã„ã‚‹ã¨èªè­˜ç²¾åº¦ãŒä¸‹ãŒã‚Šã¾ã™')\nprint('â€¢ å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ååˆºãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®ç”»åƒã®ä»£ã‚ã‚Šï¼‰\n    print('\\nğŸ“‚ ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ååˆºã‚’å‡¦ç†ä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«ååˆºãƒªã‚¹ãƒˆ\n    sample_cards = [\n        {\n            'filename': 'card1.jpg',\n            'extracted_text': '''\n            æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«\n            ç”°ä¸­ å¤ªéƒ\n            å–¶æ¥­éƒ¨ éƒ¨é•·\n            \n            ã€’100-0001\n            æ±äº¬éƒ½åƒä»£ç”°åŒºåƒä»£ç”°1-1-1\n            \n            TEL: 03-1234-5678\n            FAX: 03-1234-5679\n            \n            Email: tanaka@sample.co.jp\n            URL: https://www.sample.co.jp\n            '''\n        },\n        {\n            'filename': 'card2.jpg',\n            'extracted_text': '''\n            ä½è—¤ èŠ±å­\n            ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨\n            \n            ã€’530-0001\n            å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°1-1-1\n            \n            Tel: 06-1234-5678\n            Mobile: 090-1234-5678\n            \n            sato@example.com\n            '''\n        },\n        {\n            'filename': 'card3.jpg',\n            'extracted_text': '''\n            éˆ´æœ¨ ä¸€éƒ\n            ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºéƒ¨ èª²é•·\n            \n            ã€’460-0001\n            æ„›çŸ¥çœŒåå¤å±‹å¸‚ä¸­åŒºæ „1-1-1\n            \n            é›»è©±: 052-123-4567\n            æºå¸¯: 080-1234-5678\n            \n            suzuki@tech.co.jp\n            '''\n        }\n    ]\n    \n    def extract_business_card_info(extracted_text):\n        \"\"\"ååˆºã®ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹é–¢æ•°\"\"\"\n        \n        # æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®šç¾©\n        patterns = {\n            'name': [\n                r'([\\u4e00-\\u9fa5]{2,4})\\s*[\\u4e00-\\u9fa5]{2,4}',  # å§“å\n                r'([\\u4e00-\\u9fa5]{2,4})',  # åå‰ã®ã¿\n            ],\n            'company': [\n                r'([\\u4e00-\\u9fa5]+æ ªå¼ä¼šç¤¾)',\n                r'([\\u4e00-\\u9fa5]+æœ‰é™ä¼šç¤¾)',\n                r'([\\u4e00-\\u9fa5]+åˆåŒä¼šç¤¾)',\n            ],\n            'department': [\n                r'([\\u4e00-\\u9fa5]+éƒ¨)',\n                r'([\\u4e00-\\u9fa5]+èª²)',\n            ],\n            'position': [\n                r'([\\u4e00-\\u9fa5]+é•·)',\n                r'([\\u4e00-\\u9fa5]+å“¡)',\n            ],\n            'phone': [\n                r'(\\d{2,4}-\\d{2,4}-\\d{4})',  # å›ºå®šé›»è©±\n                r'(TEL|Tel|é›»è©±)[:\\s]*(\\d{2,4}-\\d{2,4}-\\d{4})',\n            ],\n            'mobile': [\n                r'(\\d{3}-\\d{4}-\\d{4})',  # æºå¸¯é›»è©±\n                r'(Mobile|æºå¸¯)[:\\s]*(\\d{3}-\\d{4}-\\d{4})',\n            ],\n            'email': [\n                r'([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})',\n            ],\n            'address': [\n                r'ã€’\\d{3}-\\d{4}\\s*([\\u4e00-\\u9fa5]+)',\n            ],\n            'website': [\n                r'(https?://[\\w\\-./]+)',\n                r'(URL|Web)[:\\s]*(https?://[\\w\\-./]+)',\n            ]\n        }\n        \n        # æƒ…å ±ã‚’æŠ½å‡º\n        extracted_info = {}\n        \n        for field, pattern_list in patterns.items():\n            for pattern in pattern_list:\n                match = re.search(pattern, extracted_text)\n                if match:\n                    # ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã¯é©åˆ‡ãªã‚‚ã®ã‚’é¸æŠ\n                    if len(match.groups()) > 1:\n                        extracted_info[field] = match.group(2) if match.group(2) else match.group(1)\n                    else:\n                        extracted_info[field] = match.group(1)\n                    break\n        \n        return extracted_info\n    \n    # ååˆºæƒ…å ±ã‚’å‡¦ç†\n    processed_cards = []\n    \n    print('\\nğŸ” ååˆºæƒ…å ±ã‚’æŠ½å‡ºä¸­...')\n    \n    for card in sample_cards:\n        print(f'\\nğŸ“„ å‡¦ç†ä¸­: {card[\"filename\"]}')\n        \n        # æƒ…å ±ã‚’æŠ½å‡º\n        info = extract_business_card_info(card['extracted_text'])\n        \n        # å‡¦ç†çµæœã‚’è¨˜éŒ²\n        card_info = {\n            'ãƒ•ã‚¡ã‚¤ãƒ«å': card['filename'],\n            'ä¼šç¤¾å': info.get('company', ''),\n            'æ°å': info.get('name', ''),\n            'éƒ¨ç½²': info.get('department', ''),\n            'å½¹è·': info.get('position', ''),\n            'é›»è©±ç•ªå·': info.get('phone', ''),\n            'æºå¸¯é›»è©±': info.get('mobile', ''),\n            'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹': info.get('email', ''),\n            'ä½æ‰€': info.get('address', ''),\n            'Webã‚µã‚¤ãƒˆ': info.get('website', ''),\n            'å‡¦ç†æ—¥æ™‚': datetime.now().strftime('%Y-%m-%d %H:%M:%S')\n        }\n        \n        processed_cards.append(card_info)\n        \n        # æŠ½å‡ºçµæœã‚’è¡¨ç¤º\n        print(f'âœ“ ä¼šç¤¾å: {card_info[\"ä¼šç¤¾å\"]}')\n        print(f'âœ“ æ°å: {card_info[\"æ°å\"]}')\n        print(f'âœ“ éƒ¨ç½²: {card_info[\"éƒ¨ç½²\"]}')\n        print(f'âœ“ é›»è©±ç•ªå·: {card_info[\"é›»è©±ç•ªå·\"]}')\n        print(f'âœ“ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: {card_info[\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\"]}')\n    \n    if processed_cards:\n        # DataFrameã«å¤‰æ›\n        df = pd.DataFrame(processed_cards)\n        \n        # CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜\n        filename = f'business_cards_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.csv'\n        df.to_csv(filename, index=False, encoding='utf-8-sig')\n        \n        print(f'\\nâœ… ååˆºãƒ‡ãƒ¼ã‚¿æ•´ç†å®Œäº†ï¼')\n        print(f'å‡¦ç†ä»¶æ•°: {len(processed_cards)}ä»¶')\n        print(f'ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«: {filename}')\n        \n        print('\\nğŸ“Š æŠ½å‡ºçµæœ:')\n        print(df.to_string(index=False))\n        \n        # çµ±è¨ˆæƒ…å ±\n        print('\\nğŸ“ˆ çµ±è¨ˆæƒ…å ±:')\n        print(f'â€¢ ç·å‡¦ç†ä»¶æ•°: {len(processed_cards)}ä»¶')\n        print(f'â€¢ ä¼šç¤¾åæŠ½å‡ºç‡: {sum(1 for c in processed_cards if c[\"ä¼šç¤¾å\"]) / len(processed_cards) * 100:.1f}%')\n        print(f'â€¢ é›»è©±ç•ªå·æŠ½å‡ºç‡: {sum(1 for c in processed_cards if c[\"é›»è©±ç•ªå·\"]) / len(processed_cards) * 100:.1f}%')\n        print(f'â€¢ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹æŠ½å‡ºç‡: {sum(1 for c in processed_cards if c[\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\"]) / len(processed_cards) * 100:.1f}%')\n        \n    else:\n        print('\\nâŒ å‡¦ç†å¯èƒ½ãªååˆºãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ ååˆºç”»åƒã¯é®®æ˜ã§èª­ã¿ã‚„ã™ã„ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„')\n    print('â€¢ æ–‡å­—ãŒå°ã•ã™ããŸã‚Šã€å‚¾ã„ã¦ã„ã‚‹ã¨èªè­˜ç²¾åº¦ãŒä¸‹ãŒã‚Šã¾ã™')\n    print('â€¢ å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„')\n    print('â€¢ æŠ½å‡ºçµæœã¯å¿…ãšç¢ºèªã—ã¦ã‹ã‚‰ä½¿ç”¨ã—ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ Tesseract OCRãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ æ—¥æœ¬èªè¨€èªãƒ‘ãƒƒã‚¯ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ OpenCVã¨pytesseractãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„å½¢å¼ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ååˆºãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ•´ç†å®Œäº† ===')",
        "libraries": "opencv-pythonã€pytesseractã€reï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ååˆºã®ç”»åƒã‹ã‚‰è‡ªå‹•ã§é€£çµ¡å…ˆæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã€æ‰‹å‹•å…¥åŠ›ã®æ‰‹é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•å…¥åŠ›ãŒä¸è¦", "å¤§é‡å‡¦ç†ãŒå¯èƒ½", "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒ–ãŒç°¡å˜"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ååˆºãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ•´ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. OpenCVã¨Tesseract OCRã‚’ä½¿ã†\n2. ååˆºç”»åƒã‹ã‚‰æ–‡å­—ã‚’èªè­˜ã™ã‚‹\n3. åå‰ã€é›»è©±ç•ªå·ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡ºã™ã‚‹\n4. æ­£è¦è¡¨ç¾ã§æƒ…å ±ã‚’æ•´ç†ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ç”»åƒ: ååˆºã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«\næŠ½å‡ºæƒ…å ±: åå‰ã€é›»è©±ç•ªå·ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\nå‡ºåŠ›å½¢å¼: è¾æ›¸å½¢å¼\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ååˆºãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ•´ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚OpenCVã¨Tesseract OCRã‚’ä½¿ã£ã¦ååˆºç”»åƒã‹ã‚‰æ–‡å­—ã‚’èªè­˜ã—ã€åå‰ã€é›»è©±ç•ªå·ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡ºã—ã¦æ­£è¦è¡¨ç¾ã§æƒ…å ±ã‚’æ•´ç†ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 13, 
        "category": "æ–‡æ›¸ä½œæˆãƒ»ç®¡ç†",
        "number": "13/100",
        "title": "è«‹æ±‚æ›¸è‡ªå‹•ä½œæˆ", 
        "desc": "è«‹æ±‚æ›¸ã‚’è‡ªå‹•ã§ä½œæˆ",
        "how_to": "ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦è«‹æ±‚æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã—ã€PDFãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚",
        "sample_code": "from reportlab.pdfgen import canvas\nfrom reportlab.lib.pagesizes import A4\nfrom reportlab.lib import colors\nfrom reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle\nfrom reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle\nfrom reportlab.lib.units import inch\nfrom datetime import datetime\nimport os\n\nprint('=== è«‹æ±‚æ›¸è‡ªå‹•ä½œæˆï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªè«‹æ±‚æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚')\nprint('\\nğŸ“„ æ©Ÿèƒ½:')\nprint('â€¢ è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ')\nprint('â€¢ è‡ªå‹•è¨ˆç®—æ©Ÿèƒ½')\nprint('â€¢ ç¨é¡è¨ˆç®—')\nprint('â€¢ æ”¯æ‰•ã„æ¡ä»¶ã®è¨­å®š')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ è«‹æ±‚æ›¸ã®å†…å®¹ã¯å¿…ãšç¢ºèªã—ã¦ãã ã•ã„')\nprint('â€¢ æ³•çš„è¦ä»¶ã«å¾“ã£ã¦ä½œæˆã—ã¦ãã ã•ã„')\nprint('â€¢ ç¨å‹™ç½²ã®è¦ä»¶ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n\ntry:\n    # è«‹æ±‚æ›¸ã®åŸºæœ¬æƒ…å ±\n    invoice_info = {\n        'invoice_number': 'INV-2024-001',  # â† ã“ã“ã«è«‹æ±‚æ›¸ç•ªå·ã‚’å…¥åŠ›\n        'issue_date': datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥'),\n        'due_date': '2024å¹´2æœˆ15æ—¥',  # â† ã“ã“ã«æ”¯æ‰•æœŸé™ã‚’å…¥åŠ›\n        'company_name': 'æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«',  # â† ã“ã“ã«ä¼šç¤¾åã‚’å…¥åŠ›\n        'company_address': 'ã€’100-0001 æ±äº¬éƒ½åƒä»£ç”°åŒºåƒä»£ç”°1-1-1',\n        'company_phone': '03-1234-5678',\n        'company_email': 'info@sample.co.jp',\n        'client_name': 'æ ªå¼ä¼šç¤¾ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ',  # â† ã“ã“ã«é¡§å®¢åã‚’å…¥åŠ›\n        'client_address': 'ã€’530-0001 å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°1-1-1',\n        'payment_terms': 'æœˆæœ«ç· ã‚ç¿Œæœˆæœ«æ‰•ã„',\n        'tax_rate': 0.10  # æ¶ˆè²»ç¨ç‡ï¼ˆ10%ï¼‰\n    }\n    \n    # æ˜ç´°é …ç›®\n    items = [\n        {'description': 'Webã‚µã‚¤ãƒˆåˆ¶ä½œè²»', 'quantity': 1, 'unit_price': 150000, 'remarks': 'ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ'},\n        {'description': 'ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºè²»', 'quantity': 1, 'unit_price': 300000, 'remarks': 'ç®¡ç†ç”»é¢ä»˜ã'},\n        {'description': 'ä¿å®ˆãƒ»é‹ç”¨è²»ï¼ˆæœˆé¡ï¼‰', 'quantity': 12, 'unit_price': 25000, 'remarks': 'å¹´é–“å¥‘ç´„'}\n    ]\n    \n    print('\\nğŸ“ è«‹æ±‚æ›¸æƒ…å ±:')\n    print(f'â€¢ è«‹æ±‚æ›¸ç•ªå·: {invoice_info[\"invoice_number\"]}')\n    print(f'â€¢ ç™ºè¡Œæ—¥: {invoice_info[\"issue_date\"]}')\n    print(f'â€¢ æ”¯æ‰•æœŸé™: {invoice_info[\"due_date\"]}')\n    print(f'â€¢ é¡§å®¢å: {invoice_info[\"client_name\"]}')\n    \n    # é‡‘é¡è¨ˆç®—\n    subtotal = sum(item['quantity'] * item['unit_price'] for item in items)\n    tax_amount = int(subtotal * invoice_info['tax_rate'])\n    total_amount = subtotal + tax_amount\n    \n    print(f'\\nğŸ’° é‡‘é¡è¨ˆç®—:')\n    print(f'â€¢ å°è¨ˆ: {subtotal:,}å††')\n    print(f'â€¢ æ¶ˆè²»ç¨ï¼ˆ{invoice_info[\"tax_rate\"]*100}%ï¼‰: {tax_amount:,}å††')\n    print(f'â€¢ åˆè¨ˆ: {total_amount:,}å††')\n    \n    # PDFãƒ•ã‚¡ã‚¤ãƒ«å\n    filename = f'invoice_{datetime.now().strftime(\"%Y%m%d_%H%M%S\")}.pdf'\n    \n    # PDFä½œæˆ\n    print('\\nğŸ“„ PDFã‚’ä½œæˆä¸­...')\n    doc = SimpleDocTemplate(filename, pagesize=A4)\n    story = []\n    \n    # ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š\n    styles = getSampleStyleSheet()\n    title_style = ParagraphStyle(\n        'CustomTitle',\n        parent=styles['Heading1'],\n        fontSize=18,\n        spaceAfter=30,\n        alignment=1  # ä¸­å¤®æƒãˆ\n    )\n    \n    # ã‚¿ã‚¤ãƒˆãƒ«\n    story.append(Paragraph('è«‹æ±‚æ›¸', title_style))\n    story.append(Spacer(1, 20))\n    \n    # è«‹æ±‚æ›¸æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«\n    invoice_data = [\n        ['è«‹æ±‚æ›¸ç•ªå·', invoice_info['invoice_number'], 'ç™ºè¡Œæ—¥', invoice_info['issue_date']],\n        ['æ”¯æ‰•æœŸé™', invoice_info['due_date'], 'æ”¯æ‰•æ¡ä»¶', invoice_info['payment_terms']],\n    ]\n    \n    invoice_table = Table(invoice_data, colWidths=[1.5*inch, 2*inch, 1.5*inch, 2*inch])\n    invoice_table.setStyle(TableStyle([\n        ('BACKGROUND', (0, 0), (-1, -1), colors.lightgrey),\n        ('TEXTCOLOR', (0, 0), (-1, -1), colors.black),\n        ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n        ('FONTNAME', (0, 0), (-1, -1), 'Helvetica'),\n        ('FONTSIZE', (0, 0), (-1, -1), 10),\n        ('BOTTOMPADDING', (0, 0), (-1, -1), 12),\n        ('GRID', (0, 0), (-1, -1), 1, colors.black)\n    ]))\n    story.append(invoice_table)\n    story.append(Spacer(1, 20))\n    \n    # ä¼šç¤¾æƒ…å ±ã¨é¡§å®¢æƒ…å ±\n    company_client_data = [\n        ['è«‹æ±‚å…ƒ', 'è«‹æ±‚å…ˆ'],\n        [f\"{invoice_info['company_name']}\\n{invoice_info['company_address']}\\nTEL: {invoice_info['company_phone']}\\nEmail: {invoice_info['company_email']}\", \n         f\"{invoice_info['client_name']}\\n{invoice_info['client_address']}\"]\n    ]\n    \n    company_client_table = Table(company_client_data, colWidths=[3*inch, 3*inch])\n    company_client_table.setStyle(TableStyle([\n        ('BACKGROUND', (0, 0), (-1, 0), colors.grey),\n        ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),\n        ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n        ('FONTSIZE', (0, 0), (-1, -1), 10),\n        ('BOTTOMPADDING', (0, 0), (-1, -1), 12),\n        ('GRID', (0, 0), (-1, -1), 1, colors.black)\n    ]))\n    story.append(company_client_table)\n    story.append(Spacer(1, 20))\n    \n    # æ˜ç´°ãƒ†ãƒ¼ãƒ–ãƒ«\n    table_data = [['é …ç›®', 'æ•°é‡', 'å˜ä¾¡', 'é‡‘é¡', 'å‚™è€ƒ']]\n    for item in items:\n        amount = item['quantity'] * item['unit_price']\n        table_data.append([\n            item['description'],\n            str(item['quantity']),\n            f\"{item['unit_price']:,}å††\",\n            f\"{amount:,}å††\",\n            item['remarks']\n        ])\n    \n    # åˆè¨ˆè¡Œ\n    table_data.append(['', '', 'å°è¨ˆ', f\"{subtotal:,}å††\", ''])\n    table_data.append(['', '', f'æ¶ˆè²»ç¨ï¼ˆ{invoice_info[\"tax_rate\"]*100}%ï¼‰', f\"{tax_amount:,}å††\", ''])\n    table_data.append(['', '', 'åˆè¨ˆ', f\"{total_amount:,}å††\", ''])\n    \n    table = Table(table_data, colWidths=[2.5*inch, 0.8*inch, 1*inch, 1.2*inch, 1.5*inch])\n    table.setStyle(TableStyle([\n        ('BACKGROUND', (0, 0), (-1, 0), colors.grey),\n        ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),\n        ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n        ('ALIGN', (1, 1), (1, -1), 'CENTER'),  # æ•°é‡ã‚’ä¸­å¤®æƒãˆ\n        ('ALIGN', (2, 1), (3, -1), 'RIGHT'),   # é‡‘é¡ã‚’å³æƒãˆ\n        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n        ('FONTSIZE', (0, 0), (-1, -1), 9),\n        ('BOTTOMPADDING', (0, 0), (-1, -1), 12),\n        ('GRID', (0, 0), (-1, -1), 1, colors.black),\n        ('BACKGROUND', (0, -3), (-1, -1), colors.lightgrey),  # åˆè¨ˆè¡Œã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ\n    ]))\n    story.append(table)\n    \n    # å‚™è€ƒ\n    story.append(Spacer(1, 20))\n    story.append(Paragraph('<b>å‚™è€ƒ:</b>', styles['Normal']))\n    story.append(Paragraph('â€¢ æ”¯æ‰•ã„ã¯éŠ€è¡ŒæŒ¯è¾¼ã«ã¦ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚', styles['Normal']))\n    story.append(Paragraph('â€¢ æŒ¯è¾¼æ‰‹æ•°æ–™ã¯ãŠå®¢æ§˜è² æ‹…ã¨ãªã‚Šã¾ã™ã€‚', styles['Normal']))\n    story.append(Paragraph('â€¢ ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚', styles['Normal']))\n    \n    # PDFã‚’ç”Ÿæˆ\n    doc.build(story)\n    \n    print(f'âœ… è«‹æ±‚æ›¸ä½œæˆå®Œäº†ï¼')\n    print(f'ãƒ•ã‚¡ã‚¤ãƒ«å: {filename}')\n    print(f'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: {os.path.getsize(filename) / 1024:.1f}KB')\n    \n    print('\\nğŸ“Š è«‹æ±‚æ›¸è©³ç´°:')\n    print(f'â€¢ æ˜ç´°é …ç›®æ•°: {len(items)}ä»¶')\n    print(f'â€¢ è«‹æ±‚é‡‘é¡: {total_amount:,}å††')\n    print(f'â€¢ æ¶ˆè²»ç¨é¡: {tax_amount:,}å††')\n    print(f'â€¢ æ”¯æ‰•æœŸé™: {invoice_info[\"due_date\"]}')\n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ è«‹æ±‚æ›¸ã®å†…å®¹ã¯å¿…ãšç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ æ³•çš„è¦ä»¶ã«å¾“ã£ã¦ä½œæˆã—ã¦ãã ã•ã„')\n    print('â€¢ ç¨å‹™ç½²ã®è¦ä»¶ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ é¡§å®¢æƒ…å ±ã¯æ­£ç¢ºã«å…¥åŠ›ã—ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== è«‹æ±‚æ›¸è‡ªå‹•ä½œæˆå®Œäº† ===')",
        "libraries": "reportlabã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "è«‹æ±‚æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€çµŒç†ä½œæ¥­ã‚’åŠ¹ç‡åŒ–ã—ã€ãƒŸã‚¹ã‚’é˜²ã’ã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•ä½œæˆãŒä¸è¦", "ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒçµ±ä¸€", "å¤§é‡ä½œæˆãŒå¯èƒ½"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§è«‹æ±‚æ›¸è‡ªå‹•ä½œæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. é¡§å®¢åã€æ˜ç´°ã€åˆè¨ˆé‡‘é¡ã‚’å«ã‚€è«‹æ±‚æ›¸ã‚’ä½œæˆã™ã‚‹\n3. è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã™ã‚‹\n4. PDFãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nè«‹æ±‚æ›¸å†…å®¹: é¡§å®¢åã€æ˜ç´°ã€åˆè¨ˆé‡‘é¡\nå‡ºåŠ›å½¢å¼: PDFãƒ•ã‚¡ã‚¤ãƒ«\nãƒ•ã‚¡ã‚¤ãƒ«å: invoice.pdf\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§è«‹æ±‚æ›¸è‡ªå‹•ä½œæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦é¡§å®¢åã€æ˜ç´°ã€åˆè¨ˆé‡‘é¡ã‚’å«ã‚€è«‹æ±‚æ›¸ã‚’ä½œæˆã—ã€è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã—ã¦PDFãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 14, 
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "14/100",
        "title": "ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆè‡ªå‹•é›†è¨ˆ", 
        "desc": "ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’è‡ªå‹•ã§é›†è¨ˆ",
        "how_to": "Excelã‚„CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’èª­ã¿è¾¼ã¿ã€è‡ªå‹•ã§é›†è¨ˆãƒ»åˆ†æã—ã¾ã™ã€‚",
        "sample_code": "import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom datetime import datetime\nimport seaborn as sns\n\nprint('=== ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆè‡ªå‹•é›†è¨ˆï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’è‡ªå‹•ã§é›†è¨ˆãƒ»åˆ†æã—ã¾ã™ã€‚')\nprint('\\nğŸ“Š æ©Ÿèƒ½:')\nprint('â€¢ åŸºæœ¬çµ±è¨ˆã®è¨ˆç®—')\nprint('â€¢ ã‚¯ãƒ­ã‚¹é›†è¨ˆåˆ†æ')\nprint('â€¢ ã‚°ãƒ©ãƒ•ä½œæˆ')\nprint('â€¢ ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„')\nprint('â€¢ çµ±è¨ˆçµæœã¯é©åˆ‡ã«è§£é‡ˆã—ã¦ãã ã•ã„')\nprint('â€¢ ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒå°ã•ã„å ´åˆã¯æ³¨æ„ãŒå¿…è¦ã§ã™')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿\n    print('\\nğŸ“‚ ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\n    np.random.seed(42)  # å†ç¾æ€§ã®ãŸã‚\n    n_responses = 100\n    \n    # å¹´é½¢ãƒ‡ãƒ¼ã‚¿ï¼ˆ20-60æ­³ã®æ­£è¦åˆ†å¸ƒï¼‰\n    ages = np.random.normal(35, 10, n_responses).astype(int)\n    ages = np.clip(ages, 20, 60)\n    \n    # æ€§åˆ¥ãƒ‡ãƒ¼ã‚¿\n    genders = np.random.choice(['ç”·æ€§', 'å¥³æ€§'], n_responses, p=[0.6, 0.4])\n    \n    # æº€è¶³åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆ1-5æ®µéšè©•ä¾¡ï¼‰\n    satisfaction = np.random.choice([1, 2, 3, 4, 5], n_responses, p=[0.05, 0.1, 0.2, 0.4, 0.25])\n    \n    # åˆ©ç”¨é »åº¦ãƒ‡ãƒ¼ã‚¿\n    usage_frequency = np.random.choice(['æ¯æ—¥', 'é€±1-2å›', 'æœˆ1-2å›', 'åŠå¹´ã«1å›', 'åˆå›'], n_responses, p=[0.3, 0.4, 0.2, 0.08, 0.02])\n    \n    # æ”¹å–„è¦æœ›ãƒ‡ãƒ¼ã‚¿\n    improvement_requests = np.random.choice([\n        'ä½¿ã„ã‚„ã™ã•ã®å‘ä¸Š', 'æ©Ÿèƒ½ã®è¿½åŠ ', 'ä¾¡æ ¼ã®è¦‹ç›´ã—', 'ã‚µãƒãƒ¼ãƒˆã®å……å®Ÿ', 'ç‰¹ã«ãªã„'\n    ], n_responses, p=[0.3, 0.25, 0.2, 0.15, 0.1])\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ\n    survey_data = pd.DataFrame({\n        'å›ç­”ID': range(1, n_responses + 1),\n        'å¹´é½¢': ages,\n        'æ€§åˆ¥': genders,\n        'æº€è¶³åº¦': satisfaction,\n        'åˆ©ç”¨é »åº¦': usage_frequency,\n        'æ”¹å–„è¦æœ›': improvement_requests,\n        'å›ç­”æ—¥æ™‚': pd.date_range('2024-01-01', periods=n_responses, freq='D')\n    })\n    \n    print(f'\\nğŸ“Š ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ä½œæˆå®Œäº†: {len(survey_data)}ä»¶')\n    \n    # åŸºæœ¬çµ±è¨ˆ\n    print('\\n=== ğŸ“ˆ åŸºæœ¬çµ±è¨ˆ ===')\n    print(f'â€¢ å›ç­”è€…æ•°: {len(survey_data):,}äºº')\n    print(f'â€¢ å¹³å‡å¹´é½¢: {survey_data[\"å¹´é½¢\"].mean():.1f}æ­³')\n    print(f'â€¢ å¹´é½¢ç¯„å›²: {survey_data[\"å¹´é½¢\"].min()}æ­³ - {survey_data[\"å¹´é½¢\"].max()}æ­³')\n    print(f'â€¢ æ¨™æº–åå·®: {survey_data[\"å¹´é½¢\"].std():.1f}æ­³')\n    \n    # æ€§åˆ¥é›†è¨ˆ\n    print('\\n=== ğŸ‘¥ æ€§åˆ¥é›†è¨ˆ ===')\n    gender_counts = survey_data['æ€§åˆ¥'].value_counts()\n    gender_percentages = survey_data['æ€§åˆ¥'].value_counts(normalize=True) * 100\n    \n    for gender, count in gender_counts.items():\n        percentage = gender_percentages[gender]\n        print(f'â€¢ {gender}: {count}äºº ({percentage:.1f}%)')\n    \n    # æº€è¶³åº¦é›†è¨ˆ\n    print('\\n=== ğŸ˜Š æº€è¶³åº¦é›†è¨ˆ ===')\n    satisfaction_counts = survey_data['æº€è¶³åº¦'].value_counts().sort_index()\n    satisfaction_percentages = survey_data['æº€è¶³åº¦'].value_counts(normalize=True).sort_index() * 100\n    \n    satisfaction_labels = {1: 'éå¸¸ã«ä¸æº€', 2: 'ä¸æº€', 3: 'æ™®é€š', 4: 'æº€è¶³', 5: 'éå¸¸ã«æº€è¶³'}\n    \n    for score, count in satisfaction_counts.items():\n        percentage = satisfaction_percentages[score]\n        label = satisfaction_labels[score]\n        print(f'â€¢ {score}ç‚¹ï¼ˆ{label}ï¼‰: {count}äºº ({percentage:.1f}%)')\n    \n    # å¹³å‡æº€è¶³åº¦\n    avg_satisfaction = survey_data['æº€è¶³åº¦'].mean()\n    print(f'â€¢ å¹³å‡æº€è¶³åº¦: {avg_satisfaction:.2f}ç‚¹')\n    \n    # åˆ©ç”¨é »åº¦é›†è¨ˆ\n    print('\\n=== ğŸ“… åˆ©ç”¨é »åº¦é›†è¨ˆ ===')\n    usage_counts = survey_data['åˆ©ç”¨é »åº¦'].value_counts()\n    for usage, count in usage_counts.items():\n        percentage = (count / len(survey_data)) * 100\n        print(f'â€¢ {usage}: {count}äºº ({percentage:.1f}%)')\n    \n    # æ”¹å–„è¦æœ›é›†è¨ˆ\n    print('\\n=== ğŸ’¡ æ”¹å–„è¦æœ›é›†è¨ˆ ===')\n    improvement_counts = survey_data['æ”¹å–„è¦æœ›'].value_counts()\n    for request, count in improvement_counts.items():\n        percentage = (count / len(survey_data)) * 100\n        print(f'â€¢ {request}: {count}äºº ({percentage:.1f}%)')\n    \n    # ã‚¯ãƒ­ã‚¹é›†è¨ˆåˆ†æ\n    print('\\n=== ğŸ” ã‚¯ãƒ­ã‚¹é›†è¨ˆåˆ†æ ===')\n    \n    # æ€§åˆ¥Ã—æº€è¶³åº¦\n    print('\\nã€æ€§åˆ¥Ã—æº€è¶³åº¦ã€‘')\n    gender_satisfaction = pd.crosstab(survey_data['æ€§åˆ¥'], survey_data['æº€è¶³åº¦'], margins=True)\n    print(gender_satisfaction)\n    \n    # åˆ©ç”¨é »åº¦Ã—æº€è¶³åº¦\n    print('\\nã€åˆ©ç”¨é »åº¦Ã—æº€è¶³åº¦ã€‘')\n    usage_satisfaction = pd.crosstab(survey_data['åˆ©ç”¨é »åº¦'], survey_data['æº€è¶³åº¦'], margins=True)\n    print(usage_satisfaction)\n    \n    # å¹´é½¢å±¤åˆ¥åˆ†æ\n    print('\\n=== ğŸ“Š å¹´é½¢å±¤åˆ¥åˆ†æ ===')\n    survey_data['å¹´é½¢å±¤'] = pd.cut(survey_data['å¹´é½¢'], \n                                bins=[0, 30, 40, 50, 100], \n                                labels=['20-30ä»£', '30-40ä»£', '40-50ä»£', '50ä»£ä»¥ä¸Š'])\n    \n    age_satisfaction = survey_data.groupby('å¹´é½¢å±¤')['æº€è¶³åº¦'].agg(['count', 'mean', 'std']).round(2)\n    print(age_satisfaction)\n    \n    # çµ±è¨ˆæƒ…å ±ã®ä¿å­˜\n    print('\\n=== ğŸ’¾ çµæœã®ä¿å­˜ ===')\n    \n    # é›†è¨ˆçµæœã‚’DataFrameã«ã¾ã¨ã‚ã‚‹\n    summary_data = {\n        'é …ç›®': ['å›ç­”è€…æ•°', 'å¹³å‡å¹´é½¢', 'å¹³å‡æº€è¶³åº¦', 'ç”·æ€§æ¯”ç‡', 'å¥³æ€§æ¯”ç‡', 'æº€è¶³åº¦4-5ç‚¹æ¯”ç‡'],\n        'å€¤': [\n            len(survey_data),\n            f\"{survey_data['å¹´é½¢'].mean():.1f}æ­³\",\n            f\"{survey_data['æº€è¶³åº¦'].mean():.2f}ç‚¹\",\n            f\"{gender_percentages['ç”·æ€§']:.1f}%\",\n            f\"{gender_percentages['å¥³æ€§']:.1f}%\",\n            f\"{(satisfaction_counts[4:].sum() / len(survey_data)) * 100:.1f}%\"\n        ]\n    }\n    \n    summary_df = pd.DataFrame(summary_data)\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜\n    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\n    \n    # è©³ç´°ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜\n    survey_data.to_csv(f'survey_data_{timestamp}.csv', index=False, encoding='utf-8-sig')\n    \n    # é›†è¨ˆçµæœã®ä¿å­˜\n    summary_df.to_csv(f'survey_summary_{timestamp}.csv', index=False, encoding='utf-8-sig')\n    \n    print(f'âœ… é›†è¨ˆå®Œäº†ï¼')\n    print(f'â€¢ è©³ç´°ãƒ‡ãƒ¼ã‚¿: survey_data_{timestamp}.csv')\n    print(f'â€¢ é›†è¨ˆçµæœ: survey_summary_{timestamp}.csv')\n    \n    # ä¸»è¦ãªç™ºè¦‹\n    print('\\n=== ğŸ” ä¸»è¦ãªç™ºè¦‹ ===')\n    print(f'â€¢ æœ€ã‚‚å¤šã„å¹´é½¢å±¤: {survey_data[\"å¹´é½¢å±¤\"].mode().iloc[0]}') \n    print(f'â€¢ æœ€ã‚‚å¤šã„æ”¹å–„è¦æœ›: {improvement_counts.index[0]}') \n    print(f'â€¢ æœ€ã‚‚å¤šã„åˆ©ç”¨é »åº¦: {usage_counts.index[0]}') \n    \n    if avg_satisfaction >= 4.0:\n        print('â€¢ æº€è¶³åº¦ã¯é«˜ã„æ°´æº–ã§ã™') \n    elif avg_satisfaction >= 3.0:\n        print('â€¢ æº€è¶³åº¦ã¯æ™®é€šã®æ°´æº–ã§ã™') \n    else:\n        print('â€¢ æº€è¶³åº¦ã¯æ”¹å–„ãŒå¿…è¦ã§ã™') \n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„')\n    print('â€¢ çµ±è¨ˆçµæœã¯é©åˆ‡ã«è§£é‡ˆã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒå°ã•ã„å ´åˆã¯æ³¨æ„ãŒå¿…è¦ã§ã™')\n    print('â€¢ ã‚°ãƒ©ãƒ•ä½œæˆæ©Ÿèƒ½ã‚‚åˆ©ç”¨ã§ãã¾ã™')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ pandasã€matplotlibã€numpyãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ CSVãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ãƒ‡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆè‡ªå‹•é›†è¨ˆå®Œäº† ===')",
        "libraries": "pandasã€matplotlib",
        "explanation": "ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’è‡ªå‹•é›†è¨ˆã™ã‚‹ã“ã¨ã§ã€æ‰‹ä½œæ¥­ã®æ™‚é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã—ã€æ­£ç¢ºãªåˆ†æãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚",
        "benefits": ["æ‰‹ä½œæ¥­ãŒä¸è¦", "æ­£ç¢ºãªé›†è¨ˆ", "ã‚°ãƒ©ãƒ•ã‚‚è‡ªå‹•ä½œæˆ"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆè‡ªå‹•é›†è¨ˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’èª­ã¿è¾¼ã‚€\n3. åŸºæœ¬çµ±è¨ˆï¼ˆå›ç­”è€…æ•°ã€å¹³å‡å¹´é½¢ãªã©ï¼‰ã‚’è¨ˆç®—ã™ã‚‹\n4. æ€§åˆ¥ã€æº€è¶³åº¦ãªã©ã®é›†è¨ˆã‚’è¡Œã†\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: survey_results.csv\né›†è¨ˆé …ç›®: æ€§åˆ¥ã€å¹´é½¢ã€æº€è¶³åº¦\nå‡ºåŠ›: çµ±è¨ˆçµæœã¨ã‚°ãƒ©ãƒ•\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆè‡ªå‹•é›†è¨ˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’èª­ã¿è¾¼ã¿ã€åŸºæœ¬çµ±è¨ˆã‚’è¨ˆç®—ã—ã¦æ€§åˆ¥ã€æº€è¶³åº¦ãªã©ã®é›†è¨ˆã‚’è¡Œã†ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 15, 
        "category": "éŸ³å£°ãƒ»ç”»åƒå‡¦ç†",
        "number": "15/100",
        "title": "éŸ³å£°ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ–‡å­—èµ·ã“ã—", 
        "desc": "éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒ†ã‚­ã‚¹ãƒˆåŒ–",
        "how_to": "éŸ³å£°èªè­˜APIã‚’ä½¿ã£ã¦éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚",
        "sample_code": "import speech_recognition as sr\nimport os\nfrom datetime import datetime\nimport wave\nimport contextlib\n\nprint('=== éŸ³å£°ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ–‡å­—èµ·ã“ã—ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰ ===')\nprint('éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚')\nprint('\\nğŸ¤ å¯¾å¿œå½¢å¼:')\nprint('â€¢ WAVã€MP3ã€M4Aã€FLACã€OGG')\nprint('â€¢ æ—¥æœ¬èªã€è‹±èªã€ãã®ä»–è¨€èª')\nprint('\\nâš ï¸ æ³¨æ„äº‹é …:')\nprint('â€¢ éŸ³å£°ã®å“è³ªãŒæ–‡å­—èµ·ã“ã—ç²¾åº¦ã«å½±éŸ¿ã—ã¾ã™')\nprint('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒå¿…è¦ã§ã™')\nprint('â€¢ é•·æ™‚é–“ã®éŸ³å£°ã¯åˆ†å‰²ã—ã¦å‡¦ç†ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™')\nprint('â€¢ å€‹äººæƒ…å ±ãŒå«ã¾ã‚Œã‚‹å ´åˆã¯æ³¨æ„ã—ã¦ãã ã•ã„')\n\ntry:\n    # ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°æƒ…å ±ï¼ˆå®Ÿéš›ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä»£ã‚ã‚Šï¼‰\n    print('\\nğŸ“‚ ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ã‚’å‡¦ç†ä¸­...')\n    \n    # ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ãƒ‡ãƒ¼ã‚¿\n    sample_audio_info = {\n        'filename': 'meeting_recording.wav',\n        'duration': 120,  # ç§’\n        'sample_rate': 16000,\n        'channels': 1,\n        'transcribed_text': '''\n        ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ä»Šæ—¥ã®ä¼šè­°ã®è­°é¡Œã«ã¤ã„ã¦è©±ã—åˆã„ã¾ã—ã‚‡ã†ã€‚\n        ã¾ãšã€æ–°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²æ—çŠ¶æ³ã«ã¤ã„ã¦å ±å‘Šã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚\n        ç”°ä¸­ã•ã‚“ã€ãŠé¡˜ã„ã—ã¾ã™ã€‚\n        \n        ã¯ã„ã€æ–°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦å ±å‘Šã„ãŸã—ã¾ã™ã€‚\n        ç¾åœ¨ã€é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºãŒ70%å®Œäº†ã—ã¦ãŠã‚Šã€\n        äºˆå®šé€šã‚Šæ¥æœˆæœ«ã®ãƒªãƒªãƒ¼ã‚¹ã«å‘ã‘ã¦é †èª¿ã«é€²ã‚“ã§ã„ã¾ã™ã€‚\n        ãŸã ã—ã€ã„ãã¤ã‹ã®èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚\n        \n        ä¸€ã¤ç›®ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ”¹å–„ãŒå¿…è¦ã§ã™ã€‚\n        äºŒã¤ç›®ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æœ€é©åŒ–ã§ã™ã€‚\n        ä¸‰ã¤ç›®ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½ã§ã™ã€‚\n        \n        ã“ã‚Œã‚‰ã®èª²é¡Œã«ã¤ã„ã¦ã€ã©ã®ã‚ˆã†ã«å¯¾å¿œã—ã¦ã„ãã‹\n        çš†ã•ã‚“ã®ã”æ„è¦‹ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚\n        '''\n    }\n    \n    def analyze_audio_file(audio_info):\n        \"\"\"éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’åˆ†æã™ã‚‹é–¢æ•°\"\"\"\n        \n        # éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æƒ…å ±ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ\n        file_size = audio_info['duration'] * audio_info['sample_rate'] * audio_info['channels'] * 2 / 1024 / 1024  # MB\n        \n        analysis = {\n            'ãƒ•ã‚¡ã‚¤ãƒ«å': audio_info['filename'],\n            'å†ç”Ÿæ™‚é–“': f\"{audio_info['duration'] // 60}åˆ†{audio_info['duration'] % 60}ç§’\",\n            'ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ': f\"{audio_info['sample_rate']}Hz\",\n            'ãƒãƒ£ãƒ³ãƒãƒ«æ•°': audio_info['channels'],\n            'æ¨å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º': f\"{file_size:.1f}MB\",\n            'å‡¦ç†æ—¥æ™‚': datetime.now().strftime('%Y-%m-%d %H:%M:%S')\n        }\n        \n        return analysis\n    \n    def transcribe_audio_segments(text, segment_duration=30):\n        \"\"\"éŸ³å£°ã‚’ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«åˆ†å‰²ã—ã¦æ–‡å­—èµ·ã“ã—ã™ã‚‹é–¢æ•°\"\"\"\n        \n        # ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«åˆ†å‰²ï¼ˆå®Ÿéš›ã®éŸ³å£°å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰\n        sentences = text.strip().split('ã€‚')\n        segments = []\n        current_segment = \"\"\n        \n        for sentence in sentences:\n            if sentence.strip():\n                if len(current_segment) + len(sentence) < 200:  # æ–‡å­—æ•°åˆ¶é™\n                    current_segment += sentence + \"ã€‚\"\n                else:\n                    if current_segment:\n                        segments.append(current_segment.strip())\n                    current_segment = sentence + \"ã€‚\"\n        \n        if current_segment:\n            segments.append(current_segment.strip())\n        \n        return segments\n    \n    # éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†æ\n    print('\\nğŸ” éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æä¸­...')\n    audio_analysis = analyze_audio_file(sample_audio_info)\n    \n    print('\\nğŸ“Š éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±:') \n    for key, value in audio_analysis.items():\n        print(f'â€¢ {key}: {value}')\n    \n    # æ–‡å­—èµ·ã“ã—å‡¦ç†\n    print('\\nğŸ¤ æ–‡å­—èµ·ã“ã—ã‚’å®Ÿè¡Œä¸­...')\n    \n    # ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å‰²\n    segments = transcribe_audio_segments(sample_audio_info['transcribed_text'])\n    \n    print(f'\\nğŸ“ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: {len(segments)}å€‹')\n    \n    # å„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®æ–‡å­—èµ·ã“ã—çµæœã‚’è¨˜éŒ²\n    transcription_results = []\n    total_words = 0\n    \n    for i, segment in enumerate(segments, 1):\n        print(f'\\nã‚»ã‚°ãƒ¡ãƒ³ãƒˆ {i}/{len(segments)}:')\n        print(f'å†…å®¹: {segment[:100]}{\"...\" if len(segment) > 100 else \"\"}')\n        \n        # æ–‡å­—æ•°ã¨å˜èªæ•°ã®è¨ˆç®—\n        char_count = len(segment)\n        word_count = len(segment.split())\n        total_words += word_count\n        \n        # ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰\n        confidence_score = 0.85 + (i * 0.02)  # ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã”ã¨ã«å°‘ã—ãšã¤å¤‰åŒ–\n        confidence_score = min(confidence_score, 0.98)\n        \n        result = {\n            'ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ': i,\n            'é–‹å§‹æ™‚é–“': f\"{(i-1)*30:02d}:00\",\n            'çµ‚äº†æ™‚é–“': f\"{i*30:02d}:00\",\n            'æ–‡å­—æ•°': char_count,\n            'å˜èªæ•°': word_count,\n            'ä¿¡é ¼åº¦': f\"{confidence_score:.1%}\",\n            'ãƒ†ã‚­ã‚¹ãƒˆ': segment\n        }\n        \n        transcription_results.append(result)\n        \n        print(f'âœ“ æ–‡å­—æ•°: {char_count}æ–‡å­—')\n        print(f'âœ“ å˜èªæ•°: {word_count}èª')\n        print(f'âœ“ ä¿¡é ¼åº¦: {confidence_score:.1%}')\n    \n    # å…¨ä½“ã®çµ±è¨ˆ\n    total_chars = sum(r['æ–‡å­—æ•°'] for r in transcription_results)\n    avg_confidence = sum(float(r['ä¿¡é ¼åº¦'].rstrip('%')) for r in transcription_results) / len(transcription_results)\n    \n    print(f'\\nâœ… æ–‡å­—èµ·ã“ã—å®Œäº†ï¼')\n    print(f'â€¢ ç·æ–‡å­—æ•°: {total_chars:,}æ–‡å­—')\n    print(f'â€¢ ç·å˜èªæ•°: {total_words:,}èª')\n    print(f'â€¢ å¹³å‡ä¿¡é ¼åº¦: {avg_confidence:.1%}')\n    print(f'â€¢ å‡¦ç†æ™‚é–“: ç´„{len(segments) * 5}ç§’ï¼ˆæ¨å®šï¼‰')\n    \n    # çµæœã®ä¿å­˜\n    print('\\nğŸ’¾ çµæœã‚’ä¿å­˜ä¸­...')\n    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\n    \n    # è©³ç´°çµæœã®ä¿å­˜\n    detailed_filename = f'transcription_detailed_{timestamp}.txt'\n    with open(detailed_filename, 'w', encoding='utf-8') as f:\n        f.write(f'éŸ³å£°æ–‡å­—èµ·ã“ã—çµæœ\\n')\n        f.write(f'ãƒ•ã‚¡ã‚¤ãƒ«: {sample_audio_info[\"filename\"]}\\n')\n        f.write(f'å‡¦ç†æ—¥æ™‚: {datetime.now().strftime(\"%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S\")}\\n')\n        f.write(f'ç·æ–‡å­—æ•°: {total_chars:,}æ–‡å­—\\n')\n        f.write(f'å¹³å‡ä¿¡é ¼åº¦: {avg_confidence:.1%}\\n')\n        f.write('\\n' + '='*50 + '\\n\\n')\n        \n        for result in transcription_results:\n            f.write(f'[ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ {result[\"ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ\"]}] {result[\"é–‹å§‹æ™‚é–“\"]}-{result[\"çµ‚äº†æ™‚é–“\"]}\\n')\n            f.write(f'ä¿¡é ¼åº¦: {result[\"ä¿¡é ¼åº¦\"]}\\n')\n            f.write(f'{result[\"ãƒ†ã‚­ã‚¹ãƒˆ\"]}\\n\\n')\n    \n    # ç°¡æ½”ç‰ˆã®ä¿å­˜\n    simple_filename = f'transcription_simple_{timestamp}.txt'\n    with open(simple_filename, 'w', encoding='utf-8') as f:\n        f.write('\\n'.join(r['ãƒ†ã‚­ã‚¹ãƒˆ'] for r in transcription_results))\n    \n    print(f'â€¢ è©³ç´°ç‰ˆ: {detailed_filename}')\n    print(f'â€¢ ç°¡æ½”ç‰ˆ: {simple_filename}')\n    \n    # å“è³ªè©•ä¾¡\n    print('\\nğŸ“ˆ å“è³ªè©•ä¾¡:') \n    if avg_confidence >= 0.9:\n        print('â€¢ ä¿¡é ¼åº¦: éå¸¸ã«é«˜ã„ï¼ˆ90%ä»¥ä¸Šï¼‰') \n    elif avg_confidence >= 0.8:\n        print('â€¢ ä¿¡é ¼åº¦: é«˜ã„ï¼ˆ80-90%ï¼‰') \n    elif avg_confidence >= 0.7:\n        print('â€¢ ä¿¡é ¼åº¦: æ™®é€šï¼ˆ70-80%ï¼‰') \n    else:\n        print('â€¢ ä¿¡é ¼åº¦: ä½ã„ï¼ˆ70%æœªæº€ï¼‰- æ‰‹å‹•ç¢ºèªã‚’æ¨å¥¨') \n    \n    print('\\nğŸ’¡ å®Ÿéš›ã®ä½¿ç”¨æ™‚ã®æ³¨æ„ç‚¹:')\n    print('â€¢ éŸ³å£°ã®å“è³ªãŒæ–‡å­—èµ·ã“ã—ç²¾åº¦ã«å½±éŸ¿ã—ã¾ã™')\n    print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒå¿…è¦ã§ã™')\n    print('â€¢ é•·æ™‚é–“ã®éŸ³å£°ã¯åˆ†å‰²ã—ã¦å‡¦ç†ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™')\n    print('â€¢ å€‹äººæƒ…å ±ãŒå«ã¾ã‚Œã‚‹å ´åˆã¯æ³¨æ„ã—ã¦ãã ã•ã„')\n    print('â€¢ çµæœã¯å¿…ãšç¢ºèªã—ã¦ã‹ã‚‰ä½¿ç”¨ã—ã¦ãã ã•ã„')\n    \nexcept Exception as e:\n    print(f'\\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}')\n    print('\\nğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:')\n    print('â€¢ SpeechRecognitionãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„')\n    print('â€¢ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒç ´æã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„')\n\nprint('\\n=== éŸ³å£°ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ–‡å­—èµ·ã“ã—å®Œäº† ===')",
        "libraries": "SpeechRecognitionã€pyaudio",
        "explanation": "ä¼šè­°ã®éŒ²éŸ³ã‚„ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼éŸ³å£°ã‚’è‡ªå‹•ã§ãƒ†ã‚­ã‚¹ãƒˆåŒ–ã™ã‚‹ã“ã¨ã§ã€è­°äº‹éŒ²ä½œæˆã®æ™‚é–“ã‚’å¤§å¹…ã«çŸ­ç¸®ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•å…¥åŠ›ãŒä¸è¦", "æ™‚é–“ã‚’å¤§å¹…ç¯€ç´„", "æ­£ç¢ºãªæ–‡å­—èµ·ã“ã—"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§éŸ³å£°ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ–‡å­—èµ·ã“ã—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. SpeechRecognitionãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWAVå½¢å¼ï¼‰ã‚’èª­ã¿è¾¼ã‚€\n3. Google Speech Recognitionã§æ–‡å­—èµ·ã“ã—ã™ã‚‹\n4. æ—¥æœ¬èªã«å¯¾å¿œã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWAVå½¢å¼ï¼‰\nè¨€èª: æ—¥æœ¬èª\nå‡ºåŠ›: ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§éŸ³å£°ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ–‡å­—èµ·ã“ã—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚SpeechRecognitionãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€Google Speech Recognitionã§æ—¥æœ¬èªã®æ–‡å­—èµ·ã“ã—ã‚’è¡Œã†ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 16, 
        "category": "éŸ³å£°ãƒ»ç”»åƒå‡¦ç†",
        "number": "16/100",
        "title": "ç”»åƒã‹ã‚‰æ–‡å­—æŠ½å‡º", 
        "desc": "ç”»åƒå†…ã®æ–‡å­—ã‚’è‡ªå‹•ã§æŠ½å‡º",
        "how_to": "OCRæŠ€è¡“ã‚’ä½¿ã£ã¦ç”»åƒå†…ã®æ–‡å­—ã‚’èªè­˜ã—ã€ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æŠ½å‡ºã—ã¾ã™ã€‚",
        "sample_code": "import pytesseract\nfrom PIL import Image\nimport cv2\nimport numpy as np\n\ndef extract_text_from_image(image_path):\n    # ç”»åƒã‚’èª­ã¿è¾¼ã¿\n    image = cv2.imread(image_path)\n    \n    # ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã«å¤‰æ›\n    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n    \n    # ãƒã‚¤ã‚ºé™¤å»\n    denoised = cv2.medianBlur(gray, 3)\n    \n    # äºŒå€¤åŒ–\n    _, binary = cv2.threshold(denoised, 0, 255, cv2.THRESH_BINARY + cv2.THRESH_OTSU)\n    \n    # OCRã§æ–‡å­—èªè­˜\n    text = pytesseract.image_to_string(binary, lang='jpn')\n    \n    return text.strip()\n\n# ä½¿ç”¨ä¾‹\nresult = extract_text_from_image('document_image.jpg')\nprint('æŠ½å‡ºã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ:')\nprint(result)\n\n# çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜\nwith open('extracted_text.txt', 'w', encoding='utf-8') as f:\n    f.write(result)\nprint('ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¾ã—ãŸ')",
        "libraries": "pytesseractã€opencv-pythonã€Pillow",
        "explanation": "ç”»åƒå†…ã®æ–‡å­—ã‚’è‡ªå‹•ã§æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã€æ‰‹å‹•å…¥åŠ›ã®æ‰‹é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•å…¥åŠ›ãŒä¸è¦", "å¤§é‡å‡¦ç†ãŒå¯èƒ½", "æ­£ç¢ºãªæ–‡å­—èªè­˜"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ç”»åƒã‹ã‚‰æ–‡å­—æŠ½å‡ºã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. pytesseractãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€\n3. å‰å‡¦ç†ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«åŒ–ã€ãƒã‚¤ã‚ºé™¤å»ï¼‰ã‚’è¡Œã†\n4. æ—¥æœ¬èªã®æ–‡å­—ã‚’èªè­˜ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ç”»åƒ: æ–‡å­—ãŒå«ã¾ã‚Œã‚‹ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«\nè¨€èª: æ—¥æœ¬èª\nå‡ºåŠ›: ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ç”»åƒã‹ã‚‰æ–‡å­—æŠ½å‡ºã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚pytesseractãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€å‰å‡¦ç†ã‚’è¡Œã£ã¦æ—¥æœ¬èªã®æ–‡å­—ã‚’èªè­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 17, 
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "17/100",
        "title": "ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—", 
        "desc": "é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—",
        "how_to": "æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚",
        "sample_code": "import shutil\nimport os\nfrom datetime import datetime\nimport schedule\nimport time\n\ndef backup_files(source_folder, backup_folder):\n    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆï¼ˆæ—¥ä»˜ä»˜ãï¼‰\n    today = datetime.now().strftime('%Y%m%d')\n    backup_path = os.path.join(backup_folder, f'backup_{today}')\n    \n    if not os.path.exists(backup_path):\n        os.makedirs(backup_path)\n    \n    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼\n    for item in os.listdir(source_folder):\n        source_item = os.path.join(source_folder, item)\n        backup_item = os.path.join(backup_path, item)\n        \n        if os.path.isfile(source_item):\n            shutil.copy2(source_item, backup_item)\n            print(f'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†: {item}')\n        elif os.path.isdir(source_item):\n            shutil.copytree(source_item, backup_item)\n            print(f'ãƒ•ã‚©ãƒ«ãƒ€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†: {item}')\n    \n    print(f'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†: {backup_path}')\n\n# æ¯æ—¥18æ™‚ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—\nschedule.every().day.at('18:00').do(\n    backup_files, \n    'C:/Users/YourName/Documents', \n    'C:/Users/YourName/Backups'\n)\n\n# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ\nwhile True:\n    schedule.run_pending()\n    time.sleep(60)",
        "libraries": "shutilã€osã€datetimeã€scheduleï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿æå¤±ã®ãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã§ãã¾ã™ã€‚",
        "benefits": ["ãƒ‡ãƒ¼ã‚¿ä¿è­·", "æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒä¸è¦", "å®šæœŸçš„ãªå®Ÿè¡Œ"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. shutilãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹\n3. æ—¥ä»˜ä»˜ãã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹\n4. æ¯æ—¥æŒ‡å®šã—ãŸæ™‚é–“ã«è‡ªå‹•å®Ÿè¡Œã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ãŸã„ãƒ•ã‚©ãƒ«ãƒ€\nãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å…ˆ: æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€\nå®Ÿè¡Œæ™‚é–“: æ¯æ—¥18æ™‚\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚shutilãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã€æ—¥ä»˜ä»˜ãã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã—ã¦æ¯æ—¥æŒ‡å®šã—ãŸæ™‚é–“ã«è‡ªå‹•å®Ÿè¡Œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 18, 
        "category": "æ–‡æ›¸ä½œæˆãƒ»ç®¡ç†",
        "number": "18/100",
        "title": "ä¼šè­°è­°äº‹éŒ²è‡ªå‹•ä½œæˆ", 
        "desc": "ä¼šè­°éŸ³å£°ã‹ã‚‰è­°äº‹éŒ²ã‚’è‡ªå‹•ä½œæˆ",
        "how_to": "éŸ³å£°èªè­˜ã¨AIã‚’ä½¿ã£ã¦ä¼šè­°ã®éŒ²éŸ³ã‹ã‚‰è­°äº‹éŒ²ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚",
        "sample_code": "import speech_recognition as sr\nfrom datetime import datetime\nimport re\n\ndef create_meeting_minutes(audio_file_path):\n    # éŸ³å£°èªè­˜\n    recognizer = sr.Recognizer()\n    \n    with sr.AudioFile(audio_file_path) as source:\n        audio = recognizer.record(source)\n        \n        try:\n            # æ–‡å­—èµ·ã“ã—\n            text = recognizer.recognize_google(audio, language='ja-JP')\n            \n            # è­°äº‹éŒ²ã®å½¢å¼ã«æ•´ç†\n            minutes = f'''\nä¼šè­°è­°äº‹éŒ²\n\næ—¥æ™‚: {datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M')}\nå‚åŠ è€…: [å‚åŠ è€…åã‚’è¨˜å…¥]\n\nã€è­°é¡Œã€‘\n[è­°é¡Œã‚’è¨˜å…¥]\n\nã€è­°äº‹å†…å®¹ã€‘\n{text}\n\nã€æ±ºå®šäº‹é …ã€‘\n[æ±ºå®šäº‹é …ã‚’è¨˜å…¥]\n\nã€æ¬¡å›äºˆå®šã€‘\n[æ¬¡å›äºˆå®šã‚’è¨˜å…¥]\n            '''\n            \n            return minutes\n            \n        except sr.UnknownValueError:\n            return 'éŸ³å£°ã‚’èªè­˜ã§ãã¾ã›ã‚“ã§ã—ãŸ'\n\n# ä½¿ç”¨ä¾‹\nminutes = create_meeting_minutes('meeting.wav')\nprint(minutes)\n\n# ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜\nwith open('meeting_minutes.txt', 'w', encoding='utf-8') as f:\n    f.write(minutes)\nprint('è­°äº‹éŒ²ã‚’ä¿å­˜ã—ã¾ã—ãŸ')",
        "libraries": "SpeechRecognitionã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ä¼šè­°ã®éŒ²éŸ³ã‹ã‚‰è‡ªå‹•ã§è­°äº‹éŒ²ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€æ‰‹å‹•ã§ã®è­°äº‹éŒ²ä½œæˆã®æ™‚é–“ã‚’å¤§å¹…ã«çŸ­ç¸®ã§ãã¾ã™ã€‚",
        "benefits": ["è­°äº‹éŒ²ä½œæˆãŒè‡ªå‹•åŒ–", "æ™‚é–“ã‚’å¤§å¹…ç¯€ç´„", "æ­£ç¢ºãªè¨˜éŒ²"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ä¼šè­°è­°äº‹éŒ²è‡ªå‹•ä½œæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. SpeechRecognitionãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. ä¼šè­°ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã™ã‚‹\n3. è­°äº‹éŒ²ã®å½¢å¼ã«æ•´ç†ã™ã‚‹ï¼ˆæ—¥æ™‚ã€å‚åŠ è€…ã€è­°é¡Œã€è­°äº‹å†…å®¹ã€æ±ºå®šäº‹é …ï¼‰\n4. ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: ä¼šè­°ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«\nå‡ºåŠ›å½¢å¼: è­°äº‹éŒ²ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\nå†…å®¹: æ—¥æ™‚ã€å‚åŠ è€…ã€è­°é¡Œã€è­°äº‹å†…å®¹ã€æ±ºå®šäº‹é …\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ä¼šè­°è­°äº‹éŒ²è‡ªå‹•ä½œæˆã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚SpeechRecognitionãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ä¼šè­°ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã—ã€è­°äº‹éŒ²ã®å½¢å¼ã«æ•´ç†ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 19, 
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "19/100",
        "title": "ç¿»è¨³è‡ªå‹•åŒ–", 
        "desc": "ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•ã§ç¿»è¨³",
        "how_to": "Google Translate APIã‚’ä½¿ã£ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•ç¿»è¨³ã—ã¾ã™ã€‚",
        "sample_code": "from googletrans import Translator\nimport pandas as pd\n\ndef translate_text(text, target_lang='en'):\n    translator = Translator()\n    \n    try:\n        # ç¿»è¨³å®Ÿè¡Œ\n        result = translator.translate(text, dest=target_lang)\n        return result.text\n    except Exception as e:\n        return f'ç¿»è¨³ã‚¨ãƒ©ãƒ¼: {e}'\n\ndef translate_file(input_file, output_file, target_lang='en'):\n    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿\n    with open(input_file, 'r', encoding='utf-8') as f:\n        content = f.read()\n    \n    # ç¿»è¨³\n    translated_content = translate_text(content, target_lang)\n    \n    # çµæœã‚’ä¿å­˜\n    with open(output_file, 'w', encoding='utf-8') as f:\n        f.write(translated_content)\n    \n    print(f'ç¿»è¨³å®Œäº†: {output_file}')\n\n# ä½¿ç”¨ä¾‹\n# å˜ä¸€ãƒ†ã‚­ã‚¹ãƒˆã®ç¿»è¨³\ntranslated = translate_text('ã“ã‚“ã«ã¡ã¯ã€ä¸–ç•Œ', 'en')\nprint(f'ç¿»è¨³çµæœ: {translated}')\n\n# ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¿»è¨³\ntranslate_file('japanese_text.txt', 'english_text.txt', 'en')",
        "libraries": "googletrans==4.0.0rc1ã€pandas",
        "explanation": "ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•ç¿»è¨³ã™ã‚‹ã“ã¨ã§ã€å¤šè¨€èªå¯¾å¿œã‚„å›½éš›çš„ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•ç¿»è¨³ãŒä¸è¦", "å¤šè¨€èªå¯¾å¿œ", "å¤§é‡ç¿»è¨³ãŒå¯èƒ½"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ç¿»è¨³è‡ªå‹•åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. googletransãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æ—¥æœ¬èªã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è‹±èªã«ç¿»è¨³ã™ã‚‹\n3. ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’ç¿»è¨³ã™ã‚‹æ©Ÿèƒ½ã‚‚å«ã‚ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡è¨€èª: æ—¥æœ¬èªâ†’è‹±èª\nå…¥åŠ›: ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\nå‡ºåŠ›: ç¿»è¨³ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ç¿»è¨³è‡ªå‹•åŒ–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚googletransãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æ—¥æœ¬èªã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è‹±èªã«ç¿»è¨³ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’ç¿»è¨³ã™ã‚‹æ©Ÿèƒ½ã‚‚å«ã‚ã¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚è¡Œã†ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 20, 
        "category": "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†",
        "number": "20/100",
        "title": "ã‚¿ã‚¹ã‚¯è‡ªå‹•ãƒªãƒã‚¤ãƒ³ãƒ‰", 
        "desc": "ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•ã§ãƒªãƒã‚¤ãƒ³ãƒ‰",
        "how_to": "scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã‚¿ã‚¹ã‚¯ã®æœŸé™ã‚’ç®¡ç†ã—ã€è‡ªå‹•ã§ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™ã€‚",
        "sample_code": "import schedule\nimport time\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom datetime import datetime\n\ntasks = [\n    {'title': 'ãƒ¬ãƒãƒ¼ãƒˆæå‡º', 'deadline': '2024-01-15', 'email': 'boss@company.com'},\n    {'title': 'ä¼šè­°æº–å‚™', 'deadline': '2024-01-16', 'email': 'team@company.com'}\n]\n\ndef send_reminder(task):\n    # ãƒ¡ãƒ¼ãƒ«è¨­å®š\n    sender_email = 'your_email@gmail.com'\n    sender_password = 'your_password'\n    \n    # ãƒ¡ãƒ¼ãƒ«ä½œæˆ\n    msg = MIMEText(f'ã‚¿ã‚¹ã‚¯ãƒªãƒã‚¤ãƒ³ãƒ‰: {task[\"title\"]}ã®æœŸé™ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™ã€‚')\n    msg['Subject'] = f'ã‚¿ã‚¹ã‚¯ãƒªãƒã‚¤ãƒ³ãƒ‰: {task[\"title\"]}'\n    msg['From'] = sender_email\n    msg['To'] = task['email']\n    \n    # é€ä¿¡\n    server = smtplib.SMTP('smtp.gmail.com', 587)\n    server.starttls()\n    server.login(sender_email, sender_password)\n    server.send_message(msg)\n    server.quit()\n    \n    print(f'ãƒªãƒã‚¤ãƒ³ãƒ‰é€ä¿¡: {task[\"title\"]}')\n\n# æ¯æ—¥9æ™‚ã«ãƒã‚§ãƒƒã‚¯\nschedule.every().day.at('09:00').do(lambda: [send_reminder(task) for task in tasks])\n\nwhile True:\n    schedule.run_pending()\n    time.sleep(60)",
        "libraries": "scheduleã€smtplibï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ã‚¿ã‚¹ã‚¯ã®æœŸé™ã‚’è‡ªå‹•ã§ç®¡ç†ã—ã€ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€ã‚¿ã‚¹ã‚¯ã®å¿˜ã‚Œã‚’é˜²ã’ã¾ã™ã€‚",
        "benefits": ["ã‚¿ã‚¹ã‚¯å¿˜ã‚Œã‚’é˜²ã", "è‡ªå‹•ãƒªãƒã‚¤ãƒ³ãƒ‰", "æ™‚é–“ç®¡ç†ãŒå‘ä¸Š"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ã‚¿ã‚¹ã‚¯è‡ªå‹•ãƒªãƒã‚¤ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§æ¯æ—¥9æ™‚ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n2. ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‹ã‚‰æœŸé™ãŒè¿‘ã„ã‚‚ã®ã‚’ç¢ºèªã™ã‚‹\n3. ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nãƒã‚§ãƒƒã‚¯æ™‚é–“: æ¯æ—¥9æ™‚\nãƒªãƒã‚¤ãƒ³ãƒ‰å†…å®¹: ã‚¿ã‚¹ã‚¯åã¨æœŸé™\né€ä¿¡å…ˆ: æŒ‡å®šã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ã‚¿ã‚¹ã‚¯è‡ªå‹•ãƒªãƒã‚¤ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§æ¯æ—¥9æ™‚ã«ãƒã‚§ãƒƒã‚¯ã—ã€ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‹ã‚‰æœŸé™ãŒè¿‘ã„ã‚‚ã®ã‚’ç¢ºèªã—ã¦ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚å«ã‚ã¦ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 21,
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "21/100",
        "title": "CSVãƒ‡ãƒ¼ã‚¿è‡ªå‹•å¤‰æ›", 
        "desc": "CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§å¤‰æ›ãƒ»æ•´å½¢",
        "how_to": "pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ãƒ»æ•´å½¢ã—ã¾ã™ã€‚",
        "sample_code": "import pandas as pd\nimport numpy as np\n\n# CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿\ndf = pd.read_csv('input_data.csv')\n\n# ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†\n# æ¬ æå€¤ã‚’å‡¦ç†\ndf = df.fillna(0)\n\n# æ—¥ä»˜åˆ—ã‚’å¤‰æ›\ndf['æ—¥ä»˜'] = pd.to_datetime(df['æ—¥ä»˜'])\n\n# æ•°å€¤åˆ—ã®è¨ˆç®—\ndf['åˆè¨ˆ'] = df['å£²ä¸Š'] + df['æ‰‹æ•°æ–™']\n\n# ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã³æ›¿ãˆ\ndf = df.sort_values('æ—¥ä»˜', ascending=False)\n\n# çµæœã‚’ä¿å­˜\ndf.to_csv('processed_data.csv', index=False, encoding='utf-8')\nprint('ãƒ‡ãƒ¼ã‚¿å¤‰æ›å®Œäº†ï¼')\nprint(f'å‡¦ç†ä»¶æ•°: {len(df)}ä»¶')",
        "libraries": "pandasã€numpy",
        "explanation": "CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã§å¤‰æ›ãƒ»æ•´å½¢ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã®æº–å‚™ä½œæ¥­ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹ä½œæ¥­ãŒä¸è¦", "å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚‚ç¬æ™‚å‡¦ç†", "ãƒ‡ãƒ¼ã‚¿å“è³ªãŒå‘ä¸Š"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§CSVãƒ‡ãƒ¼ã‚¿è‡ªå‹•å¤‰æ›ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§å‰å‡¦ç†ã™ã‚‹\n3. æ¬ æå€¤ã®å‡¦ç†ã€æ—¥ä»˜å¤‰æ›ã€è¨ˆç®—ã‚’è¡Œã†\n4. çµæœã‚’æ–°ã—ã„CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«: input_data.csv\nå‡¦ç†å†…å®¹: æ¬ æå€¤å‡¦ç†ã€æ—¥ä»˜å¤‰æ›ã€è¨ˆç®—\nå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: processed_data.csv\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§CSVãƒ‡ãƒ¼ã‚¿è‡ªå‹•å¤‰æ›ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€æ¬ æå€¤ã®å‡¦ç†ã€æ—¥ä»˜å¤‰æ›ã€è¨ˆç®—ã‚’è¡Œã£ã¦çµæœã‚’æ–°ã—ã„CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 22,
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "22/100",
        "title": "ç”»åƒè‡ªå‹•åˆ†é¡", 
        "desc": "ç”»åƒã‚’è‡ªå‹•ã§åˆ†é¡ãƒ»æ•´ç†",
        "how_to": "æ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ã£ã¦ç”»åƒã‚’è‡ªå‹•ã§åˆ†é¡ã—ã€é©åˆ‡ãªãƒ•ã‚©ãƒ«ãƒ€ã«æ•´ç†ã—ã¾ã™ã€‚",
        "sample_code": "import os\nimport shutil\nfrom PIL import Image\nimport numpy as np\nfrom sklearn.cluster import KMeans\n\ndef classify_images_by_color(image_folder, output_folder):\n    # ç”»åƒã‚’è‰²ã§åˆ†é¡\n    for filename in os.listdir(image_folder):\n        if filename.lower().endswith(('.png', '.jpg', '.jpeg')):\n            image_path = os.path.join(image_folder, filename)\n            \n            # ç”»åƒã‚’èª­ã¿è¾¼ã¿\n            img = Image.open(image_path)\n            img_array = np.array(img)\n            \n            # å¹³å‡è‰²ã‚’è¨ˆç®—\n            avg_color = img_array.mean(axis=(0, 1))\n            \n            # è‰²ã§åˆ†é¡ï¼ˆä¾‹ï¼šæ˜ã‚‹ã„/æš—ã„ï¼‰\n            brightness = avg_color.mean()\n            \n            if brightness > 128:\n                category = 'æ˜ã‚‹ã„ç”»åƒ'\n            else:\n                category = 'æš—ã„ç”»åƒ'\n            \n            # ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ\n            category_folder = os.path.join(output_folder, category)\n            if not os.path.exists(category_folder):\n                os.makedirs(category_folder)\n            \n            # ç”»åƒã‚’ç§»å‹•\n            shutil.copy2(image_path, os.path.join(category_folder, filename))\n            print(f'{filename} â†’ {category}')\n\n# ä½¿ç”¨ä¾‹\nclassify_images_by_color('input_images', 'classified_images')\nprint('ç”»åƒåˆ†é¡å®Œäº†ï¼')",
        "libraries": "Pillowã€numpyã€scikit-learnã€osã€shutilï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ç”»åƒã‚’è‡ªå‹•ã§åˆ†é¡ã™ã‚‹ã“ã¨ã§ã€å¤§é‡ã®ç”»åƒã‚’åŠ¹ç‡çš„ã«æ•´ç†ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•åˆ†é¡ãŒä¸è¦", "å¤§é‡ç”»åƒã‚‚ä¸€æ‹¬å‡¦ç†", "æ•´ç†ãŒè‡ªå‹•åŒ–"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ç”»åƒè‡ªå‹•åˆ†é¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. Pillowã¨numpyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. ç”»åƒã®è‰²ã‚„æ˜åº¦ã§åˆ†é¡ã™ã‚‹\n3. åˆ†é¡çµæœã«å¿œã˜ã¦ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã™ã‚‹\n4. ç”»åƒã‚’é©åˆ‡ãªãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ç”»åƒ: æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒ\nåˆ†é¡åŸºæº–: æ˜åº¦ï¼ˆæ˜ã‚‹ã„/æš—ã„ï¼‰\nå‡ºåŠ›: åˆ†é¡ã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ç”»åƒè‡ªå‹•åˆ†é¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚Pillowã¨numpyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ç”»åƒã®è‰²ã‚„æ˜åº¦ã§åˆ†é¡ã—ã€åˆ†é¡çµæœã«å¿œã˜ã¦ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦ç”»åƒã‚’é©åˆ‡ãªãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 23,
        "category": "ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»åˆ†æ",
        "number": "23/100",
        "title": "Webã‚µã‚¤ãƒˆç›£è¦–", 
        "desc": "Webã‚µã‚¤ãƒˆã®å¤‰æ›´ã‚’è‡ªå‹•ã§ç›£è¦–",
        "how_to": "requestsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Webã‚µã‚¤ãƒˆã®å¤‰æ›´ã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã€å¤‰æ›´ãŒã‚ã‚Œã°é€šçŸ¥ã—ã¾ã™ã€‚",
        "sample_code": "import requests\nimport hashlib\nimport time\nimport smtplib\nfrom email.mime.text import MIMEText\n\ndef monitor_website(url, check_interval=3600):\n    # åˆæœŸçŠ¶æ…‹ã‚’å–å¾—\n    response = requests.get(url)\n    initial_hash = hashlib.md5(response.content).hexdigest()\n    \n    print(f'ç›£è¦–é–‹å§‹: {url}')\n    print(f'åˆæœŸãƒãƒƒã‚·ãƒ¥: {initial_hash}')\n    \n    while True:\n        try:\n            # ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—\n            response = requests.get(url)\n            current_hash = hashlib.md5(response.content).hexdigest()\n            \n            # å¤‰æ›´ã‚’ãƒã‚§ãƒƒã‚¯\n            if current_hash != initial_hash:\n                # å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã€ãƒ¡ãƒ¼ãƒ«é€šçŸ¥\n                send_notification(url, 'Webã‚µã‚¤ãƒˆã«å¤‰æ›´ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ')\n                print(f'å¤‰æ›´æ¤œå‡º: {url}')\n                break\n            else:\n                print(f'å¤‰æ›´ãªã—: {time.strftime(\"%Y-%m-%d %H:%M:%S\")}')\n            \n            # æŒ‡å®šæ™‚é–“å¾…æ©Ÿ\n            time.sleep(check_interval)\n            \n        except Exception as e:\n            print(f'ã‚¨ãƒ©ãƒ¼: {e}')\n            time.sleep(60)\n\ndef send_notification(url, message):\n    # ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã®å®Ÿè£…\n    print(f'é€šçŸ¥: {message} - {url}')\n\n# ä½¿ç”¨ä¾‹\nmonitor_website('https://example.com', 1800)  # 30åˆ†ã”ã¨ã«ãƒã‚§ãƒƒã‚¯",
        "libraries": "requestsã€hashlibã€timeã€smtplibï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "Webã‚µã‚¤ãƒˆã®å¤‰æ›´ã‚’è‡ªå‹•ã§ç›£è¦–ã™ã‚‹ã“ã¨ã§ã€ç«¶åˆã‚µã‚¤ãƒˆã®å‹•å‘ã‚„ä¾¡æ ¼å¤‰æ›´ã‚’ç´ æ—©ãæŠŠæ¡ã§ãã¾ã™ã€‚",
        "benefits": ["24æ™‚é–“ç›£è¦–", "å¤‰æ›´ã‚’å³åº§ã«æ¤œå‡º", "æ‰‹å‹•ãƒã‚§ãƒƒã‚¯ãŒä¸è¦"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§Webã‚µã‚¤ãƒˆç›£è¦–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. requestsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸWebã‚µã‚¤ãƒˆã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n3. å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã«é€šçŸ¥ã™ã‚‹\n4. ãƒãƒƒã‚·ãƒ¥å€¤ã§å¤‰æ›´ã‚’æ¤œå‡ºã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nç›£è¦–å¯¾è±¡: æŒ‡å®šã—ãŸWebã‚µã‚¤ãƒˆURL\nãƒã‚§ãƒƒã‚¯é–“éš”: 30åˆ†\né€šçŸ¥æ–¹æ³•: ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§Webã‚µã‚¤ãƒˆç›£è¦–ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚requestsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸWebã‚µã‚¤ãƒˆã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã€ãƒãƒƒã‚·ãƒ¥å€¤ã§å¤‰æ›´ã‚’æ¤œå‡ºã—ã¦å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã«é€šçŸ¥ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 24,
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "24/100",
        "title": "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—", 
        "desc": "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è‡ªå‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—",
        "how_to": "SQLiteã‚„MySQLã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®šæœŸçš„ã«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚",
        "sample_code": "import sqlite3\nimport shutil\nimport os\nfrom datetime import datetime\nimport schedule\nimport time\n\ndef backup_sqlite_database(db_path, backup_folder):\n    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆæ—¥æ™‚ä»˜ãï¼‰\n    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\n    backup_filename = f'backup_{timestamp}.db'\n    backup_path = os.path.join(backup_folder, backup_filename)\n    \n    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ\n    if not os.path.exists(backup_folder):\n        os.makedirs(backup_folder)\n    \n    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚³ãƒ”ãƒ¼\n    shutil.copy2(db_path, backup_path)\n    \n    print(f'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†: {backup_path}')\n    \n    # å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰\n    cleanup_old_backups(backup_folder, days=30)\n\ndef cleanup_old_backups(backup_folder, days=30):\n    current_time = datetime.now()\n    \n    for filename in os.listdir(backup_folder):\n        if filename.startswith('backup_') and filename.endswith('.db'):\n            file_path = os.path.join(backup_folder, filename)\n            file_time = datetime.fromtimestamp(os.path.getctime(file_path))\n            \n            if (current_time - file_time).days > days:\n                os.remove(file_path)\n                print(f'å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤: {filename}')\n\n# æ¯æ—¥æ·±å¤œ2æ™‚ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—\nschedule.every().day.at('02:00').do(\n    backup_sqlite_database, \n    'database.db', \n    'backups'\n)\n\n# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ\nwhile True:\n    schedule.run_pending()\n    time.sleep(60)",
        "libraries": "sqlite3ã€shutilã€osã€datetimeã€scheduleï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è‡ªå‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿æå¤±ã®ãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã—ã€å¾©æ—§ã‚’å®¹æ˜“ã«ã—ã¾ã™ã€‚",
        "benefits": ["ãƒ‡ãƒ¼ã‚¿ä¿è­·", "è‡ªå‹•å®Ÿè¡Œ", "å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®è‡ªå‹•å‰Šé™¤"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. sqlite3ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹\n3. æ—¥æ™‚ä»˜ãã®ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã™ã‚‹\n4. å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è‡ªå‹•å‰Šé™¤ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: SQLiteãƒ•ã‚¡ã‚¤ãƒ«\nãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é–“éš”: æ¯æ—¥æ·±å¤œ2æ™‚\nä¿æŒæœŸé–“: 30æ—¥\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚sqlite3ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã€æ—¥æ™‚ä»˜ãã®ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã—ã¦å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è‡ªå‹•å‰Šé™¤ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 25,
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "25/100",
        "title": "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•åˆ†æ", 
        "desc": "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§åˆ†æãƒ»é›†è¨ˆ",
        "how_to": "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ã‚¨ãƒ©ãƒ¼ã‚„ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è‡ªå‹•ã§åˆ†æã—ã¾ã™ã€‚",
        "sample_code": "import re\nfrom collections import Counter\nfrom datetime import datetime\nimport pandas as pd\n\ndef analyze_log_file(log_file_path):\n    # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿\n    with open(log_file_path, 'r', encoding='utf-8') as f:\n        lines = f.readlines()\n    \n    # åˆ†æçµæœã‚’æ ¼ç´\n    analysis = {\n        'total_lines': len(lines),\n        'errors': [],\n        'access_patterns': [],\n        'ip_addresses': []\n    }\n    \n    # å„è¡Œã‚’åˆ†æ\n    for line in lines:\n        # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’æ¤œå‡º\n        if 'ERROR' in line or 'error' in line.lower():\n            analysis['errors'].append(line.strip())\n        \n        # IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡º\n        ip_pattern = r'\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b'\n        ips = re.findall(ip_pattern, line)\n        analysis['ip_addresses'].extend(ips)\n        \n        # ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡º\n        if 'GET' in line or 'POST' in line:\n            analysis['access_patterns'].append(line.strip())\n    \n    # çµ±è¨ˆã‚’è¨ˆç®—\n    error_count = len(analysis['errors'])\n    unique_ips = len(set(analysis['ip_addresses']))\n    \n    # çµæœã‚’è¡¨ç¤º\n    print(f'=== ãƒ­ã‚°åˆ†æçµæœ ===')\n    print(f'ç·è¡Œæ•°: {analysis[\"total_lines\"]:,}è¡Œ')\n    print(f'ã‚¨ãƒ©ãƒ¼æ•°: {error_count}ä»¶')\n    print(f'ãƒ¦ãƒ‹ãƒ¼ã‚¯IPæ•°: {unique_ips}ä»¶')\n    print(f'ã‚¢ã‚¯ã‚»ã‚¹æ•°: {len(analysis[\"access_patterns\"])}ä»¶')\n    \n    # çµæœã‚’CSVã«ä¿å­˜\n    results_df = pd.DataFrame({\n        'é …ç›®': ['ç·è¡Œæ•°', 'ã‚¨ãƒ©ãƒ¼æ•°', 'ãƒ¦ãƒ‹ãƒ¼ã‚¯IPæ•°', 'ã‚¢ã‚¯ã‚»ã‚¹æ•°'],\n        'æ•°å€¤': [analysis['total_lines'], error_count, unique_ips, len(analysis['access_patterns'])]\n    })\n    results_df.to_csv('log_analysis.csv', index=False, encoding='utf-8')\n    \n    print('åˆ†æçµæœã‚’log_analysis.csvã«ä¿å­˜ã—ã¾ã—ãŸ')\n\n# ä½¿ç”¨ä¾‹\nanalyze_log_file('application.log')",
        "libraries": "reã€collectionsã€datetimeã€pandasï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§åˆ†æã™ã‚‹ã“ã¨ã§ã€ã‚·ã‚¹ãƒ†ãƒ ã®å•é¡Œã‚„ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç´ æ—©ãæŠŠæ¡ã§ãã¾ã™ã€‚",
        "benefits": ["æ‰‹å‹•åˆ†æãŒä¸è¦", "å•é¡Œã®æ—©æœŸç™ºè¦‹", "çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ä½œæˆ"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•åˆ†æã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆreã€collectionsï¼‰ã‚’ä½¿ã†\n2. ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§åˆ†æã™ã‚‹\n3. ã‚¨ãƒ©ãƒ¼æ•°ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é›†è¨ˆã™ã‚‹\n4. çµæœã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«\nåˆ†æé …ç›®: ã‚¨ãƒ©ãƒ¼æ•°ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³\nå‡ºåŠ›: CSVãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•åˆ†æã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆreã€collectionsï¼‰ã‚’ä½¿ã£ã¦ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ã‚¨ãƒ©ãƒ¼æ•°ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é›†è¨ˆã—ã¦çµæœã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 26,
        "category": "ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "number": "26/100",
        "title": "ãƒ¡ãƒ¼ãƒ«è‡ªå‹•æŒ¯ã‚Šåˆ†ã‘", 
        "desc": "å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•ã§æŒ¯ã‚Šåˆ†ã‘",
        "how_to": "imaplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•ã§åˆ†é¡ãƒ»æŒ¯ã‚Šåˆ†ã‘ã—ã¾ã™ã€‚",
        "sample_code": "import imaplib\nimport email\nimport re\nfrom email.header import decode_header\n\ndef auto_sort_emails(email_address, password):\n    # ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶š\n    mail = imaplib.IMAP4_SSL('imap.gmail.com')\n    mail.login(email_address, password)\n    mail.select('INBOX')\n    \n    # æœªèª­ãƒ¡ãƒ¼ãƒ«ã‚’æ¤œç´¢\n    _, messages = mail.search(None, 'UNSEEN')\n    \n    for num in messages[0].split():\n        # ãƒ¡ãƒ¼ãƒ«ã‚’å–å¾—\n        _, msg_data = mail.fetch(num, '(RFC822)')\n        email_body = msg_data[0][1]\n        email_message = email.message_from_bytes(email_body)\n        \n        # ä»¶åã¨é€ä¿¡è€…ã‚’å–å¾—\n        subject = decode_header(email_message['subject'])[0][0]\n        if isinstance(subject, bytes):\n            subject = subject.decode()\n        \n        sender = email_message['from']\n        \n        # æŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«\n        if 'è«‹æ±‚æ›¸' in subject or 'invoice' in subject.lower():\n            folder = 'è«‹æ±‚æ›¸'\n        elif 'ä¼šè­°' in subject or 'meeting' in subject.lower():\n            folder = 'ä¼šè­°'\n        elif 'å ±å‘Š' in subject or 'report' in subject.lower():\n            folder = 'å ±å‘Šæ›¸'\n        else:\n            folder = 'ãã®ä»–'\n        \n        print(f'ä»¶å: {subject}')\n        print(f'é€ä¿¡è€…: {sender}')\n        print(f'æŒ¯ã‚Šåˆ†ã‘å…ˆ: {folder}')\n        print('---')\n        \n        # å®Ÿéš›ã®æŒ¯ã‚Šåˆ†ã‘å‡¦ç†ï¼ˆãƒ•ã‚©ãƒ«ãƒ€ä½œæˆã¨ç§»å‹•ï¼‰\n        # mail.create(folder)  # ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ\n        # mail.copy(num, folder)  # ãƒ¡ãƒ¼ãƒ«ç§»å‹•\n    \n    mail.close()\n    mail.logout()\n\n# ä½¿ç”¨ä¾‹\n# auto_sort_emails('your_email@gmail.com', 'your_password')",
        "libraries": "imaplibã€emailã€reï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã‚’è‡ªå‹•ã§æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ã§ã€ãƒ¡ãƒ¼ãƒ«ç®¡ç†ã‚’åŠ¹ç‡åŒ–ã—ã€é‡è¦ãªãƒ¡ãƒ¼ãƒ«ã‚’è¦‹é€ƒã™ã“ã¨ã‚’é˜²ã’ã¾ã™ã€‚",
        "benefits": ["ãƒ¡ãƒ¼ãƒ«ç®¡ç†ãŒè‡ªå‹•åŒ–", "é‡è¦ãªãƒ¡ãƒ¼ãƒ«ã‚’è¦‹é€ƒã•ãªã„", "ä½œæ¥­åŠ¹ç‡ãŒå‘ä¸Š"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§ãƒ¡ãƒ¼ãƒ«è‡ªå‹•æŒ¯ã‚Šåˆ†ã‘ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. imaplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. Gmailã®IMAPã«æ¥ç¶šã™ã‚‹\n3. æœªèª­ãƒ¡ãƒ¼ãƒ«ã‚’æ¤œç´¢ã™ã‚‹\n4. ä»¶åã‚„é€ä¿¡è€…ã§æŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ¡ãƒ¼ãƒ«: Gmailã®æœªèª­ãƒ¡ãƒ¼ãƒ«\næŒ¯ã‚Šåˆ†ã‘åŸºæº–: ä»¶åã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰\næŒ¯ã‚Šåˆ†ã‘å…ˆ: è«‹æ±‚æ›¸ã€ä¼šè­°ã€å ±å‘Šæ›¸ã€ãã®ä»–\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ¡ãƒ¼ãƒ«è‡ªå‹•æŒ¯ã‚Šåˆ†ã‘ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚imaplibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Gmailã®IMAPã«æ¥ç¶šã—ã€æœªèª­ãƒ¡ãƒ¼ãƒ«ã‚’æ¤œç´¢ã—ã¦ä»¶åã‚„é€ä¿¡è€…ã§æŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 27,
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "27/100",
        "title": "ãƒ•ã‚¡ã‚¤ãƒ«é‡è¤‡ãƒã‚§ãƒƒã‚¯", 
        "desc": "é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§æ¤œå‡ºãƒ»å‰Šé™¤",
        "how_to": "ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ¯”è¼ƒã—ã¦é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã—ã€è‡ªå‹•ã§å‰Šé™¤ã—ã¾ã™ã€‚",
        "sample_code": "import os\nimport hashlib\nfrom collections import defaultdict\n\ndef find_duplicate_files(folder_path):\n    # ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ ¼ç´\n    hash_dict = defaultdict(list)\n    \n    # ãƒ•ã‚©ãƒ«ãƒ€å†…ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³\n    for root, dirs, files in os.walk(folder_path):\n        for filename in files:\n            file_path = os.path.join(root, filename)\n            \n            try:\n                # ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¨ˆç®—\n                with open(file_path, 'rb') as f:\n                    file_hash = hashlib.md5(f.read()).hexdigest()\n                    hash_dict[file_hash].append(file_path)\n            except Exception as e:\n                print(f'ã‚¨ãƒ©ãƒ¼: {file_path} - {e}')\n    \n    # é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡º\n    duplicates = []\n    for file_hash, file_paths in hash_dict.items():\n        if len(file_paths) > 1:\n            duplicates.append({\n                'hash': file_hash,\n                'files': file_paths,\n                'size': os.path.getsize(file_paths[0])\n            })\n    \n    return duplicates\ndef remove_duplicates(duplicates, keep_oldest=True):\n    total_saved = 0\n    \n    for duplicate in duplicates:\n        files = duplicate['files']\n        \n        if keep_oldest:\n            # æœ€ã‚‚å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã™\n            files.sort(key=lambda x: os.path.getctime(x))\n            files_to_remove = files[1:]\n        else:\n            # æœ€ã‚‚æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã™\n            files.sort(key=lambda x: os.path.getctime(x), reverse=True)\n            files_to_remove = files[1:]\n        \n        # é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤\n        for file_path in files_to_remove:\n            try:\n                os.remove(file_path)\n                total_saved += duplicate['size']\n                print(f'å‰Šé™¤: {file_path}')\n            except Exception as e:\n                print(f'å‰Šé™¤ã‚¨ãƒ©ãƒ¼: {file_path} - {e}')\n    \n    return total_saved\n\n# ä½¿ç”¨ä¾‹\nduplicates = find_duplicate_files('C:/Users/YourName/Documents')\nprint(f'é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(duplicates)}ä»¶')\n\nif duplicates:\n    saved_space = remove_duplicates(duplicates)\n    print(f'ç¯€ç´„ã—ãŸå®¹é‡: {saved_space / (1024*1024):.2f} MB')",
        "libraries": "osã€hashlibã€collectionsï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã§æ¤œå‡ºãƒ»å‰Šé™¤ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ç¯€ç´„ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ç¯€ç´„", "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãŒæ•´ç†", "æ‰‹å‹•å‰Šé™¤ãŒä¸è¦"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ•ã‚¡ã‚¤ãƒ«é‡è¤‡ãƒã‚§ãƒƒã‚¯ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. hashlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹\n3. ãƒãƒƒã‚·ãƒ¥å€¤ã§é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã™ã‚‹\n4. é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ï¼ˆå¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã™ï¼‰\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€: æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€\næ¤œå‡ºæ–¹æ³•: MD5ãƒãƒƒã‚·ãƒ¥å€¤æ¯”è¼ƒ\nå‰Šé™¤æ–¹æ³•: å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã—ã¦æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ•ã‚¡ã‚¤ãƒ«é‡è¤‡ãƒã‚§ãƒƒã‚¯ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚hashlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ãƒãƒƒã‚·ãƒ¥å€¤ã§é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã—ã¦é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 28,
        "category": "ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†",
        "number": "28/100",
        "title": "ç”»åƒè‡ªå‹•ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯", 
        "desc": "ç”»åƒã«è‡ªå‹•ã§ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ",
        "how_to": "PILãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ç”»åƒã«è‡ªå‹•ã§ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ï¼ˆé€ã‹ã—ï¼‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚",
        "sample_code": "from PIL import Image, ImageDraw, ImageFont\nimport os\n\ndef add_watermark(image_path, watermark_text, output_path=None):\n    # ç”»åƒã‚’é–‹ã\n    with Image.open(image_path) as img:\n        # ç”»åƒã®ã‚µã‚¤ã‚ºã‚’å–å¾—\n        width, height = img.size\n        \n        # é€ã‹ã—ç”¨ã®ç”»åƒã‚’ä½œæˆ\n        watermark = Image.new('RGBA', img.size, (0, 0, 0, 0))\n        draw = ImageDraw.Draw(watermark)\n        \n        # ãƒ•ã‚©ãƒ³ãƒˆã‚’è¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ç”¨ï¼‰\n        try:\n            font = ImageFont.truetype('arial.ttf', 36)\n        except:\n            font = ImageFont.load_default()\n        \n        # ãƒ†ã‚­ã‚¹ãƒˆã®ã‚µã‚¤ã‚ºã‚’å–å¾—\n        bbox = draw.textbbox((0, 0), watermark_text, font=font)\n        text_width = bbox[2] - bbox[0]\n        text_height = bbox[3] - bbox[1]\n        \n        # ãƒ†ã‚­ã‚¹ãƒˆã®ä½ç½®ã‚’è¨ˆç®—ï¼ˆå³ä¸‹ã«é…ç½®ï¼‰\n        x = width - text_width - 20\n        y = height - text_height - 20\n        \n        # é€ã‹ã—ã‚’æç”»\n        draw.text((x, y), watermark_text, font=font, fill=(255, 255, 255, 128))\n        \n        # å…ƒç”»åƒã¨é€ã‹ã—ã‚’åˆæˆ\n        result = Image.alpha_composite(img.convert('RGBA'), watermark)\n        \n        # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ±ºå®š\n        if output_path is None:\n            name, ext = os.path.splitext(image_path)\n            output_path = f'{name}_watermarked{ext}'\n        \n        # ä¿å­˜\n        result.save(output_path)\n        print(f'ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯è¿½åŠ å®Œäº†: {output_path}')\n\ndef batch_add_watermark(folder_path, watermark_text):\n    # ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒã«ä¸€æ‹¬ã§ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã‚’è¿½åŠ \n    image_extensions = ['.jpg', '.jpeg', '.png', '.bmp']\n    \n    for filename in os.listdir(folder_path):\n        if any(filename.lower().endswith(ext) for ext in image_extensions):\n            image_path = os.path.join(folder_path, filename)\n            add_watermark(image_path, watermark_text)\n\n# ä½¿ç”¨ä¾‹\n# å˜ä¸€ç”»åƒ\nadd_watermark('photo.jpg', 'Â© 2024 Company Name')\n\n# ä¸€æ‹¬å‡¦ç†\n# batch_add_watermark('photos_folder', 'Â© 2024 Company Name')",
        "libraries": "Pillow (PIL)ã€osï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ç”»åƒã«è‡ªå‹•ã§ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€è‘—ä½œæ¨©ä¿è­·ã‚„ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚",
        "benefits": ["è‘—ä½œæ¨©ä¿è­·", "ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°", "ä¸€æ‹¬å‡¦ç†ãŒå¯èƒ½"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ç”»åƒè‡ªå‹•ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. ç”»åƒã«ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ã™ã‚‹\n3. å³ä¸‹ã«åŠé€æ˜ã§è¡¨ç¤ºã™ã‚‹\n4. ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒã«ä¸€æ‹¬ã§é©ç”¨ã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ç”»åƒ: JPGã€PNGã€BMPãƒ•ã‚¡ã‚¤ãƒ«\nã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯: æŒ‡å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆ\nä½ç½®: å³ä¸‹ã€åŠé€æ˜\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ç”»åƒè‡ªå‹•ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ç”»åƒã«ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ã—ã€å³ä¸‹ã«åŠé€æ˜ã§è¡¨ç¤ºã—ã¦ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒã«ä¸€æ‹¬ã§é©ç”¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 29,
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "29/100",
        "title": "ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ¤œè¨¼", 
        "desc": "ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’è‡ªå‹•ã§ãƒã‚§ãƒƒã‚¯",
        "how_to": "pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’è‡ªå‹•ã§ãƒã‚§ãƒƒã‚¯ã—ã€ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã—ã¾ã™ã€‚",
        "sample_code": "import pandas as pd\nimport numpy as np\nfrom datetime import datetime\n\ndef validate_data(data_file):\n    # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿\n    df = pd.read_csv(data_file)\n    \n    # æ¤œè¨¼çµæœã‚’æ ¼ç´\n    validation_results = {\n        'total_rows': len(df),\n        'errors': [],\n        'warnings': []\n    }\n    \n    # 1. æ¬ æå€¤ãƒã‚§ãƒƒã‚¯\n    missing_data = df.isnull().sum()\n    for column, missing_count in missing_data.items():\n        if missing_count > 0:\n            validation_results['warnings'].append(\n                f'åˆ—ã€Œ{column}ã€ã«{missing_count}ä»¶ã®æ¬ æå€¤ãŒã‚ã‚Šã¾ã™'\n            )\n    \n    # 2. ãƒ‡ãƒ¼ã‚¿å‹ãƒã‚§ãƒƒã‚¯\n    for column in df.columns:\n        if 'æ—¥ä»˜' in column or 'date' in column.lower():\n            try:\n                pd.to_datetime(df[column])\n            except:\n                validation_results['errors'].append(\n                    f'åˆ—ã€Œ{column}ã€ã®æ—¥ä»˜å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“'\n                )\n        \n        if 'é‡‘é¡' in column or 'price' in column.lower():\n            if not pd.api.types.is_numeric_dtype(df[column]):\n                validation_results['errors'].append(\n                    f'åˆ—ã€Œ{column}ã€ãŒæ•°å€¤å½¢å¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“'\n                )\n    \n    # 3. ç¯„å›²ãƒã‚§ãƒƒã‚¯\n    if 'å¹´é½¢' in df.columns:\n        age_errors = df[(df['å¹´é½¢'] < 0) | (df['å¹´é½¢'] > 120)]\n        if len(age_errors) > 0:\n            validation_results['errors'].append(\n                f'å¹´é½¢ã«ä¸æ­£ãªå€¤ãŒ{len(age_errors)}ä»¶ã‚ã‚Šã¾ã™'\n            )\n    \n    # 4. é‡è¤‡ãƒã‚§ãƒƒã‚¯\n    duplicates = df.duplicated().sum()\n    if duplicates > 0:\n        validation_results['warnings'].append(\n            f'é‡è¤‡ãƒ‡ãƒ¼ã‚¿ãŒ{duplicates}ä»¶ã‚ã‚Šã¾ã™'\n        )\n    \n    # çµæœã‚’è¡¨ç¤º\n    print('=== ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼çµæœ ===')\n    print(f'ç·è¡Œæ•°: {validation_results[\"total_rows\"]:,}è¡Œ')\n    print(f'ã‚¨ãƒ©ãƒ¼æ•°: {len(validation_results[\"errors\"])}ä»¶')\n    print(f'è­¦å‘Šæ•°: {len(validation_results[\"warnings\"])}ä»¶')\n    \n    if validation_results['errors']:\n        print('\\nã€ã‚¨ãƒ©ãƒ¼ã€‘')\n        for error in validation_results['errors']:\n            print(f'â€¢ {error}')\n    \n    if validation_results['warnings']:\n        print('\\nã€è­¦å‘Šã€‘')\n        for warning in validation_results['warnings']:\n            print(f'â€¢ {warning}')\n    \n    # çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜\n    with open('validation_report.txt', 'w', encoding='utf-8') as f:\n        f.write('ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ\\n')\n        f.write(f'æ¤œè¨¼æ—¥æ™‚: {datetime.now()}\\n')\n        f.write(f'ç·è¡Œæ•°: {validation_results[\"total_rows\"]}\\n')\n        f.write(f'ã‚¨ãƒ©ãƒ¼æ•°: {len(validation_results[\"errors\"])}\\n')\n        f.write(f'è­¦å‘Šæ•°: {len(validation_results[\"warnings\"])}\\n')\n        \n        if validation_results['errors']:\n            f.write('\\nã‚¨ãƒ©ãƒ¼è©³ç´°:\\n')\n            for error in validation_results['errors']:\n                f.write(f'â€¢ {error}\\n')\n    \n    print('\\næ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆã‚’validation_report.txtã«ä¿å­˜ã—ã¾ã—ãŸ')\n\n# ä½¿ç”¨ä¾‹\nvalidate_data('customer_data.csv')",
        "libraries": "pandasã€numpyã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’è‡ªå‹•ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿å“è³ªã®å•é¡Œã‚’æ—©æœŸã«ç™ºè¦‹ã—ã€åˆ†æã®ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚",
        "benefits": ["ãƒ‡ãƒ¼ã‚¿å“è³ªã®å‘ä¸Š", "ã‚¨ãƒ©ãƒ¼ã®æ—©æœŸç™ºè¦‹", "åˆ†æç²¾åº¦ã®å‘ä¸Š"],
        "time_required": "30åˆ†ã€œ1æ™‚é–“",
        "difficulty": "åˆç´š",
        "ai_prompt": "Pythonã§ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ¤œè¨¼ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã™ã‚‹\n3. æ¬ æå€¤ã€ãƒ‡ãƒ¼ã‚¿å‹ã€ç¯„å›²ã€é‡è¤‡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n4. ã‚¨ãƒ©ãƒ¼ã¨è­¦å‘Šã‚’åˆ†é¡ã—ã¦å ±å‘Šã™ã‚‹\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: CSVãƒ•ã‚¡ã‚¤ãƒ«\næ¤œè¨¼é …ç›®: æ¬ æå€¤ã€ãƒ‡ãƒ¼ã‚¿å‹ã€ç¯„å›²ã€é‡è¤‡\nå‡ºåŠ›: æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æ¤œè¨¼ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã—ã€æ¬ æå€¤ã€ãƒ‡ãƒ¼ã‚¿å‹ã€ç¯„å›²ã€é‡è¤‡ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚¨ãƒ©ãƒ¼ã¨è­¦å‘Šã‚’åˆ†é¡ã—ã¦å ±å‘Šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    },
    {
        "id": 30,
        "category": "ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»åˆ†æ",
        "number": "30/100",
        "title": "è‡ªå‹•ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°", 
        "desc": "ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã§ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ãƒ»æ•´å½¢",
        "how_to": "pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ã‚’è‡ªå‹•åŒ–ã—ã€åˆ†æç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ã—ã¾ã™ã€‚",
        "sample_code": "import pandas as pd\nimport numpy as np\nimport re\nfrom datetime import datetime\n\ndef clean_data(input_file, output_file):\n    # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿\n    df = pd.read_csv(input_file)\n    \n    print(f'å…ƒãƒ‡ãƒ¼ã‚¿: {len(df)}è¡Œ')\n    \n    # 1. æ¬ æå€¤ã®å‡¦ç†\n    # æ•°å€¤åˆ—ã¯å¹³å‡å€¤ã§è£œå®Œ\n    numeric_columns = df.select_dtypes(include=[np.number]).columns\n    for col in numeric_columns:\n        if df[col].isnull().sum() > 0:\n            mean_value = df[col].mean()\n            df[col].fillna(mean_value, inplace=True)\n            print(f'åˆ—ã€Œ{col}ã€ã®æ¬ æå€¤ã‚’å¹³å‡å€¤ã§è£œå®Œ')\n    \n    # æ–‡å­—åˆ—åˆ—ã¯æœ€é »å€¤ã§è£œå®Œ\n    string_columns = df.select_dtypes(include=['object']).columns\n    for col in string_columns:\n        if df[col].isnull().sum() > 0:\n            mode_value = df[col].mode()[0]\n            df[col].fillna(mode_value, inplace=True)\n            print(f'åˆ—ã€Œ{col}ã€ã®æ¬ æå€¤ã‚’æœ€é »å€¤ã§è£œå®Œ')\n    \n    # 2. æ–‡å­—åˆ—ã®æ­£è¦åŒ–\n    for col in string_columns:\n        if df[col].dtype == 'object':\n            # å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤\n            df[col] = df[col].str.strip()\n            # å¤§æ–‡å­—å°æ–‡å­—ã‚’çµ±ä¸€\n            df[col] = df[col].str.lower()\n    \n    # 3. ç•°å¸¸å€¤ã®å‡¦ç†\n    for col in numeric_columns:\n        # å¤–ã‚Œå€¤ã‚’æ¤œå‡ºï¼ˆ3ã‚·ã‚°ãƒæ³•ï¼‰\n        mean = df[col].mean()\n        std = df[col].std()\n        lower_bound = mean - 3 * std\n        upper_bound = mean + 3 * std\n        \n        outliers = df[(df[col] < lower_bound) | (df[col] > upper_bound)]\n        if len(outliers) > 0:\n            # å¤–ã‚Œå€¤ã‚’ä¸­å¤®å€¤ã§ç½®æ›\n            median_value = df[col].median()\n            df.loc[(df[col] < lower_bound) | (df[col] > upper_bound), col] = median_value\n            print(f'åˆ—ã€Œ{col}ã€ã®å¤–ã‚Œå€¤{len(outliers)}ä»¶ã‚’ä¸­å¤®å€¤ã§ç½®æ›')\n    \n    # 4. é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤\n    initial_rows = len(df)\n    df.drop_duplicates(inplace=True)\n    removed_rows = initial_rows - len(df)\n    if removed_rows > 0:\n        print(f'é‡è¤‡ãƒ‡ãƒ¼ã‚¿{removed_rows}ä»¶ã‚’å‰Šé™¤')\n    \n    # 5. ãƒ‡ãƒ¼ã‚¿å‹ã®æœ€é©åŒ–\n    # æ—¥ä»˜åˆ—ã®å¤‰æ›\n    date_columns = [col for col in df.columns if 'æ—¥ä»˜' in col or 'date' in col.lower()]\n    for col in date_columns:\n        try:\n            df[col] = pd.to_datetime(df[col])\n            print(f'åˆ—ã€Œ{col}ã€ã‚’æ—¥ä»˜å‹ã«å¤‰æ›')\n        except:\n            pass\n    \n    # çµæœã‚’ä¿å­˜\n    df.to_csv(output_file, index=False, encoding='utf-8')\n    \n    print(f'\\nã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°å®Œäº†ï¼')\n    print(f'å‡¦ç†å¾Œãƒ‡ãƒ¼ã‚¿: {len(df)}è¡Œ')\n    print(f'ä¿å­˜å…ˆ: {output_file}')\n    \n    # å‡¦ç†ã‚µãƒãƒªãƒ¼ã‚’è¡¨ç¤º\n    print('\\n=== å‡¦ç†ã‚µãƒãƒªãƒ¼ ===')\n    print(f'â€¢ æ¬ æå€¤è£œå®Œ: {len(numeric_columns) + len(string_columns)}åˆ—')\n    print(f'â€¢ æ–‡å­—åˆ—æ­£è¦åŒ–: {len(string_columns)}åˆ—')\n    print(f'â€¢ ç•°å¸¸å€¤å‡¦ç†: {len(numeric_columns)}åˆ—')\n    print(f'â€¢ é‡è¤‡å‰Šé™¤: {removed_rows}ä»¶')\n    print(f'â€¢ ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›: {len(date_columns)}åˆ—')\n\n# ä½¿ç”¨ä¾‹\nclean_data('raw_data.csv', 'cleaned_data.csv')",
        "libraries": "pandasã€numpyã€reã€datetimeï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰",
        "explanation": "ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã§ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€åˆ†æã®æº–å‚™ä½œæ¥­ã‚’åŠ¹ç‡åŒ–ã—ã€ãƒ‡ãƒ¼ã‚¿å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚",
        "benefits": ["ãƒ‡ãƒ¼ã‚¿å“è³ªã®å‘ä¸Š", "åˆ†ææº–å‚™ã®è‡ªå‹•åŒ–", "æ™‚é–“ã®å¤§å¹…ç¯€ç´„"],
        "time_required": "1ã€œ2æ™‚é–“",
        "difficulty": "ä¸­ç´š",
        "ai_prompt": "Pythonã§è‡ªå‹•ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ã§ãŠé¡˜ã„ã—ã¾ã™ï¼š\n\n1. pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†\n2. CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã™ã‚‹\n3. æ¬ æå€¤è£œå®Œã€ç•°å¸¸å€¤å‡¦ç†ã€é‡è¤‡å‰Šé™¤ã‚’è¡Œã†\n4. æ–‡å­—åˆ—ã®æ­£è¦åŒ–ã¨ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›ã‚’è¡Œã†\n5. åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã\n\nå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: ç”Ÿãƒ‡ãƒ¼ã‚¿ã®CSVãƒ•ã‚¡ã‚¤ãƒ«\nå‡¦ç†å†…å®¹: æ¬ æå€¤è£œå®Œã€ç•°å¸¸å€¤å‡¦ç†ã€é‡è¤‡å‰Šé™¤ã€æ­£è¦åŒ–\nå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°æ¸ˆã¿CSVãƒ•ã‚¡ã‚¤ãƒ«\n\nã‚³ãƒ”ãƒšç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\nPythonã§è‡ªå‹•ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã—ã€æ¬ æå€¤è£œå®Œã€ç•°å¸¸å€¤å‡¦ç†ã€é‡è¤‡å‰Šé™¤ã‚’è¡Œã£ã¦æ–‡å­—åˆ—ã®æ­£è¦åŒ–ã¨ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›ã‚’è¡Œã†ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚åˆå¿ƒè€…ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚"
    }
]

# è¿½åŠ ãƒ„ãƒ¼ãƒ«ã‚’çµ±åˆ
TOOLS = TOOLS + EXTRA_TOOLS

# ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ—¥æœ¬èªç¿»è¨³è¾æ›¸
ERROR_TRANSLATIONS = {
    # ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼
    'No code provided': 'ã‚³ãƒ¼ãƒ‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'Code execution timed out': 'ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡ŒãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸï¼ˆ60ç§’ã‚’è¶…éï¼‰',
    'Tool not found': 'ãƒ„ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Security: os.system is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€os.systemã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: subprocess.call is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€subprocess.callã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: subprocess.run is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€subprocess.runã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: eval is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€evalã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: exec is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€execã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: __import__ is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€__import__ã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: input( is not allowed in web execution': 'Webå®Ÿè¡Œã§ã¯å¯¾è©±çš„ãªå…¥åŠ›ï¼ˆinputï¼‰ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: while True: is not allowed in web execution': 'ç„¡é™ãƒ«ãƒ¼ãƒ—ï¼ˆwhile Trueï¼‰ã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: schedule.run_pending() is not allowed in web execution': 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: time.sleep( is not allowed in web execution': 'time.sleepã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: open( is not allowed in web execution': 'ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œï¼ˆopenï¼‰ã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: file( is not allowed in web execution': 'ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œï¼ˆfileï¼‰ã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: import os is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€osãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    'Security: import subprocess is not allowed in web execution': 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§ã€subprocessãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯Webå®Ÿè¡Œã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“',
    
    # ãƒ•ã‚¡ã‚¤ãƒ«é–¢é€£ã‚¨ãƒ©ãƒ¼
    'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'è¨±å¯ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™': 'è¨±å¯ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™ã€‚CSVã€Excelã€ãƒ†ã‚­ã‚¹ãƒˆã€ç”»åƒã€PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã§ã™',
    'ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ': 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ',
    'ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ': 'ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ',
    
    # Pythonå®Ÿè¡Œã‚¨ãƒ©ãƒ¼
    'SyntaxError': 'ã‚³ãƒ¼ãƒ‰ã®æ–‡æ³•ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™',
    'IndentationError': 'ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆå­—ä¸‹ã’ï¼‰ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™',
    'NameError': 'æœªå®šç¾©ã®å¤‰æ•°ã‚„é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™',
    'ImportError': 'å­˜åœ¨ã—ãªã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™',
    'ModuleNotFoundError': 'æŒ‡å®šã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'AttributeError': 'å­˜åœ¨ã—ãªã„å±æ€§ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™',
    'TypeError': 'ãƒ‡ãƒ¼ã‚¿å‹ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™',
    'ValueError': 'å€¤ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™',
    'FileNotFoundError': 'æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'PermissionError': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“',
    'ZeroDivisionError': 'ã‚¼ãƒ­ã§å‰²ã‚Šç®—ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™',
    'IndexError': 'ãƒªã‚¹ãƒˆã‚„é…åˆ—ã®ç¯„å›²å¤–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™',
    'KeyError': 'è¾æ›¸ã«å­˜åœ¨ã—ãªã„ã‚­ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™',
    'RuntimeError': 'å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'MemoryError': 'ãƒ¡ãƒ¢ãƒªä¸è¶³ã§ã™',
    'OverflowError': 'æ•°å€¤ãŒå¤§ãã™ãã¾ã™',
    'RecursionError': 'å†å¸°ãŒæ·±ã™ãã¾ã™',
    'TimeoutError': 'å‡¦ç†ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ',
    'ConnectionError': 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'OSError': 'ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'IOError': 'å…¥å‡ºåŠ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    
    # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼
    'pandas': 'pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'matplotlib': 'matplotlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'openpyxl': 'openpyxlãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'requests': 'requestsãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'beautifulsoup4': 'beautifulsoup4ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'pillow': 'Pillowãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'reportlab': 'reportlabãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'schedule': 'scheduleãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'tweepy': 'tweepyãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'opencv-python': 'opencv-pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'pytesseract': 'pytesseractãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'google-auth': 'google-authãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'google-api-python-client': 'google-api-python-clientãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    
    # ãƒ‡ãƒ¼ã‚¿å‡¦ç†é–¢é€£ã‚¨ãƒ©ãƒ¼
    'No numeric data': 'æ•°å€¤ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Empty DataFrame': 'ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒç©ºã§ã™',
    'Column not found': 'æŒ‡å®šã•ã‚ŒãŸåˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Invalid file format': 'ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“',
    'File is corrupted': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒç ´æã—ã¦ã„ã¾ã™',
    'Encoding error': 'æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    
    # ãƒ¡ãƒ¼ãƒ«é–¢é€£ã‚¨ãƒ©ãƒ¼
    'SMTPAuthenticationError': 'ãƒ¡ãƒ¼ãƒ«èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„',
    'SMTPConnectError': 'ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“',
    'SMTPRecipientsRefused': 'å—ä¿¡è€…ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    'SMTPSenderRefused': 'é€ä¿¡è€…ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    'SMTPDataError': 'ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'SMTPNotSupportedError': 'ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“',
    
    # Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Connection timeout': 'Webã‚µã‚¤ãƒˆã¸ã®æ¥ç¶šãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ',
    'HTTP Error': 'HTTPã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'SSL Certificate Error': 'SSLè¨¼æ˜æ›¸ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    'Robot.txt violation': 'Webã‚µã‚¤ãƒˆã®åˆ©ç”¨è¦ç´„ã«é•åã—ã¦ã„ã¾ã™',
    'Rate limit exceeded': 'ã‚¢ã‚¯ã‚»ã‚¹é »åº¦ãŒåˆ¶é™ã‚’è¶…ãˆã¾ã—ãŸ',
    
    # ç”»åƒå‡¦ç†é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Image file is corrupted': 'ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒç ´æã—ã¦ã„ã¾ã™',
    'Unsupported image format': 'ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ç”»åƒå½¢å¼ã§ã™',
    'Image size too large': 'ç”»åƒã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™',
    'OCR failed': 'æ–‡å­—èªè­˜ã«å¤±æ•—ã—ã¾ã—ãŸ',
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Database connection failed': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ',
    'Table not found': 'ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Column not found': 'åˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Duplicate entry': 'é‡è¤‡ã™ã‚‹ã‚¨ãƒ³ãƒˆãƒªãŒã‚ã‚Šã¾ã™',
    'Foreign key constraint': 'å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    
    # APIé–¢é€£ã‚¨ãƒ©ãƒ¼
    'API key is invalid': 'APIã‚­ãƒ¼ãŒç„¡åŠ¹ã§ã™',
    'API rate limit exceeded': 'APIåˆ©ç”¨åˆ¶é™ã‚’è¶…ãˆã¾ã—ãŸ',
    'API endpoint not found': 'APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'API authentication failed': 'APIèªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ',
    'API request failed': 'APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ',
    
    # è¨­å®šé–¢é€£ã‚¨ãƒ©ãƒ¼
    'Configuration file not found': 'è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
    'Invalid configuration': 'è¨­å®šãŒç„¡åŠ¹ã§ã™',
    'Missing required parameter': 'å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™',
    'Invalid parameter value': 'ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ãŒç„¡åŠ¹ã§ã™',
    
    # æ¨©é™é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Permission denied': 'ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“',
    'Read-only file system': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒèª­ã¿å–ã‚Šå°‚ç”¨ã§ã™',
    'Insufficient privileges': 'æ¨©é™ãŒä¸è¶³ã—ã¦ã„ã¾ã™',
    'Access denied': 'ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    
    # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Network unreachable': 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åˆ°é”ã§ãã¾ã›ã‚“',
    'DNS resolution failed': 'DNSè§£æ±ºã«å¤±æ•—ã—ã¾ã—ãŸ',
    'Connection refused': 'æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    'Host unreachable': 'ãƒ›ã‚¹ãƒˆã«åˆ°é”ã§ãã¾ã›ã‚“',
    'Port not available': 'ãƒãƒ¼ãƒˆãŒåˆ©ç”¨ã§ãã¾ã›ã‚“',
    
    # ã‚·ã‚¹ãƒ†ãƒ é–¢é€£ã‚¨ãƒ©ãƒ¼
    'Out of memory': 'ãƒ¡ãƒ¢ãƒªä¸è¶³ã§ã™',
    'Disk space full': 'ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒä¸è¶³ã—ã¦ã„ã¾ã™',
    'Process limit exceeded': 'ãƒ—ãƒ­ã‚»ã‚¹æ•°ã®åˆ¶é™ã‚’è¶…ãˆã¾ã—ãŸ',
    'File descriptor limit': 'ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®åˆ¶é™ã«é”ã—ã¾ã—ãŸ',
    'System resource exhausted': 'ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ãŒä¸è¶³ã—ã¦ã„ã¾ã™'
}

def translate_error_message(error_msg):
    """
    è‹±èªã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ—¥æœ¬èªã«ç¿»è¨³ã™ã‚‹
    """
    # å®Œå…¨ä¸€è‡´ã‚’ãƒã‚§ãƒƒã‚¯
    if error_msg in ERROR_TRANSLATIONS:
        return ERROR_TRANSLATIONS[error_msg]
    
    # éƒ¨åˆ†ä¸€è‡´ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã®æ¤œå‡ºï¼‰
    for english_pattern, japanese_msg in ERROR_TRANSLATIONS.items():
        if english_pattern in error_msg:
            return japanese_msg
    
    # ä¸€èˆ¬çš„ãªPythonã‚¨ãƒ©ãƒ¼ã®æ¤œå‡º
    if 'SyntaxError' in error_msg:
        return 'ã‚³ãƒ¼ãƒ‰ã®æ–‡æ³•ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚æ‹¬å¼§ã®å¯¾å¿œã‚„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'IndentationError' in error_msg:
        return 'ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆå­—ä¸‹ã’ï¼‰ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ã‚¿ãƒ–ã¨ã‚¹ãƒšãƒ¼ã‚¹ã®æ··åœ¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'NameError' in error_msg:
        return 'æœªå®šç¾©ã®å¤‰æ•°ã‚„é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚å¤‰æ•°åã‚„é–¢æ•°åã®ã‚¹ãƒšãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'ImportError' in error_msg or 'ModuleNotFoundError' in error_msg:
        return 'å­˜åœ¨ã—ãªã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'AttributeError' in error_msg:
        return 'å­˜åœ¨ã—ãªã„å±æ€§ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™'
    elif 'TypeError' in error_msg:
        return 'ãƒ‡ãƒ¼ã‚¿å‹ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚æ–‡å­—åˆ—ã¨æ•°å€¤ã®æ¼”ç®—ãªã©ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'ValueError' in error_msg:
        return 'å€¤ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚å…¥åŠ›å€¤ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'FileNotFoundError' in error_msg:
        return 'æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'PermissionError' in error_msg:
        return 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“'
    elif 'ZeroDivisionError' in error_msg:
        return 'ã‚¼ãƒ­ã§å‰²ã‚Šç®—ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚åˆ†æ¯ãŒ0ã«ãªã£ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„'
    elif 'IndexError' in error_msg:
        return 'ãƒªã‚¹ãƒˆã‚„é…åˆ—ã®ç¯„å›²å¤–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™'
    elif 'KeyError' in error_msg:
        return 'è¾æ›¸ã«å­˜åœ¨ã—ãªã„ã‚­ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™'
    elif 'TimeoutError' in error_msg:
        return 'å‡¦ç†ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚å‡¦ç†æ™‚é–“ã‚’çŸ­ç¸®ã™ã‚‹ã‹ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’å»¶é•·ã—ã¦ãã ã•ã„'
    
    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    return f'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error_msg}'

@app.route('/')
@app.route('/index')
@app.route('/index.html')
def index():
    logger.info("Index page accessed")
    try:
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ„ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        tools = []
        try:
            tools = [tool.to_dict() for tool in Tool.query.all()]
            logger.info(f"Retrieved {len(tools)} tools from database")
        except Exception as db_error:
            logger.warning(f"Database error, using fallback data: {db_error}")
            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
            tools = TOOLS
        
        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
        template_path = os.path.join(app.template_folder, 'index.html')
        if not os.path.exists(template_path):
            logger.error(f"Template file not found: {template_path}")
            return f"Template file not found: {template_path}", 500
        
        logger.info(f"Rendering template: {template_path}")
        return render_template('index.html', tools=tools)
    except Exception as e:
        logger.error(f"Error rendering index page: {e}")
        logger.error(f"Error type: {type(e).__name__}")
        return f"Internal Server Error: {str(e)}", 500

@app.route('/tool/<int:tool_id>')
def tool_detail(tool_id):
    logger.info(f"Tool detail page accessed for tool_id: {tool_id}")
    try:
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ„ãƒ¼ãƒ«ã‚’å–å¾—
        tool = Tool.query.get(tool_id)
        if tool is None:
            logger.warning(f"Tool not found for tool_id: {tool_id}")
            return "ãƒ„ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", 404
        return render_template('detail.html', tool=tool.to_dict())
    except Exception as db_error:
        logger.warning(f"Database error, using fallback data: {db_error}")
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
        tool = next((t for t in TOOLS if t['id'] == tool_id), None)
        if tool is None:
            logger.warning(f"Tool not found for tool_id: {tool_id}")
            return "ãƒ„ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", 404
        return render_template('detail.html', tool=tool)

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
@app.route('/health')
def health_check():
    return {"status": "healthy", "app": "pyme-app"}, 200

# ãƒ‡ãƒãƒƒã‚°ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
@app.route('/debug')
def debug_info():
    try:
        import platform
        template_folder = app.template_folder
        
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
        db_status = "unknown"
        db_tools_count = 0
        try:
            db_tools_count = Tool.query.count()
            db_status = "connected"
        except Exception as db_error:
            db_status = f"error: {str(db_error)}"
        
        return {
            "app_name": "pyme-app",
            "python_version": sys.version,
            "platform": platform.platform(),
            "working_directory": os.getcwd(),
            "port": os.environ.get('PORT', '8000'),
            "flask_env": os.environ.get('FLASK_ENV', 'production'),
            "database_url": app.config.get('SQLALCHEMY_DATABASE_URI', 'not_set'),
            "database_status": db_status,
            "database_tools_count": db_tools_count,
            "fallback_tools_count": len(TOOLS),
            "app_imported": True,
            "template_folder": template_folder,
            "templates_exist": os.path.exists(template_folder),
            "templates_files": os.listdir(template_folder) if os.path.exists(template_folder) else [],
            "index_template_exists": os.path.exists(os.path.join(template_folder, 'index.html')) if os.path.exists(template_folder) else False,
            "detail_template_exists": os.path.exists(os.path.join(template_folder, 'detail.html')) if os.path.exists(template_folder) else False,
            "all_files": os.listdir('.') if os.path.exists('.') else []
        }, 200
    except Exception as e:
        return {"error": str(e), "error_type": type(e).__name__}, 500

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
@app.route('/db-test')
def database_test():
    try:
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
        with db.engine.connect() as connection:
            # SQLiteã¨PostgreSQLã®ä¸¡æ–¹ã«å¯¾å¿œ
            if 'sqlite' in str(db.engine.url):
                connection.execute(db.text('SELECT 1'))
            else:
                connection.execute(db.text('SELECT 1'))
        tools_count = Tool.query.count()
        return {
            "status": "success",
            "message": "Database connection successful",
            "tools_count": tools_count,
            "database_url": app.config.get('SQLALCHEMY_DATABASE_URI', 'not_set')
        }, 200
    except Exception as e:
        return {
            "status": "error",
            "message": f"Database connection failed: {str(e)}",
            "database_url": app.config.get('SQLALCHEMY_DATABASE_URI', 'not_set')
        }, 500

# favicon.icoã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
@app.route('/favicon.ico')
def favicon():
    return '', 204  # No content

# æ–°ã—ã„ãƒ«ãƒ¼ãƒˆ: AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå®Ÿè¡Œãƒšãƒ¼ã‚¸
@app.route('/execute/<int:tool_id>')
def execute_tool(tool_id):
    tool = next((t for t in TOOLS if t['id'] == tool_id), None)
    if not tool:
        return redirect(url_for('index'))
    return render_template('execute.html', tool=tool)

# AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹API
@app.route('/api/generate-code', methods=['POST'])
def generate_code():
    try:
        data = request.get_json()
        tool_id = data.get('tool_id')
        custom_prompt = data.get('custom_prompt', '')
        
        tool = next((t for t in TOOLS if t['id'] == tool_id), None)
        if not tool:
            return jsonify({'error': translate_error_message('Tool not found')}), 404
        
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨
        base_prompt = tool.get('ai_prompt', '')
        
        # ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒã‚ã‚‹å ´åˆã¯ä½¿ç”¨
        if custom_prompt:
            final_prompt = custom_prompt
        else:
            final_prompt = base_prompt
        
        # OpenAI APIã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        openai_api_key = os.environ.get('OPENAI_API_KEY')
        if openai_api_key:
            try:
                import openai
                openai.api_key = openai_api_key
                
                response = openai.ChatCompletion.create(
                    model="gpt-3.5-turbo",
                    messages=[
                        {"role": "system", "content": "ã‚ãªãŸã¯Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®å°‚é–€å®¶ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã«å¿œã˜ã¦ã€å®‰å…¨ã§å®Ÿç”¨çš„ãªPythonã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚"},
                        {"role": "user", "content": final_prompt}
                    ],
                    max_tokens=2000,
                    temperature=0.7
                )
                
                generated_code = response.choices[0].message.content
                
                # ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰Pythonã‚³ãƒ¼ãƒ‰ã‚’æŠ½å‡º
                import re
                code_match = re.search(r'```python\n(.*?)\n```', generated_code, re.DOTALL)
                if code_match:
                    generated_code = code_match.group(1)
                
            except Exception as e:
                logger.warning(f"OpenAI API error: {e}, using sample code")
                generated_code = tool.get('sample_code', '')
        else:
            # OpenAI APIã‚­ãƒ¼ãŒãªã„å ´åˆã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
            generated_code = tool.get('sample_code', '')
        
        return jsonify({
            'success': True,
            'code': generated_code,
            'prompt': final_prompt
        })
        
    except Exception as e:
        logger.error(f"Error generating code: {e}")
        return jsonify({'error': translate_error_message(str(e))}), 500

# ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹API
@app.route('/api/execute-code', methods=['POST'])
def execute_code():
    try:
        data = request.get_json()
        code = data.get('code', '')
        tool_id = data.get('tool_id')
        
        if not code:
            return jsonify({'error': translate_error_message('No code provided')}), 400
        
        # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼ˆå±é™ºãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãªã„ï¼‰
        dangerous_patterns = [
            'os.system', 'subprocess.call', 'subprocess.run', 'eval', 'exec', '__import__',
            'input(', 'while True:', 'schedule.run_pending()', 'time.sleep(',
            'open(', 'file(', 'import os', 'import subprocess'
        ]
        for pattern in dangerous_patterns:
            if pattern in code:
                error_msg = f'Security: {pattern} is not allowed in web execution'
                return jsonify({'error': translate_error_message(error_msg)}), 403
        
        # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’ã‚³ãƒ¼ãƒ‰ã«è¿½åŠ 
        if 'uploaded_files' in session and session['uploaded_files']:
            # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¨­å®š
            for file_id, file_info in session['uploaded_files'].items():
                env_var_name = f"UPLOADED_{file_id.upper()}"
                os.environ[env_var_name] = file_info['path']
                # ã‚³ãƒ¼ãƒ‰å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å®Ÿéš›ã®ãƒ‘ã‚¹ã«ç½®æ›
                code = code.replace(file_info['filename'], file_info['path'])
        
        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜
        with tempfile.NamedTemporaryFile(mode='w', suffix='.py', delete=False) as f:
            f.write(code)
            temp_file = f.name
        
        try:
            # ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ãï¼‰
            result = subprocess.run(
                [sys.executable, temp_file],
                capture_output=True,
                text=True,
                timeout=60  # 60ç§’ã«å»¶é•·
            )
            
            # çµæœã‚’è¿”ã™
            return jsonify({
                'success': True,
                'stdout': result.stdout,
                'stderr': result.stderr,
                'return_code': result.returncode
            })
            
        finally:
            # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
            os.unlink(temp_file)
            
    except subprocess.TimeoutExpired:
        return jsonify({'error': translate_error_message('Code execution timed out')}), 408
    except Exception as e:
        logger.error(f"Error executing code: {e}")
        return jsonify({'error': translate_error_message(str(e))}), 500

# è¨­å®šã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸
@app.route('/wizard/<int:tool_id>')
def setup_wizard(tool_id):
    tool = next((t for t in TOOLS if t['id'] == tool_id), None)
    if not tool:
        return redirect(url_for('index'))
    return render_template('wizard.html', tool=tool)

# è¨­å®šã‚’ä¿å­˜ã™ã‚‹API
@app.route('/api/save-config', methods=['POST'])
def save_config():
    try:
        data = request.get_json()
        tool_id = data.get('tool_id')
        config_data = data.get('config', {})
        
        # è¨­å®šã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
        # ã“ã“ã§ã¯ç°¡å˜ãªä¾‹ã¨ã—ã¦ã€è¨­å®šã‚’ãƒ­ã‚°ã«å‡ºåŠ›
        logger.info(f"Saved config for tool {tool_id}: {config_data}")
        
        return jsonify({'success': True, 'message': 'è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ'})
        
    except Exception as e:
        logger.error(f"Error saving config: {e}")
        return jsonify({'error': translate_error_message(str(e))}), 500

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’è¿½åŠ 
@app.route('/api/upload-file', methods=['POST'])
def upload_file():
    try:
        if 'file' not in request.files:
            return jsonify({'error': translate_error_message('ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“')}), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({'error': translate_error_message('ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“')}), 400
        
        # ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’ãƒã‚§ãƒƒã‚¯
        allowed_extensions = {'csv', 'xlsx', 'xls', 'txt', 'json', 'jpg', 'jpeg', 'png', 'gif', 'pdf'}
        if not file.filename.lower().endswith(tuple('.' + ext for ext in allowed_extensions)):
            return jsonify({'error': translate_error_message('è¨±å¯ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™')}), 400
        
        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
        import tempfile
        import os
        from werkzeug.utils import secure_filename
        
        filename = secure_filename(file.filename)
        temp_dir = tempfile.mkdtemp()
        file_path = os.path.join(temp_dir, filename)
        file.save(file_path)
        
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚’ä¿å­˜
        if 'uploaded_files' not in session:
            session['uploaded_files'] = {}
        
        file_id = f"file_{len(session['uploaded_files']) + 1}"
        session['uploaded_files'][file_id] = {
            'path': file_path,
            'filename': filename,
            'temp_dir': temp_dir
        }
        
        return jsonify({
            'success': True,
            'file_id': file_id,
            'filename': filename,
            'message': f'ãƒ•ã‚¡ã‚¤ãƒ« "{filename}" ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ'
        })
        
    except Exception as e:
        logger.error(f"File upload error: {e}")
        return jsonify({'error': translate_error_message('ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ')}), 500

# ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§ã‚’å–å¾—
@app.route('/api/uploaded-files', methods=['GET'])
def get_uploaded_files():
    if 'uploaded_files' not in session:
        return jsonify({'files': []})
    
    files = []
    for file_id, file_info in session['uploaded_files'].items():
        files.append({
            'id': file_id,
            'filename': file_info['filename']
        })
    
    return jsonify({'files': files})

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
@app.route('/api/delete-file/<file_id>', methods=['DELETE'])
def delete_file(file_id):
    try:
        if 'uploaded_files' in session and file_id in session['uploaded_files']:
            file_info = session['uploaded_files'][file_id]
            
            # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
            if os.path.exists(file_info['path']):
                os.unlink(file_info['path'])
            
            # ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤
            if os.path.exists(file_info['temp_dir']):
                import shutil
                shutil.rmtree(file_info['temp_dir'])
            
            # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å‰Šé™¤
            del session['uploaded_files'][file_id]
            
            return jsonify({'success': True, 'message': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ'})
        else:
            return jsonify({'error': translate_error_message('ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“')}), 404
            
    except Exception as e:
        logger.error(f"File deletion error: {e}")
        return jsonify({'error': translate_error_message('ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ')}), 500

# ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆãƒ¢ãƒã‚¤ãƒ«ãƒšãƒ¼ã‚¸ç”¨ã®ãƒ«ãƒ¼ãƒˆã‚’è¿½åŠ 
@app.route('/simple')
def simple_mobile():
    """ã‚¹ãƒãƒ›åˆå¿ƒè€…å‘ã‘ã®ç°¡å˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹"""
    return render_template('simple_mobile.html')

# è‡ªå‹•åŒ–å®Ÿè¡ŒAPI
@app.route('/api/run-automation', methods=['POST'])
def run_automation():
    """è‡ªå‹•åŒ–ã‚’å®Ÿè¡Œã™ã‚‹API"""
    try:
        data = request.get_json()
        automation_type = data.get('type')
        user_profile = data.get('userProfile', {})
        
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä½¿ã£ã¦è‡ªå‹•åŒ–ã‚’å®Ÿè¡Œ
        result = execute_automation(automation_type, user_profile)
        
        return jsonify({
            'success': True,
            'message': result['message'],
            'data': result.get('data', {})
        })
        
    except Exception as e:
        logger.error(f"è‡ªå‹•åŒ–å®Ÿè¡Œã‚¨ãƒ©ãƒ¼: {e}")
        return jsonify({
            'success': False,
            'error': str(e)
        }), 500

# ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–ä½œæˆAPI
@app.route('/api/create-custom-automation', methods=['POST'])
def create_custom_automation():
    """ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–ã‚’ä½œæˆã™ã‚‹API"""
    try:
        data = request.get_json()
        request_text = data.get('request')
        user_profile = data.get('userProfile', {})
        
        # AIã‚’ä½¿ã£ã¦ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–ã‚’ä½œæˆ
        automation = create_custom_automation_from_request(request_text, user_profile)
        
        return jsonify({
            'success': True,
            'automation': automation
        })
        
    except Exception as e:
        logger.error(f"ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–ä½œæˆã‚¨ãƒ©ãƒ¼: {e}")
        return jsonify({
            'success': False,
            'error': str(e)
        }), 500

def execute_automation(automation_type, user_profile):
    """è‡ªå‹•åŒ–ã‚’å®Ÿè¡Œã™ã‚‹"""
    
    if automation_type == 'email':
        # ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡
        return {
            'message': f"{user_profile.get('name', 'ãƒ¦ãƒ¼ã‚¶ãƒ¼')}ã•ã‚“ã®ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ",
            'data': {
                'sender': user_profile.get('email'),
                'sent_count': 1,
                'timestamp': datetime.now().isoformat()
            }
        }
    
    elif automation_type == 'excel':
        # Excelè‡ªå‹•å‡¦ç†
        return {
            'message': f"å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ã€{user_profile.get('folder', 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—')}ã«ä¿å­˜ã—ã¾ã—ãŸ",
            'data': {
                'processed_rows': 100,
                'output_file': 'sales_analysis.xlsx',
                'timestamp': datetime.now().isoformat()
            }
        }
    
    elif automation_type == 'file':
        # ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ•´ç†
        return {
            'message': f"{user_profile.get('folder', 'ãƒ•ã‚©ãƒ«ãƒ€')}å†…ã®50å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã¾ã—ãŸ",
            'data': {
                'organized_files': 50,
                'folders_created': 5,
                'timestamp': datetime.now().isoformat()
            }
        }
    
    elif automation_type == 'report':
        # æ—¥å ±ä½œæˆ
        return {
            'message': f"{user_profile.get('name', 'ãƒ¦ãƒ¼ã‚¶ãƒ¼')}ã•ã‚“ã®æ—¥å ±ã‚’ä½œæˆã—ã€{user_profile.get('email')}ã«é€ä¿¡ã—ã¾ã—ãŸ",
            'data': {
                'report_date': datetime.now().strftime('%Y-%m-%d'),
                'sections': 4,
                'timestamp': datetime.now().isoformat()
            }
        }
    
    else:
        raise ValueError(f"æœªå¯¾å¿œã®è‡ªå‹•åŒ–ã‚¿ã‚¤ãƒ—: {automation_type}")

def create_custom_automation_from_request(request_text, user_profile):
    """ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–ã‚’ä½œæˆã™ã‚‹"""
    
    # ç°¡å˜ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æã§ã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š
    if 'ãƒ¡ãƒ¼ãƒ«' in request_text or 'mail' in request_text.lower():
        automation_type = 'email'
        name = 'ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ¼ãƒ«é€ä¿¡'
        description = f"{request_text[:50]}..."
    elif 'excel' in request_text.lower() or 'ã‚¨ã‚¯ã‚»ãƒ«' in request_text:
        automation_type = 'excel'
        name = 'ã‚«ã‚¹ã‚¿ãƒ Excelå‡¦ç†'
        description = f"{request_text[:50]}..."
    elif 'ãƒ•ã‚¡ã‚¤ãƒ«' in request_text or 'file' in request_text.lower():
        automation_type = 'file'
        name = 'ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†'
        description = f"{request_text[:50]}..."
    else:
        automation_type = 'custom'
        name = 'ã‚«ã‚¹ã‚¿ãƒ è‡ªå‹•åŒ–'
        description = f"{request_text[:50]}..."
    
    return {
        'id': f"custom_{datetime.now().strftime('%Y%m%d_%H%M%S')}",
        'name': name,
        'description': description,
        'type': automation_type,
        'request': request_text,
        'created_at': datetime.now().isoformat()
    }

if __name__ == '__main__':
    try:
        port = int(os.environ.get('PORT', 8000))
        # æœ¬ç•ªç’°å¢ƒã§ã¯ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã™ã‚‹
        debug_mode = os.environ.get('FLASK_ENV') == 'development'
        logger.info(f"Starting Flask app on port {port}, debug={debug_mode}")
        logger.info(f"App will be available at: http://0.0.0.0:{port}")
        logger.info("Press Ctrl+C to stop the server")
        app.run(host='0.0.0.0', port=port, debug=debug_mode)
    except KeyboardInterrupt:
        logger.info("Server stopped by user")
    except Exception as e:
        logger.error(f"Failed to start Flask app: {e}")
        logger.error(f"Error details: {type(e).__name__}: {e}")
        logger.error(f"Current working directory: {os.getcwd()}")
        logger.error(f"Files in current directory: {os.listdir('.')}")
        sys.exit(1)
